/*! For license information please see preact.bundle.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Apple2=t():e.Apple2=t()}(self,(()=>(()=>{var e,t,s={2800:(e,t,s)=>{var i={"./apple2_char":[7975,975],"./apple2_char.ts":[7975,975],"./apple2e_char":[3189,189],"./apple2e_char.ts":[3189,189],"./apple2enh_char":[4064,64],"./apple2enh_char.ts":[4064,64],"./apple2j_char":[8132,132],"./apple2j_char.ts":[8132,132],"./apple2lc_char":[957,957],"./apple2lc_char.ts":[957,957],"./pigfont_char":[5030,30],"./pigfont_char.ts":[5030,30],"./pravetz82_char":[3355,355],"./pravetz82_char.ts":[3355,355],"./rmfont_char":[6601,601],"./rmfont_char.ts":[6601,601]};function n(e){if(!s.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return s.e(t[1]).then((()=>s(n)))}n.keys=()=>Object.keys(i),n.id=2800,e.exports=n},6190:(e,t,s)=>{var i={"./apple2e":[2553,553],"./apple2e.ts":[2553,553],"./apple2enh":[5045,45],"./apple2enh.ts":[5045,45],"./apple2ex":[2875,875],"./apple2ex.ts":[2875,875],"./apple2j":[7156,156],"./apple2j.ts":[7156,156],"./fpbasic":[4094,94],"./fpbasic.ts":[4094,94],"./intbasic":[7089,89],"./intbasic.ts":[7089,89],"./original":[4663,663],"./original.ts":[4663,663],"./pravetz82":[6818,818],"./pravetz82.ts":[6818,818]};function n(e){if(!s.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],n=t[0];return s.e(t[1]).then((()=>s(n)))}n.keys=()=>Object.keys(i),n.id=6190,e.exports=n},7911:e=>{"use strict";const t=function(){const e=class{constructor(e,t){this.x=e,this.y=t}},t=class{constructor(e,t){this.width=e,this.height=t}copy(){return new t(this.width,this.height)}get ratio(){return this.width/this.height}},s=class{constructor(s,i,n,r){this.origin=new e(s,i),this.size=new t(n,r)}get x(){return this.origin.x}get y(){return this.origin.y}get width(){return this.size.width}get height(){return this.size.height}get l(){return this.origin.x}get r(){return this.origin.x+this.size.width}get t(){return this.origin.y}get b(){return this.origin.y+this.size.height}},i=class{constructor(e){this.data=new Float32Array(e)}normalize(){const e=this.data;let t=0;for(const s of e)t+=s;const s=1/t;for(const t in e)e[t]*=s;return this}mul(e){const t=new i(0);if("number"!=typeof e&&this.data.length!=e.data.length)return t;t.data=new Float32Array(this.data);for(let s=0;s<t.data.length;s++)t.data[s]*="number"==typeof e?e:e.data[s];return t}realIDFT(){const e=this.data.length,t=new i(e);for(let s=0;s<e;s++){const i=2*Math.PI*s/e;for(let n=0;n<e;n++)t.data[s]+=this.data[n]*Math.cos(n*i)}for(let s=0;s<e;s++)t.data[s]/=e;return t}resize(e){const t=new Float32Array(e);for(let e=0;e<Math.min(t.length,this.data.length);e++)t[e]=this.data[e];return this.data=t,this}static chebyshevWindow(e,t){const s=e-1;let n=new i(s);const r=Math.cosh(Math.acosh(Math.pow(10,t/20))/s);for(let e=0;e<s;e++){const t=Math.abs(r*Math.cos(Math.PI*e/s));n.data[e]=t>1?Math.pow(-1,e)*Math.cosh(s*Math.acosh(t)):Math.pow(-1,e)*Math.cos(s*Math.acos(t))}n=n.realIDFT(),n.resize(e),n.data[0]/=2,n.data[e-1]=n.data[0];const o=n.data.reduce(((e,t)=>Math.max(e,Math.abs(t))));for(const e in n.data)n.data[e]/=o;return n}static lanczosWindow(e,t){let s=new i(e);t=Math.min(t,.5);const n=Math.floor(e/2);for(let i=0;i<e;i++){const e=2*Math.PI*t*(i-n);s.data[i]=0==e?1:Math.sin(e)/e}return s}},n=class{constructor(e,t,s,i,n,r,o,a,l){this.data=new Float32Array([e,t,s,i,n,r,o,a,l])}at(e,t){return this.data[3*e+t]}mul(e){const t=new n(0,0,0,0,0,0,0,0,0);if("number"==typeof e)t.data=this.data.map((t=>t*e));else for(let s=0;s<3;s++)for(let i=0;i<3;i++)for(let n=0;n<3;n++)t.data[3*s+i]+=e.data[3*s+n]*this.data[3*n+i];return t}},r=65,o=14,a=315/88*1e6,l=4*a,h=7e5,c=l*r/912,d=new s(9222222222222219e-21*c,19,c*(1e-6*(52+8/9)),240),u=new s(16,38,40,192),A=14250450*r/912,m=new s(1137037037037037e-20*A,21,52e-6*A,288),p=new s(16,48,40,192),g="\n// an attribute will receive data from a buffer\nattribute vec4 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\n\n// all shaders have a main function\nvoid main() {\n  gl_Position = a_position;\n  v_texCoord = a_texCoord;\n}\n";function f(s,i,n,a,l){const h=i.y,c=r*a,d=Math.floor(i.x),u=new t(Math.floor(o*n.width),Math.floor(n.height)),A=Math.floor((d-n.x)*o);return{fsc:l,clockFrequency:s,displayRect:i,visibleRect:n,vertStart:h,vertTotal:a,frameCycleNum:c,horizStart:d,imageSize:u,imageLeft:A,colorBurst:[2*Math.PI*(-33/360+A%4/4)],cycleNum:c+16,topLeft:new e(A,h-n.y),topLeft80Col:new e(A-o/2,h-n.y)}}const _=f(c,u,d,262,a),b=f(A,p,m,312,4433618.75),C=e=>new Promise(((t,s)=>{const i=new Image;i.onload=()=>t(i),i.onerror=()=>s(`error loading '${e}'`),i.src=e})),y=["SHADOWMASK_TRIAD","SHADOWMASK_INLINE","SHADOWMASK_APERTURE","SHADOWMASK_LCD","SHADOWMASK_BAYER","IMAGE_PHASEINFO","IMAGE_IN","IMAGE_DECODED","IMAGE_PERSISTENCE"],w=["COMPOSITE","DISPLAY","RGB"],v=e=>{const t=e.clientWidth,s=e.clientHeight;e.width==t&&e.height==s||(e.width=t,e.height=s)},k=(e,t,s,i)=>{const n=e.createShader(s);if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;const r=e.getShaderInfoLog(n);throw e.deleteShader(n),new Error(`unable to compile shader ${t}: \n${r}`)},x=(e,t,...s)=>{const i=e.createProgram();for(let t of s)e.attachShader(i,t);if(e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;const n=e.getProgramInfoLog(i);throw e.deleteProgram(i),new Error(`unable to compile program ${t}: \n${n}`)},E=class{constructor(e,t,s){this.width=e,this.height=t,this.glTexture=s}get size(){return new t(this.width,this.height)}};return{C:{HORIZ_START:16,HORIZ_BLANK:25,HORIZ_DISPLAY:40,HORIZ_TOTAL:r,CELL_WIDTH:o,CELL_HEIGHT:8,VERT_NTSC_START:38,VERT_PAL_START:48,VERT_DISPLAY:192,BLOCK_WIDTH:40,BLOCK_HEIGHT:24,NTSC_I_CUTOFF:13e5,NTSC_Q_CUTOFF:6e5,NTSC_IQ_DELTA:h,NTSC_DETAILS:_,PAL_DETAILS:b},loadImage:C,screenData:(e,t,s=!0)=>{if(560!=e.naturalWidth||192!=e.naturalHeight)throw new Error(`screenData expects an image 560x192; got ${e.naturalWidth}x${e.naturalHeight}`);const i=document.createElement("canvas"),n=i.getContext("2d"),r=t.imageSize.width,o=t.imageSize.height;i.width=r,i.height=o,n.fillStyle="rgba(0,0,0,1)",n.fillRect(0,0,r,o);const a=s?t.topLeft80Col:t.topLeft;return n.drawImage(e,a.x,a.y),[i,n.getImageData(0,0,r,o)]},resizeCanvas:v,createShader:k,createProgram:x,ScreenView:class{constructor(e){const i=e.getContext("webgl");if(null==i.getExtension("OES_texture_float"))throw new Error("WebGL extension 'OES_texture_float' unavailable");this.canvas=e,this.gl=i,this.textures={},this.shaders={},this.buffers=[],this.image=null,this.display=null,this.imageSampleRate=null,this.imageBlackLevel=null,this.imageWhiteLevel=null,this.imageSubcarrier=null,this.viewportSize=new t(0,0),this.persistenceTexRect=new s(0,0,0,0),this.configurationChanged=!0,this.imageChanged=!0}get image(){return this._image}set image(e){this._image=e,this.imageChanged=!0}set displayConfiguration(e){this.display=e,this.configurationChanged=!0}async initOpenGL(){const e=this.gl;e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),this.textures={};for(let t of y)this.textures[t]=new E(0,0,e.createTexture());for(let t=0;t<3;t++)this.buffers.push(e.createBuffer());await this.loadTextures(),e.pixelStorei(e.PACK_ALIGNMENT,1),e.pixelStorei(e.UNPACK_ALIGNMENT,1),this.loadShaders()}freeOpenGL(){const e=this.gl;for(let t of y)e.deleteTexture(this.textures[t].glTexture);for(let t of this.buffers)e.deleteBuffer(t);this.deleteShaders()}loadTextures(){return Promise.all([this.loadTexture("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAIAAABdtOgoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB5hJREFUeNrsXEtolUcU/u6NNT4SH0SNbyUlrVpTlPRBqykq0RjpQsT6WATFhbowLrS4KEKhRaorFxZEixSkipviwvoIFVtiVSq+tW1qia8mPmpFk6gx5tX/frcX0jT3n5l/zrEU7seskpn5zpkz/8ycM2duDKEoAGYD04GJwFCgP//4BLgP/AL8AHwLXIMaXgKKKcFbFGUwkA20AU1APXABOAZUAw/1JAgo3wNmAVOAUUAu0AtoIWWg92kOwFmgVZ55DnAIeAZ0hpZnrDZHnD7QdA1w2UQflHvANqBQXIJC9nvPQoLLlDVXjHkScNiCtls5zIYy+ACodaR/CnwG5IjQ57Cvp44S1FJubywHGtxHP1ka2NwLwRq3Myp9UM4BRZ4SFLGXyBLsTK3T7ujnp3tXEfpFk2AycMab/qHPLFjO9p4SnKEm7tglMfrJsisC/TigRoi+HVgSQYIlbCkiQQ31cUGl3OgnS6UTfXCyOCBK/4frWlTENoISHKBWdnjVbrN3KvfYrS1WSdMHZb+TAfYrSLDKlvxLBfJOdmuFke5nHsuyyFKCRTr0tdTNhCl0rDT4n7BzMzbo0AfleyBupI+znpIEG8z0pZEPLRbHqlJjpRhQrubGvmlzHpnMekoop4ahBngXijB3Pjbimc12ChQbKxWrzcCkdccaDPCypgGCzvuG1xgPDNGUYKJADQ8MoYahBhiizG+IDgyDLkYK1PCDQcN4XJM8blwCY8rqxwRqqEoQb9Qkb2S41FBDFQ8FaniPQagB7miS3zHy1wPNmhLcEKjhgWZqGGqAak1+c+dXgStq9G3ACWOlE6ynhCvUMNQAR1SucxIIuj1irNQCVKmpf56hZQPOsZ4SqqihaY84quMFHrXc4Iq4TmlIsM5ymNbp0DfaRgTn6/DPt58oOxTof7U/4w5jbXEJdjh8Ktulybc7faljuFoK0j8HFjpJsJBtBCW4Qq2s0Yd361Lkh9ihG4pFA/LrI6zX60WvI4qd+YcDJyXIT7KriJGrBgkJtkTeM7dI0DdEjy8OjZQP0S03YqjPqWEmUOdB3wFs9Dy3bGQvkSWoow4eyAY+ovPgylzPhtn+J7cCYJ/7HUUHL8PniZwd57GvDvfrj32UXgI5TDWqsb6BXiOVktM1jvo58MCCvpWn7VJIo5T9tlpI8ICyRgwrx8K/hmnA+8A7tOzA1ARv4Tp3DTgFfENXsgU6CJazuUAZMJVRy1wgiyo3p5Ijv6MEP+v58pM4ADNTuZl9OWLtTI68TQ+uiu7mfcVoYRLB6OelgvvNNHoDXiCySD8I6E31H1PlZy9Sgj40QA5FCQ6sjzgG7cgggwwy+D8jpk+Ry5jUFG7keVzFnzBxq4ab2FXNaHACI7mFBxKM5k4G7l51TCo/z51UF72AVyjBBCCfmbvPuX1c4/uGQIhEEnypEvl0ZmfdTn+Aa6MIHxtvrqOdpCv4fKIpPX0TK1SIn6GTGE/NLlPLdBIENvjb5TkJLOPsFEBv9lXt4ssEk/IrHnoFMAr41DHZrpZNRkkN/TRq02CXy/2PUapyC+GlCWxWRfXjg6nyCc950VHuEcuo808Sy6IGbS6J3N3/dNXnjUMR23sGs/ZEiKUmsdLOcw13q1f6uAp73Cl7+NNv0Z5cFbKlSDh3t01SZzcsE0rvb2dXzohT6k4RA3QyyJDvxJ/PNoIXGm4x5bmhm61raWKHLyiSHTYLHbBb4Upvqf22c12a+7rTbrjUgylsOZxhyT/De+3tsZy1fPC2WedOe7Ol9v0pqbwBHD6C3TojEJTFRu4RwC0d7lvs3IzFXjShe91suo8GjGY9JSywCduP0eEeY+mhLvBiCTXAcKDE2ENJ5DtgO196hPHgr4dymw9wup4BYOMTFGmOwPDwS75shlj0MMF4yVrgO/3iZgt71/ATb1h4wCdPkz7P5n1DXNUAZp+0D3SRHR5qzFbm7hVdOgt0Gg1gvnjUvppsCvlfC28n9fDYeN3dJPCNh+KmsYebmiPQEp5fHxj/rib9XeP8qvfLSIgZDXDB2McFzRG4RZ805AvGRU36i0lXKQTXKaPWF3CTPp4BZzU/ghPGKXhM0wDmzhts3oCY9oG0ZatlF1t1XNF2pgQZMAi4pEN/iZ2bUeYXhk37j9/tf3JlHGuLj8BeS/oKHQNU2E/ivRoGWOv0Ha2VVv9PexcvCzgoTX/Q6WauiPJKGuBr15vBLLYRHIHVTvST/LKq/3036fz7d6sFDVDtehuTRD5biozApgj0ZXa5vDaptmXRdtNNIgbY5pMb0ZvtfdR/ZBOCTodC/pKnD/1pzx/AXEwN3AzQ1sX0K0QObyuizsXTzGDywkCPF387UplbXpjqOAsSjymDU9QXxt9VccJY9vjU5fKjUjCuMws47jIIx9lEMoRUaXdPlPCiP9QL6Rbwxc8ZRkw6esoCus/jRnDeG6ARRy3hb2jWUs0eda9lhRLfgGYaDKBmB6llW09PeloTTlws8fvMSk/lEwh6fx14g2lng/nAIIt8j1MJkqdUf60h8KTeBl7jCWFAlwcmjcxO/Qn4kYu2Isan3rfkcYFLxo6f89h6gwmJGWSQQQb/Hf4SYABjDjkS7NbBvAAAAABJRU5ErkJggg==",!0,"SHADOWMASK_TRIAD"),this.loadTexture("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAIAAABdtOgoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAxdJREFUeNrsnDtoVEEUhr9do0YwAR9YiGJhoYIiFiJooSJoI6KFj8KIIAQRIwQsLI2IYhHBQkGxUolgowQtREEJPlAxEhstYnwQNBLQJMSYxI3xetLkce7dCUuKvfv/TLP3nHNnmG927mPOXDKwE5rgB/yC3lEl+tkNb6EGyonRDGiA3NjIcSWyXiBe1eb0Oz7+D7yExRMjK62Fw2Flg1v5reD482787uD4VuJOMBAQfTKu9w6H1d5vnB2thC9hp7iYSgDZEzaI8+oorHANGwnSTFjvGpa5Q9vTFtKo7NIwv3kwxzVMC66qzG9AgfFFDyAT7JpBmgIA6gIBEABJAARAEgABkARAACQBEABJAASgVDQsAIXpb4Fd/TU4/pt79GdwE9pTCKAPXoR5fojr6ivwOSD+DVx3DU22qJZXA1CfQgA5OAXfA9xOwyfX9g72wwOD6aoHbsNB6HDNg1Bry6Wd8ZU3W/xd11z0y0zPYDMcgTW2tjp6nsnAELTBVXiUcIonsAPmwnRvnhq0fIXBhPiIzDGog1kxc2SXpRaQTgAjg7imwFP0T+Zi4Pdyp+6CdBsqCYAASAIgAJIACIAUpjQ8iC2CA7DaMoDHPQnn4CPcgJaE+GrL3B6Id4iekK8lvPJZB8et8qEYh8j0Gs76rzuKPb17lRmSI3tgV1zvbbXH4LyVd9q7DkcLbO9CSPtrUzgFZW3jQt4E7wp7U7PQte2xAZpX8+P2N0TDf21YY6tSCGA2bArzjP4oS1xDZXBlFe7R8uD4ynRehMsm83fRXZAkAAIgCYAASAIgAJIACIAkAAIgAJIACIBUrAAKzc8fLnUAfcGuOffoq7DgIUvSdtQWnNb6NJ0A7oT5PYb3ruEy3A+Ib4CbrqE5bufCWLXCmVQCKKuzrILtiU4ttuzf7dp6YR8cgm32Ta1xM1LGxnejZRXETlbnLMO8yr5dlh07KWXtY37P4VLYRpYiBNABe22Pw/IJGxRGNji0w8PkaaLLBnF9Ic1otFKK+r+kGl0G7lmRdBsqAJIACIAkAAIgCYAASFOvfwIMAIJ7Za+ecZHPAAAAAElFTkSuQmCC",!0,"SHADOWMASK_INLINE"),this.loadTexture("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAIAAABdtOgoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNrs0bEJgEAURMHFWGzIOmzLQqzJJkyMBDUw85DLRJzHpQv/mCzJXvf6lJqq92NxP1Tv5/u4Sz59/1kTvRoAAAAEAIAAABAAAAIAQAAACAAAAQAgAA+tAN5tAyAAAAQAgAAAEAAAAgBAAAC4/hdfaAEIAAABACAAAAQAgAAAEAAAAgBAAAAIAAABACAAAAQAgAAAEAAAujoEGADEOVdpwC68FwAAAABJRU5ErkJggg==",!0,"SHADOWMASK_APERTURE"),this.loadTexture("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAIAAABdtOgoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAedJREFUeNrsnL9rFEEcR9+uPwhyXBQbm1QWRsg/kcomiCCWVoLYpE5rbWehFnYWpk9lIQhCCCgKWgmCoNglCIomBs/EzVReMnd+RTj94ntMczv72f3OvpvhDpahgQvwGD7AF/j8U+s+foSXsAhTjOAo3IfBcHJf63pvMpqr5aSt0flv8ARmDib7kL1+LsE27P6qXR9192uBcNe+ludUYQ7exS5xqzqA7PXzLJbegLPVApZj+a7dqOYvhvOvqgPIXn97mhAn4US14xBRDlePtn+Yz15/24QvED9zkmSvv0UUoABRgAJEAQoQBShAFKAAUYACRAEK+NfZTP70N7MLGCQXMHAJcglSgChAAaIABYgCFCAKUIAoQAFWP7H6cw+hl1xAzyXISawAUYACRAEKEAUoQBSgAFGAAkQBCpAcAnbCZ+7+xtHJ8bfrb+Ov2NffBX8aC3+H59WON7Aeu8Rq9Wj2+rkT2+7pEUxX8z14EMjfGzPZlgL513DmYLKfv/7mFNyFhbHuXsCVsjlYneOl+1zZk2rfjG7K92OlDGBrzB3Ow+WyrV07PKnbEluD2/C2OoBjyevf20aqG8M8zMKR4XRTZt57eBieZhOmG8Cn5PXnpp+/fn+G+j9AAaIABYgCFCAK+P/4IcAAEwdyjgWX2v0AAAAASUVORK5CYII=",!0,"SHADOWMASK_LCD"),this.loadTexture("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAIAAABdtOgoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAACPNJREFUeNrsXFuMFEUUPdUzs7vsg13XZRVlgQUiKhJFjYhiQnxFIyHqjxHlx2j48c8fE01MjMZHYjTGD2NEVDB+YYgJiYogIT54BJ+orKgQwkN5LC9hd2dnuu051TXTM1vd0z0zDRThZjKZ7qmqe27fW7du3bozAiQBOMBFwFFeXg9cB9wMXAV0884g8DuwCfgR+J53ZGPZsTrJdu3Af7ycAUzn6JOBDt45Cewhj7+AP3lHNo7AwHTwHl0MHAG6gCXAw0A/+wrVwlGXu4CPgRXAMdUlKo0HThDZncACYKIasUjy8gCwAfiSAsguEchc8N4YXcQ0E3gWuBtI+XA7ql1RnhywFngBGFAdq5O0iEnAI8ANgKUYwMeg+J6noX4E7PXZXTAZDT4lxz/BafsacDtgq1fF7CnetDj/ZgPbgd3sng1nMg44zWm7lGzkgxnLoPjAXAZ9NGN39H/ZPRf2cMwFX1BAG3AKuIIC3AIM+yavGDNZijPaVfM0Gt0WTjt3kNEgDi0cdBIFmEVxozBwJbyMvQbowlv0YhgNvqQAl8UrwF3ASMWyEOq23DGncJX7VMngBMng4n6ci+NoHAbuc+rlKvedksHRKMBc8J4CXAEWA08ATWxmRVuTBNVsUc0Hga30p8Paplm6hnuBDPuIyAykv+gBjtOU2jTOwmjwUB4Li4ggG1mAYs8sOy7ipWsfzUFN59HX5iILUBQjx47zlE1lNK2MBl9A8iCnV9zx/VzmAA9wtW/VNprPwDmPGinPBfBWYEjzkIwG7ylgNp1VPTJcwqBCXqbGNuqnpeVrZZDnrqlfXZbbudHgPQX016HgYgA2mR+OaufZpfSedTLo5QfXUNOVz8dc8J4CpozZ09XAoo/rjaM1ot66Gbg0AehUK5uPjAbvKaA7Yj4kVIZulXXRsOhoBIMOlXURZQupueBLUqTrZiH306mwvXbdZOnNx2jw3pen655h4F59yJcaKaORRsgwohnHIV9DwZcUcLBuGdzuh4B9KuVSSccaweC4Sl3aZQowF3xJAQN1T2SLafBR5l81SZW9nMhOfTLsZ8zYWhn0GA3eA7CTE1DUMf4QZQDzARoZ9nHTWQ+DLHNmYJxYntUyGryngPXA38wX1RDv2uzodl8f4jB/IIKmmuzIYccDHASadIrR4EsuaDMnhxWTi4xr8+w+wAOmk9p27izeoTJZcRnItNkODjJerZXlLshc8KU46w9gLlODcbfczTxlfUatVYFZdRfBldzt2DEZZOgglqtzJZ0PNRp8QQFdwD8c/EZuFyLmVWwKcBh4A9jIfMnJoKbtPJRweG7SGvk5ORTAjR8+AX7hIDoLMhq8pwCJZhun4Wx1giYiCOCGzx8AbxLYSEhOxiaanZyG/exZVQwpwDBPb1ezy6jezRsN3lNAXgUAG2gL05i/yysn5pQv6dJ1jmPsvAJ4TsUPw+ESywDgZ9rCRL7boQya6BfWAR+quZwNTPeaC95TgIyU5LHcV8pf9dE0HN/gFpeLZtqLGza8D7zOr+SprKia9pXHcj8pcSfwjuOrJ7AU+lGGDV8Aq/iVPJUVYWGeoeCLHAp9ZUzWTMfVCzzKI+hruLiNY7shrkbbgV+BldyCdlKeYdW9ChMZk2UosWurdwBT+epRJxUj9Mq7+VpHI5LPNVslAjEafClBV5xA3RxK0n2UoY2fT1GGNeqrHi5OdtziMkFnelzdnMuBWvh5mIw3q686WW3ixKiMMxR8ZeAU62Q1NqUbkTw7v8BbFQu4nagMTiPSx8Fjmwv+fKD0hUdwgc5ZEmPdXWK9DAMvyhb6ZErgfdTNAMSlm1jRM5/hYjdHOcJA8RtubLeUN44WpZgJ3reuJ1m/T5IV+e77Y6zjn6GiR39Rq8WNv7uJfDdeEb+x4EUp65RUCbw0M4nG3SE9Dyz0MajYzguVmvwMeJqpYmlKoRsmk8Hz2D/hEnhmaAaZsnyLhcyOqtfXRpKyQmcW02sDtKlu4gvI+RsLPiMKiaBU8iXwneoHLMtYqppVm1ARPCOlhNOAq5lb2cVBdEkzU8EXRmi2hEuphEvgWzio2/Rtms9wMHotg6lMvqxilG9p0sYmg885hVcq4RL4dmZiFgNPxmQAxeBylhVsozBjzjWMBl8KVJMqgc8oX7mE0zAfn8EoF8CHeHlEJTfLyWjwBQUkWALfykBvIavwRU2ZFPmc5tLI5fFJORkN3lNAgiXwUqZ7GAnUXF7jMGK/Te/gjQbvKSCpEviMssw+33SugWwOOscX1fvIaPCeApIqgU+rfeD4aNFJyBNKMWaEpnbEaPCeApIqgZfmNJMrXf0kl8jTlbeNBu9xSrYEPtOgGvuwjbyh4DNCMk+qBF5a5mB42Uc0Ey2+pzR8TQUvUkKkhbASK4HPcXuzn3sZ1OEphEooQxNKGwzeGbadIduxEiuBz6qahEP1rWPyN9Xb9TPAaPBei6RK4G11sYmGmqn1OVmMH77WPwijwXstEiyBl9mPlbQxq1YfmuJj/rbCR3hkNHhPAQmWwGdVMn1j/OJu/251DXmM1yyJRoMvJeNW87C0hrqONDuuDgpI8moivwr8xs193IRiMx3oMp+/GENGgy/MkWRL4LPMpRxgJLCA7UYjM5B1xi/xhK9H/SVfORkN3lNA4iXwMu27lQzmqdYiggCuWb4DvEwBDgfmWswFX6aABEvgbZVpXMv8+HQmMO1Q19nMEublwFNKpFyYAgwF7ykg8RJ4yUDazufMOlr8m40WX3BWLOIvGqdrPi/yq7awH8QbDb40RMIl8KpFC3eDRznoUlY1XcviqVaVq9rDp+ga83ssWOgi16EqDIwGX1kZl2AJfJHBBM5QSfdThnaVj9+jghKZaD4cNcA0GnxlZNaYEvjw6oE2dQiipV6VBogfVpoLvpHZ3YaR/Bcxq7RfOR/BizOLyfLVU8L3f7ZOcC4FSf/w4uyCT59RGYRVeHli0KsW8Nt6GSxYaUcU3i2rCSOD9rmhAB947/k6oYcBVdRgnQ1J/LWDwfGlDTvrODlqLS0yHda5MQ8igC9TAAL/MNF1Ui3ifwEGAI7Rd9mplcoZAAAAAElFTkSuQmCC",!0,"SHADOWMASK_BAYER")])}async loadTexture(e,t,s){const i=this.gl,n=this.textures[s],r=await C(e);i.bindTexture(i.TEXTURE_2D,n.glTexture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),t&&i.generateMipmap(i.TEXTURE_2D),n.width=r.naturalWidth,n.height=r.naturalHeight}loadShaders(){this.loadShader("COMPOSITE","\nprecision mediump float;\n\nvarying vec2 v_texCoord;\n\nuniform sampler2D texture;\nuniform vec2 textureSize;\nuniform float subcarrier;\nuniform sampler2D phaseInfo;\nuniform vec3 c0, c1, c2, c3, c4, c5, c6, c7, c8;\nuniform mat3 decoderMatrix;\nuniform vec3 decoderOffset;\n\nfloat PI = 3.14159265358979323846264;\n\nvec3 pixel(in vec2 q)\n{\n  vec3 c = texture2D(texture, q).rgb;\n  vec2 p = texture2D(phaseInfo, vec2(0, q.y)).rg;\n  float phase = 2.0 * PI * (subcarrier * textureSize.x * q.x + p.x);\n  return c * vec3(1.0, sin(phase), (1.0 - 2.0 * p.y) * cos(phase));\n}\n\nvec3 pixels(vec2 q, float i)\n{\n  return pixel(vec2(q.x + i, q.y)) + pixel(vec2(q.x - i, q.y));\n}\n\nvoid main(void)\n{\n  vec2 q = v_texCoord;\n  vec3 c = pixel(q) * c0;\n  c += pixels(q, 1.0 / textureSize.x) * c1;\n  c += pixels(q, 2.0 / textureSize.x) * c2;\n  c += pixels(q, 3.0 / textureSize.x) * c3;\n  c += pixels(q, 4.0 / textureSize.x) * c4;\n  c += pixels(q, 5.0 / textureSize.x) * c5;\n  c += pixels(q, 6.0 / textureSize.x) * c6;\n  c += pixels(q, 7.0 / textureSize.x) * c7;\n  c += pixels(q, 8.0 / textureSize.x) * c8;\n  gl_FragColor = vec4(decoderMatrix * c + decoderOffset, 1.0);\n}\n",g),this.loadShader("RGB","\nprecision mediump float;\n\nvarying vec2 v_texCoord;\n\nuniform sampler2D texture;\nuniform vec2 textureSize;\nuniform vec3 c0, c1, c2, c3, c4, c5, c6, c7, c8;\nuniform mat3 decoderMatrix;\nuniform vec3 decoderOffset;\n\nvec3 pixel(vec2 q)\n{\n  return texture2D(texture, q).rgb;\n}\n\nvec3 pixels(in vec2 q, in float i)\n{\n  return pixel(vec2(q.x + i, q.y)) + pixel(vec2(q.x - i, q.y));\n}\n\nvoid main(void)\n{\n  vec2 q = v_texCoord;\n  vec3 c = pixel(q) * c0;\n  c += pixels(q, 1.0 / textureSize.x) * c1;\n  c += pixels(q, 2.0 / textureSize.x) * c2;\n  c += pixels(q, 3.0 / textureSize.x) * c3;\n  c += pixels(q, 4.0 / textureSize.x) * c4;\n  c += pixels(q, 5.0 / textureSize.x) * c5;\n  c += pixels(q, 6.0 / textureSize.x) * c6;\n  c += pixels(q, 7.0 / textureSize.x) * c7;\n  c += pixels(q, 8.0 / textureSize.x) * c8;\n  gl_FragColor = vec4(decoderMatrix * c + decoderOffset, 1.0);\n}\n",g),this.loadShader("DISPLAY","\nprecision mediump float;\n\nvarying vec2 v_texCoord;\nvarying vec2 v_texCoord2;\n\nuniform sampler2D texture;\nuniform vec2 textureSize;\nuniform float barrel;\nuniform vec2 barrelSize;\nuniform float scanlineLevel;\nuniform sampler2D shadowMask;\nuniform vec2 shadowMaskSize;\nuniform float shadowMaskLevel;\nuniform float centerLighting;\nuniform sampler2D persistence;\nuniform vec2 persistenceSize;\nuniform vec2 persistenceOrigin;\nuniform float persistenceLevel;\nuniform float luminanceGain;\n\nfloat PI = 3.14159265358979323846264;\n\nvoid main(void)\n{\n  vec2 qc = (v_texCoord2 - vec2(0.5, 0.5)) * barrelSize;\n  vec2 qb = barrel * qc * dot(qc, qc);\n  vec2 q = v_texCoord + qb;\n\n  vec3 c = texture2D(texture, q).rgb;\n\n  float scanline = sin(PI * textureSize.y * q.y);\n  c *= mix(1.0, scanline * scanline, scanlineLevel);\n\n  vec3 mask = texture2D(shadowMask, (v_texCoord2 + qb) * shadowMaskSize).rgb;\n  c *= mix(vec3(1.0, 1.0, 1.0), mask, shadowMaskLevel);\n\n  vec2 lighting = qc * centerLighting;\n  c *= exp(-dot(lighting, lighting));\n\n  c *= luminanceGain;\n\n  vec2 qp = v_texCoord2 * persistenceSize + persistenceOrigin;\n  c = max(c, texture2D(persistence, qp).rgb * persistenceLevel - 0.5 / 256.0);\n\n  gl_FragColor = vec4(c, 1.0);\n}\n","\n// an attribute will receive data from a buffer\nattribute vec4 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_texCoord2;\nvarying vec2 v_texCoord;\nvarying vec2 v_texCoord2;\n\n// all shaders have a main function\nvoid main() {\n  gl_Position = vec4(a_position.x, -a_position.y, a_position.z, a_position.w);\n  v_texCoord = a_texCoord;\n  v_texCoord2 = a_texCoord2;\n}\n")}loadShader(e,t,s){const i=k(this.gl,e,this.gl.VERTEX_SHADER,s),n=k(this.gl,e,this.gl.FRAGMENT_SHADER,t),r=x(this.gl,e,i,n);this.gl.deleteShader(i),this.gl.deleteShader(n),this.shaders[e]=r}deleteShaders(){for(let e of w)this.shaders[e]&&(this.gl.deleteProgram(this.shaders[e]),this.shaders[e]=!1)}vsync(){const e=this.gl;v(this.canvas);const s=this.canvas.width,i=this.canvas.height;this.viewportSize.width==s&&this.viewportSize.height==this.canvasHeight||(this.viewportSize=new t(s,i),e.viewport(0,0,s,i),this.configurationChanged=!0),this.imageChanged&&this.uploadImage(),this.configurationChanged&&this.configureShaders(),(this.imageChanged||this.configurationChanged)&&this.renderImage(),(this.imageChanged||this.configurationChanged||0!=this.image.displayPersistence)&&this.drawDisplayCanvas(),this.imageChanged=!1,this.configurationChanged=!1}uploadImage(){const e=this.gl,t=this.image;this.resizeTexture("IMAGE_IN",t.width,t.height,!0);const s=this.textures.IMAGE_IN;e.bindTexture(e.TEXTURE_2D,s.glTexture);const i=e.LUMINANCE,n=e.UNSIGNED_BYTE,r=(e=>{const t=e.width,s=e.height,i=e.data,n=t*s,r=new Uint8Array(n);for(let e=0;e<n;e++)r[e]=Math.max(i[4*e],i[4*e+1],i[4*e+2]);return r})(t.data);e.texSubImage2D(e.TEXTURE_2D,0,0,0,t.data.width,t.data.height,i,n,r),t.sampleRate==this.imageSampleRate&&t.blackLevel==this.imageBlackLevel&&t.whiteLevel==this.imageWhiteLevel&&t.subCarrier==this.imageSubcarrier||(this.imageSampleRate=t.sampleRate,this.imageBlackLevel=t.blackLevel,this.imageWhiteLevel=t.whiteLevel,this.imageSubcarrier=t.subCarrier,this.configurationChanged=!0);const o=2**Math.ceil(Math.log2(t.height)),a=t.colorBurst,l=t.phaseAlternation,h=new Float32Array(3*o);for(let e=0;e<t.height;e++){const t=a[e%a.length]/2/Math.PI;h[3*e+0]=t-Math.floor(t),h[3*e+1]=l[e%l.length]}const c=this.textures.IMAGE_PHASEINFO;e.bindTexture(e.TEXTURE_2D,c.glTexture),e.texImage2D(e.TEXTURE_2D,0,e.RGB,1,o,0,e.RGB,e.FLOAT,h)}getRenderShader(){switch(this.display.videoDecoder){case"CANVAS_RGB":case"CANVAS_MONOCHROME":return[this.shaders.RGB,"RGB"];case"CANVAS_YUV":case"CANVAS_YIQ":case"CANVAS_CXA2025AS":return[this.shaders.COMPOSITE,"COMPOSITE"]}const e=this.display.videoDecoder;throw new Error(`unknown displayConfiguration.videoDecoder: ${e}`)}configureShaders(){const e=this.gl,[t,s]=this.getRenderShader(),r=this.shaders.DISPLAY,o="COMPOSITE"==s;e.useProgram(t),o&&e.uniform1f(e.getUniformLocation(t,"subcarrier"),this.imageSubcarrier/this.imageSampleRate);const a=i.chebyshevWindow(17,50).normalize();let l,c,d;const u=this.display.videoBandwidth/this.imageSampleRate;if(o){let e=this.display.videoLumaBandwidth/this.imageSampleRate,t=this.display.videoChromaBandwidth/this.imageSampleRate,s=t;"CANVAS_YIQ"==this.display.videoDecoder&&(t+=h/this.imageSampleRate),(0==this.imageSubcarrier||this.display.videoWhiteOnly)&&(e=u,t=u,s=u),l=a.mul(i.lanczosWindow(17,e)),l=l.normalize(),c=a.mul(i.lanczosWindow(17,t)),c=c.normalize().mul(2),d=a.mul(i.lanczosWindow(17,s)),d=d.normalize().mul(2)}else l=a.mul(i.lanczosWindow(17,u)),c=d=l=l.normalize();e.uniform3f(e.getUniformLocation(t,"c0"),l.data[8],c.data[8],d.data[8]),e.uniform3f(e.getUniformLocation(t,"c1"),l.data[7],c.data[7],d.data[7]),e.uniform3f(e.getUniformLocation(t,"c2"),l.data[6],c.data[6],d.data[6]),e.uniform3f(e.getUniformLocation(t,"c3"),l.data[5],c.data[5],d.data[5]),e.uniform3f(e.getUniformLocation(t,"c4"),l.data[4],c.data[4],d.data[4]),e.uniform3f(e.getUniformLocation(t,"c5"),l.data[3],c.data[3],d.data[3]),e.uniform3f(e.getUniformLocation(t,"c6"),l.data[2],c.data[2],d.data[2]),e.uniform3f(e.getUniformLocation(t,"c7"),l.data[1],c.data[1],d.data[1]),e.uniform3f(e.getUniformLocation(t,"c8"),l.data[0],c.data[0],d.data[0]);let A=new n(1,0,0,0,1,0,0,0,1);o||(A=new n(.299,-.168736,.5,.587,-.331264,-.418688,.114,.5,-.081312).mul(A)),"CANVAS_MONOCHROME"==this.display.videoDecoder&&(A=new n(1,.5,0,0,0,0,0,0,0).mul(A)),o&&(0==this.imageSubcarrier||this.display.videoWhiteOnly)&&(A=new n(1,0,0,0,0,0,0,0,0).mul(A)),A=new n(1,0,0,0,this.display.videoSaturation,0,0,0,this.display.videoSaturation).mul(A);let m=2*Math.PI*this.display.videoHue;switch(A=new n(1,0,0,0,Math.cos(m),-Math.sin(m),0,Math.sin(m),Math.cos(m)).mul(A),this.display.videoDecoder){case"CANVAS_RGB":case"CANVAS_MONOCHROME":A=new n(1,1,1,0,-.344136,1.772,1.402,-.714136,0).mul(A);break;case"CANVAS_YUV":case"CANVAS_YIQ":A=new n(1,1,1,0,-.394642,2.032062,1.139883,-.580622,0).mul(A);break;case"CANVAS_CXA2025AS":A=new n(1,0,0,0,0,1,0,1,0).mul(A),m=33*-Math.PI/180,A=new n(1,0,0,0,Math.cos(m),-Math.sin(m),0,Math.sin(m),Math.cos(m)).mul(A),A=new n(1,1,1,1.63,-.378,-1.089,.317,-.466,1.677).mul(A);break;default:throw new Error(`unknown videoDecoder: ${this.display.videoDecoder}`)}const p=this.display.videoBrightness-this.imageBlackLevel;let g;g=o?A.mul(new n(p,0,0,0,0,0,0,0,0)):A.mul(new n(p,0,0,p,0,0,p,0,0)),e.uniform3f(e.getUniformLocation(t,"decoderOffset"),g.at(0,0),g.at(0,1),g.at(0,2));let f=this.display.videoContrast;const _=this.imageWhiteLevel-this.imageBlackLevel;_>0?f/=_:f=0,f<0&&(f=0),A=A.mul(f),e.uniformMatrix3fv(e.getUniformLocation(t,"decoderMatrix"),!1,A.data),e.useProgram(r),e.uniform1f(e.getUniformLocation(r,"barrel"),this.display.displayBarrel),e.uniform1i(e.getUniformLocation(r,"shadowMask"),1),e.uniform1f(e.getUniformLocation(r,"shadowMaskLevel"),this.display.displayShadowMaskLevel),e.uniform1f(e.getUniformLocation(r,"persistenceLevel"),this.display.displayPersistence/(1/60+this.display.displayPersistence)),0==this.display.displayPersistence&&this.resizeTexture("IMAGE_PERSISTENCE",0,0);let b=this.display.displayCenterLighting;Math.abs(b)<.001&&(b=.001),e.uniform1f(e.getUniformLocation(r,"centerLighting"),1/b-1),e.uniform1f(e.getUniformLocation(r,"luminanceGain"),this.display.displayLuminanceGain)}renderImage(){const e=this.gl,[t,i]=this.getRenderShader(),n="COMPOSITE"==i;e.useProgram(t);const r=this.textures.IMAGE_IN.size;this.resizeTexture("IMAGE_DECODED",r.width,r.height),e.uniform1i(e.getUniformLocation(t,"texture"),0),e.uniform2f(e.getUniformLocation(t,"textureSize"),r.width,r.height),n&&(e.uniform1i(e.getUniformLocation(t,"phaseInfo"),1),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,this.textures.IMAGE_PHASEINFO.glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.activeTexture(e.TEXTURE0));const o=this.image.size;for(let i=0;i<this.image.height;i+=this.viewportSize.height)for(let n=0;n<this.image.width;n+=this.viewportSize.width){const a=this.viewportSize.copy();n+a.width>o.width&&(a.width=o.width-n),i+a.height>o.height&&(a.height=o.height-i);const l=new s(n/r.width,i/r.height,a.width/r.width,a.height/r.height),h=new s(-1,-1,2*a.width/this.viewportSize.width,2*a.height/this.viewportSize.height);e.bindTexture(e.TEXTURE_2D,this.textures.IMAGE_IN.glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),this.drawRectangle(t,h,l),e.bindTexture(e.TEXTURE_2D,this.textures.IMAGE_DECODED.glTexture),e.copyTexSubImage2D(e.TEXTURE_2D,0,n,i,0,0,a.width,a.height)}}drawRectangle(e,t,s,i){const n=this.gl;n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);const r=n.getAttribLocation(e,"a_position"),o=[n.getAttribLocation(e,"a_texCoord")],a=[s];i&&(o.push(n.getAttribLocation(e,"a_texCoord2")),a.push(i));const l=this.buffers[0];n.bindBuffer(n.ARRAY_BUFFER,l);const h=t.l,c=t.r,d=t.t,u=t.b;n.bufferData(n.ARRAY_BUFFER,new Float32Array([h,d,c,d,h,u,h,u,c,d,c,u]),n.STATIC_DRAW),n.enableVertexAttribArray(r),n.bindBuffer(n.ARRAY_BUFFER,l),n.vertexAttribPointer(r,2,n.FLOAT,!1,0,0);for(let e=0;e<a.length;e++){const t=this.buffers[e+1];n.bindBuffer(n.ARRAY_BUFFER,t);const s=a[e].l,i=a[e].r,r=a[e].t,l=a[e].b;n.bufferData(n.ARRAY_BUFFER,new Float32Array([s,r,i,r,s,l,s,l,i,r,i,l]),n.STATIC_DRAW),n.enableVertexAttribArray(o[e]),n.bindBuffer(n.ARRAY_BUFFER,t),n.vertexAttribPointer(o[e],2,n.FLOAT,!1,0,0)}n.drawArrays(n.TRIANGLES,0,6)}drawDisplayCanvas(){const i=this.gl,n=this.shaders.DISPLAY;if(0==this.image.width||0==this.image.height)return void this.resizeTexture("IMAGE_PERSISTENCE",0,0);const r=this.display.displayResolution,o=new s(-1,-1,2,2),a=this.viewportSize.ratio,l=r.ratio,h=a/l;h>1?(o.origin.x/=h,o.size.width/=h):(o.origin.y*=h,o.size.height*=h);const c=new s(0,0,1,1),d=this.image.interlace/this.image.height,u=this.getDisplayCanvasTexPoint(new e(-1,2*d-1)),A=this.getDisplayCanvasTexPoint(new e(1,1+2*d)),m=new s(u.x,u.y,A.x-u.x,A.y-u.y),p=new t(.5*this.viewportSize.width*o.size.width,.5*this.viewportSize.height*o.size.height),g=new t(p.width*this.display.videoSize.width,p.height*this.display.videoSize.height);let f;const _=this.textures.IMAGE_DECODED;i.useProgram(n);const b=_.size;i.uniform1i(i.getUniformLocation(n,"texture"),0),i.uniform2f(i.getUniformLocation(n,"textureSize"),b.width,b.height),f=new s(-.5,-.5/l,1,1/l),i.uniform2f(i.getUniformLocation(n,"barrelSize"),1,1/l);const C=g.height/this.image.height;let y,w,v=this.display.displayScanlineLevel;switch(v=C>2.5?v:C<2?0:(C-2)/.5*v,i.uniform1f(i.getUniformLocation(n,"scanlineLevel"),v),this.display.displayShadowMask){case"SHADOWMASK_TRIAD":y=this.textures.SHADOWMASK_TRIAD,w=2/(274/240);break;case"SHADOWMASK_INLINE":y=this.textures.SHADOWMASK_INLINE,w=2;break;case"SHADOWMASK_APERTURE":y=this.textures.SHADOWMASK_APERTURE,w=2;break;case"SHADOWMASK_LCD":y=this.textures.SHADOWMASK_LCD,w=2;break;case"SHADOWMASK_BAYER":y=this.textures.SHADOWMASK_BAYER,w=2}let k=this.display.displayShadowMaskDotPitch;k<=.001&&(k=.001);const x=r.width/this.display.displayPixelDensity*25.4*.5/k,E=new t(x,x*w/l);i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,y.glTexture),i.uniform2f(i.getUniformLocation(n,"shadowMaskSize"),E.width,E.height),i.activeTexture(i.TEXTURE2),i.bindTexture(i.TEXTURE_2D,this.textures.IMAGE_PERSISTENCE.glTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.activeTexture(i.TEXTURE0),i.uniform1i(i.getUniformLocation(n,"persistence"),2),i.uniform2f(i.getUniformLocation(n,"persistenceOrigin"),this.persistenceTexRect.x,this.persistenceTexRect.y),i.uniform2f(i.getUniformLocation(n,"persistenceSize"),this.persistenceTexRect.width,this.persistenceTexRect.height),i.bindTexture(i.TEXTURE_2D,_.glTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),this.drawRectangle(n,o,m,c)}getDisplayCanvasTexPoint(t){const s=this.display.videoCenter,i=this.display.videoSize;t=new e((t.x-2*s.x)/i.width,(t.y-2*s.y)/i.height);const n=this.image.size,r=this.textures.IMAGE_IN.size;return t.x=.5*(t.x+1)*n.width/r.width,t.y=.5*(t.y+1)*n.height/r.height,t}resizeTexture(e,t,s,i=!1){const n=this.gl,r=this.textures[e];if(!r)throw new Error(`Cannot find texture named ${e}`);if(t<4&&(t=4),s<4&&(s=4),t=2**Math.ceil(Math.log2(t)),s=2**Math.ceil(Math.log2(s)),r.width!=t||r.height!=s){r.width=t,r.height=s,n.bindTexture(n.TEXTURE_2D,r.glTexture);const e=new Uint8Array(t*s*(i?1:4)),o=i?n.LUMINANCE:n.RGBA;n.texImage2D(n.TEXTURE_2D,0,o,t,s,0,o,n.UNSIGNED_BYTE,e)}}},DisplayConfiguration:class{constructor(){this.videoDecoder="CANVAS_YUV",this.videoBrightness=0,this.videoContrast=1,this.videoSaturation=1,this.videoHue=0,this.videoCenter=new e(0,0),this.videoSize=new t(1.05,1.05),this.videoBandwidth=6e6,this.videoLumaBandwidth=2e6,this.videoChromaBandwidth=6e5,this.videoWhiteOnly=!1,this.displayResolution=new t(640,480),this.displayPixelDensity=72,this.displayBarrel=.05,this.displayScanlineLevel=.05,this.displayShadowMaskLevel=.05,this.displayShadowMaskDotPitch=.5,this.displayShadowMask="SHADOWMASK_TRIAD",this.displayPersistence=0,this.displayCenterLighting=1,this.displayLuminanceGain=1}},ImageInfo:class{constructor(e){if("object"!=typeof e)throw new Error(`want typeof data == 'object'; got '${typeof e}'`);if(!(e instanceof ImageData))throw new Error(`want data instanceof ImageData; got '${e.constructor.name}'`);this.sampleRate=l,this.blackLevel=0,this.whiteLevel=1,this.interlace=0,this.subCarrier=a,this.colorBurst=_.colorBurst,this.phaseAlternation=[!1],this.data=e}get width(){return this.data.width}get height(){return this.data.height}get size(){return new t(this.data.width,this.data.height)}},Vector:i,Size:t,Point:e}}();e.exports={screenEmu:t}},4184:(e,t)=>{var s;!function(){"use strict";var i={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var s=arguments[t];if(s){var r=typeof s;if("string"===r||"number"===r)e.push(s);else if(Array.isArray(s)){if(s.length){var o=n.apply(null,s);o&&e.push(o)}}else if("object"===r)if(s.toString===Object.prototype.toString)for(var a in s)i.call(s,a)&&s[a]&&e.push(a);else e.push(s.toString())}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0===(s=function(){return n}.apply(t,[]))||(e.exports=s)}()},1750:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".full-page{background:#000}.js-components-css-App-module__container{font-size:14px;font-family:sans-serif;line-height:normal;display:flex;flex-direction:column;width:100%;height:100%}","",{version:3,sources:["webpack://./js/components/css/App.module.scss"],names:[],mappings:"AAAA,WACI,eAAA,CAGJ,yCACI,cAAA,CACA,sBAAA,CACA,kBAAA,CACA,YAAA,CACA,qBAAA,CACA,UAAA,CACA,WAAA",sourcesContent:[":global(.full-page) {\n    background: black;\n}\n\n.container {\n    font-size: 14px;\n    font-family: sans-serif;\n    line-height: normal;\n    display: flex;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n}\n"],sourceRoot:""}]),o.locals={container:"js-components-css-App-module__container"};const a=o},5120:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Apple2-module__container{display:flex;margin:auto}.js-components-css-Apple2-module__outer{width:620px;display:none}.js-components-css-Apple2-module__outer.js-components-css-Apple2-module__ready{display:block}","",{version:3,sources:["webpack://./js/components/css/Apple2.module.scss"],names:[],mappings:"AAAA,4CACI,YAAA,CACA,WAAA,CAGJ,wCACI,WAAA,CACA,YAAA,CAEA,+EACI,aAAA",sourcesContent:[".container {\n    display: flex;\n    margin: auto;\n}\n\n.outer {\n    width: 620px;\n    display: none;\n\n    &.ready {\n        display: block;\n    }\n}\n"],sourceRoot:""}]),o.locals={container:"js-components-css-Apple2-module__container",outer:"js-components-css-Apple2-module__outer",ready:"js-components-css-Apple2-module__ready"};const a=o},5370:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r),a=s(1667),l=s.n(a),h=new URL(s(8933),s.b),c=new URL(s(1345),s.b),d=new URL(s(5521),s.b),u=new URL(s(3145),s.b),A=o()(n()),m=l()(h),p=l()(c),g=l()(d),f=l()(u);A.push([e.id,".js-components-css-BlockDisk-module__disk{align-items:center;display:flex;flex-grow:1}.js-components-css-BlockDisk-module__diskLight{margin:5px;background-image:url("+m+");background-size:16px 16px;flex-shrink:0;width:16px;height:16px}.js-components-css-BlockDisk-module__diskLight.js-components-css-BlockDisk-module__on{background-image:url("+p+")}.js-components-css-BlockDisk-module__diskLabel{color:#000;font-family:sans-serif;font-weight:bold;margin-right:.5em;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;flex-grow:1;user-select:none}@media only screen and (min-resolution: 1.25dppx){.js-components-css-BlockDisk-module__diskLight{background-image:url("+g+")}.js-components-css-BlockDisk-module__diskLight.js-components-css-BlockDisk-module__on{background-image:url("+f+")}}","",{version:3,sources:["webpack://./js/components/css/BlockDisk.module.scss"],names:[],mappings:"AAAA,0CACI,kBAAA,CACA,YAAA,CACA,WAAA,CAGJ,+CACI,UAAA,CACA,wDAAA,CACA,yBAAA,CACA,aAAA,CACA,UAAA,CACA,WAAA,CAGJ,sFACI,wDAAA,CAGJ,+CACI,UAAA,CACA,sBAAA,CACA,gBAAA,CACA,iBAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CACA,WAAA,CACA,gBAAA,CAGJ,kDACI,+CACI,wDAAA,CAGJ,sFACI,wDAAA,CAAA",sourcesContent:['.disk {\n    align-items: center;\n    display: flex;\n    flex-grow: 1;\n}\n\n.diskLight {\n    margin: 5px;\n    background-image: url("../../../css/green-off-16.png");\n    background-size: 16px 16px;\n    flex-shrink: 0;\n    width: 16px;\n    height: 16px;\n}\n\n.diskLight.on {\n    background-image: url("../../../css/green-on-16.png");\n}\n\n.diskLabel {\n    color: #000;\n    font-family: sans-serif;\n    font-weight: bold;\n    margin-right: 0.5em;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    flex-grow: 1;\n    user-select: none;\n}\n\n@media only screen and (min-resolution: 1.25dppx) {\n    .diskLight {\n        background-image: url("../../../css/green-off-32.png");\n    }\n\n    .diskLight.on {\n        background-image: url("../../../css/green-on-32.png");\n    }\n}\n'],sourceRoot:""}]),A.locals={disk:"js-components-css-BlockDisk-module__disk",diskLight:"js-components-css-BlockDisk-module__diskLight",on:"js-components-css-BlockDisk-module__on",diskLabel:"js-components-css-BlockDisk-module__diskLabel"};const _=A},4178:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-BlockFileModal-module__modalContent{width:320px}","",{version:3,sources:["webpack://./js/components/css/BlockFileModal.module.scss"],names:[],mappings:"AAAA,uDACI,WAAA",sourcesContent:[".modalContent {\n    width: 320px;\n}\n"],sourceRoot:""}]),o.locals={modalContent:"js-components-css-BlockFileModal-module__modalContent"};const a=o},2577:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-CPUMeter-module__khz{margin-right:4px;overflow:hidden;padding:4px;font-family:Courier,monospace;font-size:12px;width:60px;height:15px;text-align:right;background:#000;color:lime;border:2px inset #888;border-radius:4px;user-select:none}","",{version:3,sources:["webpack://./js/components/css/CPUMeter.module.scss"],names:[],mappings:"AAAA,wCACI,gBAAA,CACA,eAAA,CACA,WAAA,CACA,6BAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CACA,qBAAA,CACA,iBAAA,CACA,gBAAA",sourcesContent:[".khz {\n    margin-right: 4px;\n    overflow: hidden;\n    padding: 4px;\n    font-family: Courier, monospace;\n    font-size: 12px;\n    width: 60px;\n    height: 15px;\n    text-align: right;\n    background: #000;\n    color: #0f0;\n    border: 2px inset #888;\n    border-radius: 4px;\n    user-select: none;\n}\n"],sourceRoot:""}]),o.locals={khz:"js-components-css-CPUMeter-module__khz"};const a=o},2177:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,'.js-components-css-Components-module__components{font-size:14px;font-family:sans-serif}.js-components-css-Components-module__components a[role=button]{text-decoration:none}.js-components-css-Components-module__components button,.js-components-css-Components-module__components a[role=button],.js-components-css-Components-module__components input[type=file]::file-selector-button{background:#44372c;color:#fff;padding:2px 8px;border:1px outset #66594e;border-radius:3px;font-size:15px;min-width:75px}.js-components-css-Components-module__components button.js-components-css-Components-module__iconButton,.js-components-css-Components-module__components a[role=button].js-components-css-Components-module__iconButton,.js-components-css-Components-module__components input[type=file]::file-selector-button.js-components-css-Components-module__iconButton{min-width:36px;margin:0 2px}.js-components-css-Components-module__components button:hover,.js-components-css-Components-module__components a[role=button]:hover,.js-components-css-Components-module__components input[type=file]::file-selector-button{background-color:#55473d;border:1px outset #66594e}.js-components-css-Components-module__components button:active,.js-components-css-Components-module__components a[role=button]:active,.js-components-css-Components-module__components input[type=file]::file-selector-button{background-color:#22150a;border:1px outset #44372c}.js-components-css-Components-module__components button:focus,.js-components-css-Components-module__components a[role=button]:focus,.js-components-css-Components-module__components input[type=file]::file-selector-button{outline:none}.js-components-css-Components-module__components input[type=checkbox]{appearance:none;background-color:#65594d;border:1px inset #65594d;padding:7px;top:7px;border-radius:3px;display:inline-block;position:relative}.js-components-css-Components-module__components input[type=checkbox]:checked{background-color:#65594d;border:1px inset #65594d;color:#0d0}.js-components-css-Components-module__components input[type=checkbox]:checked::after{content:"✖";font-size:12px;position:absolute;top:0;left:2px;color:#0d0}',"",{version:3,sources:["webpack://./js/components/css/Components.module.scss"],names:[],mappings:"AAAA,iDAAA,cACI,CAAA,sBACA,CAAA,gEAEA,oBACI,CAAA,gNAGJ,kBAGI,CAAA,UACA,CAAA,eACA,CAAA,yBACA,CAAA,iBACA,CAAA,cACA,CAAA,cACA,CAAA,gWAEA,cACI,CAAA,YACA,CAAA,4NAIR,wBAGI,CAAA,yBACA,CAAA,8NAGJ,wBAGI,CAAA,yBACA,CAAA,4NAGJ,YAGI,CAAA,sEAGJ,eACI,CAAA,wBACA,CAAA,wBACA,CAAA,WACA,CAAA,OACA,CAAA,iBACA,CAAA,oBACA,CAAA,iBACA,CAAA,8EAGJ,wBACI,CAAA,wBACA,CAAA,UACA,CAAA,qFAGJ,WACI,CAAA,cACA,CAAA,iBACA,CAAA,KACA,CAAA,QACA,CAAA,UACA",sourcesContent:['.components {\n    font-size: 14px;\n    font-family: sans-serif;\n\n    a[role="button"] {\n        text-decoration: none;\n    }\n\n    button,\n    a[role="button"],\n    input[type="file"]::file-selector-button {\n        background: #44372c;\n        color: #fff;\n        padding: 2px 8px;\n        border: 1px outset #66594e;\n        border-radius: 3px;\n        font-size: 15px;\n        min-width: 75px;\n\n        &.iconButton {\n            min-width: 36px;\n            margin: 0 2px;\n        }\n    }\n\n    button:hover,\n    a[role="button"]:hover,\n    input[type="file"]::file-selector-button {\n        background-color: #55473d;\n        border: 1px outset #66594e;\n    }\n\n    button:active,\n    a[role="button"]:active,\n    input[type="file"]::file-selector-button {\n        background-color: #22150a;\n        border: 1px outset #44372c;\n    }\n\n    button:focus,\n    a[role="button"]:focus,\n    input[type="file"]::file-selector-button {\n        outline: none;\n    }\n\n    input[type="checkbox"] {\n        appearance: none;\n        background-color: #65594d;\n        border: 1px inset #65594d;\n        padding: 7px;\n        top: 7px;\n        border-radius: 3px;\n        display: inline-block;\n        position: relative;\n    }\n\n    input[type="checkbox"]:checked {\n        background-color: #65594d;\n        border: 1px inset #65594d;\n        color: #0d0;\n    }\n\n    input[type="checkbox"]:checked::after {\n        content: "\\2716";\n        font-size: 12px;\n        position: absolute;\n        top: 0;\n        left: 2px;\n        color: #0d0;\n    }\n}\n'],sourceRoot:""}]),o.locals={components:"js-components-css-Components-module__components",iconButton:"js-components-css-Components-module__iconButton"};const a=o},9549:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-ControlButton-module__active{color:lime}.js-components-css-ControlButton-module__iconButton{min-width:36px !important;margin:0 2px}","",{version:3,sources:["webpack://./js/components/css/ControlButton.module.scss"],names:[],mappings:"AAAA,gDACI,UAAA,CAGJ,oDACI,yBAAA,CACA,YAAA",sourcesContent:[".active {\n    color: #0f0;\n}\n\n.iconButton {\n    min-width: 36px !important;\n    margin: 0 2px;\n}\n"],sourceRoot:""}]),o.locals={active:"js-components-css-ControlButton-module__active",iconButton:"js-components-css-ControlButton-module__iconButton"};const a=o},8046:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-ControlStrip-module__reset{background:#44372c;border-left:3px solid #65594d;border-top:3px solid #65594d;border-right:3px solid #110e0d;border-bottom:3px solid #110e0d;border-radius:3px;color:#fff;font:9px Helvetica,sans-serif;height:36px;padding:0;margin-left:10px;width:36px;display:flex;justify-content:center;align-items:center;user-select:none}.js-components-css-ControlStrip-module__reset:hover{background:#44372c;border:3px outset #66594e}.js-components-css-ControlStrip-module__reset:active{background-color:#22150a;border-left:3px solid #44372c;border-top:3px solid #44372c;border-right:3px solid #000;border-bottom:3px solid #000}.full-page .js-components-css-ControlStrip-module__reset{display:none}.js-components-css-ControlStrip-module__resetRow{align-items:center;display:flex;margin:10px 0}","",{version:3,sources:["webpack://./js/components/css/ControlStrip.module.scss"],names:[],mappings:"AAAA,8CACI,kBAAA,CACA,6BAAA,CACA,4BAAA,CACA,8BAAA,CACA,+BAAA,CAGA,iBAAA,CACA,UAAA,CACA,6BAAA,CACA,WAAA,CACA,SAAA,CACA,gBAAA,CACA,UAAA,CACA,YAAA,CACA,sBAAA,CACA,kBAAA,CACA,gBAAA,CAEA,oDACI,kBAAA,CACA,yBAAA,CAGJ,qDACI,wBAAA,CACA,6BAAA,CACA,4BAAA,CACA,2BAAA,CACA,4BAAA,CAIR,yDACI,YAAA,CAGJ,iDACI,kBAAA,CACA,YAAA,CACA,aAAA",sourcesContent:[".reset {\n    background: #44372c;\n    border-left: 3px solid #65594d;\n    border-top: 3px solid #65594d;\n    border-right: 3px solid #110e0d;\n    border-bottom: 3px solid #110e0d;\n\n    /* border: 5px outset #66594E; */\n    border-radius: 3px;\n    color: white;\n    font: 9px Helvetica, sans-serif;\n    height: 36px;\n    padding: 0;\n    margin-left: 10px;\n    width: 36px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    user-select: none;\n\n    &:hover {\n        background: #44372c;\n        border: 3px outset #66594e;\n    }\n\n    &:active {\n        background-color: #22150a;\n        border-left: 3px solid #44372c;\n        border-top: 3px solid #44372c;\n        border-right: 3px solid #000;\n        border-bottom: 3px solid #000;\n    }\n}\n\n:global(.full-page) .reset {\n    display: none;\n}\n\n.resetRow {\n    align-items: center;\n    display: flex;\n    margin: 10px 0;\n}\n"],sourceRoot:""}]),o.locals={reset:"js-components-css-ControlStrip-module__reset",resetRow:"js-components-css-ControlStrip-module__resetRow"};const a=o},9656:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r),a=s(1667),l=s.n(a),h=new URL(s(7442),s.b),c=new URL(s(4122),s.b),d=new URL(s(6731),s.b),u=new URL(s(3314),s.b),A=o()(n()),m=l()(h),p=l()(c),g=l()(d),f=l()(u);A.push([e.id,".js-components-css-DiskII-module__disk{align-items:center;display:flex;flex-grow:1}.js-components-css-DiskII-module__diskLight{margin:5px;background-image:url("+m+");background-size:16px 16px;flex-shrink:0;width:16px;height:16px}.js-components-css-DiskII-module__diskLight.js-components-css-DiskII-module__on{background-image:url("+p+")}.js-components-css-DiskII-module__diskLabel{color:#000;font-family:sans-serif;font-weight:bold;margin-right:.5em;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;flex-grow:1;user-select:none}@media only screen and (min-resolution: 1.25dppx){.js-components-css-DiskII-module__diskLight{background-image:url("+g+")}.js-components-css-DiskII-module__diskLight.js-components-css-DiskII-module__on{background-image:url("+f+")}}","",{version:3,sources:["webpack://./js/components/css/DiskII.module.scss"],names:[],mappings:"AAAA,uCACI,kBAAA,CACA,YAAA,CACA,WAAA,CAGJ,4CACI,UAAA,CACA,wDAAA,CACA,yBAAA,CACA,aAAA,CACA,UAAA,CACA,WAAA,CAGJ,gFACI,wDAAA,CAGJ,4CACI,UAAA,CACA,sBAAA,CACA,gBAAA,CACA,iBAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CACA,WAAA,CACA,gBAAA,CAGJ,kDACI,4CACI,wDAAA,CAGJ,gFACI,wDAAA,CAAA",sourcesContent:['.disk {\n    align-items: center;\n    display: flex;\n    flex-grow: 1;\n}\n\n.diskLight {\n    margin: 5px;\n    background-image: url("../../../css/red-off-16.png");\n    background-size: 16px 16px;\n    flex-shrink: 0;\n    width: 16px;\n    height: 16px;\n}\n\n.diskLight.on {\n    background-image: url("../../../css/red-on-16.png");\n}\n\n.diskLabel {\n    color: #000;\n    font-family: sans-serif;\n    font-weight: bold;\n    margin-right: 0.5em;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    flex-grow: 1;\n    user-select: none;\n}\n\n@media only screen and (min-resolution: 1.25dppx) {\n    .diskLight {\n        background-image: url("../../../css/red-off-32.png");\n    }\n\n    .diskLight.on {\n        background-image: url("../../../css/red-on-32.png");\n    }\n}\n'],sourceRoot:""}]),A.locals={disk:"js-components-css-DiskII-module__disk",diskLight:"js-components-css-DiskII-module__diskLight",on:"js-components-css-DiskII-module__on",diskLabel:"js-components-css-DiskII-module__diskLabel"};const _=A},9781:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-DownloadModal-module__modalContent{display:flex;font-size:1.1em;justify-content:space-between;padding:10px 0;width:320px}","",{version:3,sources:["webpack://./js/components/css/DownloadModal.module.scss"],names:[],mappings:"AAAA,sDACI,YAAA,CACA,eAAA,CACA,6BAAA,CACA,cAAA,CACA,WAAA",sourcesContent:[".modalContent {\n    display: flex;\n    font-size: 1.1em;\n    justify-content: space-between;\n    padding: 10px 0;\n    width: 320px;\n}\n"],sourceRoot:""}]),o.locals={modalContent:"js-components-css-DownloadModal-module__modalContent"};const a=o},3024:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Drives-module__drives{display:flex;width:100%}.js-components-css-Drives-module__driveBay{display:flex;flex-direction:column;flex:1 1 50%}","",{version:3,sources:["webpack://./js/components/css/Drives.module.scss"],names:[],mappings:"AAAA,yCACI,YAAA,CACA,UAAA,CAGJ,2CACI,YAAA,CACA,qBAAA,CACA,YAAA",sourcesContent:[".drives {\n    display: flex;\n    width: 100%;\n}\n\n.driveBay {\n    display: flex;\n    flex-direction: column;\n    flex: 1 1 50%;\n}\n"],sourceRoot:""}]),o.locals={drives:"js-components-css-Drives-module__drives",driveBay:"js-components-css-Drives-module__driveBay"};const a=o},1630:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-ErrorModal-module__errorModal{width:320px;font-size:1.1em;padding:5px 11px}","",{version:3,sources:["webpack://./js/components/css/ErrorModal.module.scss"],names:[],mappings:"AAAA,iDACI,WAAA,CACA,eAAA,CACA,gBAAA",sourcesContent:[".errorModal {\n    width: 320px;\n    font-size: 1.1em;\n    padding: 5px 11px;\n}\n"],sourceRoot:""}]),o.locals={errorModal:"js-components-css-ErrorModal-module__errorModal"};const a=o},1244:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-FileModal-module__loadModal select{width:250px;height:300px;font-size:14px}","",{version:3,sources:["webpack://./js/components/css/FileModal.module.scss"],names:[],mappings:"AAAA,sDACI,WAAA,CACA,YAAA,CACA,cAAA",sourcesContent:[".loadModal select {\n    width: 250px;\n    height: 300px;\n    font-size: 14px;\n}\n"],sourceRoot:""}]),o.locals={loadModal:"js-components-css-FileModal-module__loadModal"};const a=o},3162:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,'.js-components-css-Header-module__header{width:580px;margin:auto}@media all and (display-mode: minimal-ui){.js-components-css-Header-module__header{display:none}}.js-components-css-Header-module__header img{border:none}.full-page .js-components-css-Header-module__header{display:none}.js-components-css-Header-module__badge{cursor:pointer;user-select:none}.js-components-css-Header-module__subtitle{margin:0;padding:3px 0 0 10;color:#000;font-family:"Adobe Garamond Pro",Garamond,Times,serif;font-size:13px;font-weight:normal;user-select:none}',"",{version:3,sources:["webpack://./js/components/css/Header.module.scss"],names:[],mappings:"AAAA,yCACI,WAAA,CACA,WAAA,CAGJ,0CACI,yCACI,YAAA,CAAA,CAIR,6CACI,WAAA,CAGJ,oDACI,YAAA,CAGJ,wCACI,cAAA,CACA,gBAAA,CAGJ,2CACI,QAAA,CACA,kBAAA,CACA,UAAA,CACA,qDAAA,CACA,cAAA,CACA,kBAAA,CACA,gBAAA",sourcesContent:['.header {\n    width: 580px;\n    margin: auto;\n}\n\n@media all and (display-mode: minimal-ui) {\n    .header {\n        display: none;\n    }\n}\n\n.header img {\n    border: none;\n}\n\n:global(.full-page) .header {\n    display: none;\n}\n\n.badge {\n    cursor: pointer;\n    user-select: none;\n}\n\n.subtitle {\n    margin: 0;\n    padding: 3px 0 0 10;\n    color: black;\n    font-family: "Adobe Garamond Pro", Garamond, Times, serif;\n    font-size: 13px;\n    font-weight: normal;\n    user-select: none;\n}\n'],sourceRoot:""}]),o.locals={header:"js-components-css-Header-module__header",badge:"js-components-css-Header-module__badge",subtitle:"js-components-css-Header-module__subtitle"};const a=o},7922:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Inset-module__inset{border-radius:6px;border:3px inset #f0edd0;padding:6px;margin:0 auto;display:flex;width:604px}.full-page .js-components-css-Inset-module__inset{display:none}","",{version:3,sources:["webpack://./js/components/css/Inset.module.scss"],names:[],mappings:"AAAA,uCACI,iBAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CACA,YAAA,CACA,WAAA,CAGJ,kDACI,YAAA",sourcesContent:[".inset {\n    border-radius: 6px;\n    border: 3px inset #f0edd0;\n    padding: 6px;\n    margin: 0 auto;\n    display: flex;\n    width: 604px;\n}\n\n:global(.full-page) .inset {\n    display: none;\n}\n"],sourceRoot:""}]),o.locals={inset:"js-components-css-Inset-module__inset"};const a=o},7611:(e,t,s)=>{"use strict";s.d(t,{Z:()=>_});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r),a=s(1667),l=s.n(a),h=new URL(s(869),s.b),c=new URL(s(5149),s.b),d=new URL(s(3199),s.b),u=new URL(s(8452),s.b),A=o()(n()),m=l()(h),p=l()(c),g=l()(d),f=l()(u);A.push([e.id,".js-components-css-Keyboard-module__keyboard{margin-left:15px;user-select:none}.apple2e .js-components-css-Keyboard-module__keyboard{margin-left:0}.js-components-css-Keyboard-module__row{display:block;margin:0;padding:0;height:42px;font-family:Helvetica,sans-serif;width:570px}.apple2e .js-components-css-Keyboard-module__row{width:610px}.js-components-css-Keyboard-module__row0{margin-left:20px}.js-components-css-Keyboard-module__row2{margin-left:10px}.js-components-css-Keyboard-module__row3{margin-left:10px}.js-components-css-Keyboard-module__row4{margin-left:10px}.apple2e .js-components-css-Keyboard-module__row0{margin-left:0}.apple2e .js-components-css-Keyboard-module__row2{margin-left:0}.apple2e .js-components-css-Keyboard-module__row3{margin-left:0}.apple2e .js-components-css-Keyboard-module__row4{margin-left:0}.js-components-css-Keyboard-module__key{display:inline-block;margin:0;padding:0;width:32px;height:32px;background-color:#44372c;color:#fff;text-align:center;position:relative;border-left:5px solid #65594d;border-top:5px solid #65594d;border-right:5px solid #110e0d;border-bottom:5px solid #110e0d;border-radius:5px;cursor:pointer}.js-components-css-Keyboard-module__key .js-components-css-Keyboard-module__active{color:#4f4}.js-components-css-Keyboard-module__key .js-components-css-Keyboard-module__small{font-size:7px}.js-components-css-Keyboard-module__key div{border-radius:3px;position:absolute;bottom:0;width:100%;text-align:center}.js-components-css-Keyboard-module__key span{font-size:13px}.js-components-css-Keyboard-module__pressed{background-color:#22150a;border-left:5px solid #44372c;border-top:5px solid #44372c;border-right:5px solid #000;border-bottom:5px solid #000}.js-components-css-Keyboard-module__vCenter div{bottom:10px}.js-components-css-Keyboard-module__vCenter2 div{bottom:5px;line-height:10px}.js-components-css-Keyboard-module__key-RETURN{width:52px}.js-components-css-Keyboard-module__key-DELETE{width:47px}.js-components-css-Keyboard-module__key-TAB{width:47px}.js-components-css-Keyboard-module__key-POWER{width:38px;height:38px;border:2px groove #000;background-color:#ffd;color:#000;border-radius:2px}.js-components-css-Keyboard-module__key-POWER div{bottom:15px}.js-components-css-Keyboard-module__key-nbsp{margin-left:62px;width:330px}.apple2e .js-components-css-Keyboard-module__key-CTRL{width:60px}.apple2e .js-components-css-Keyboard-module__key-RETURN{width:60px}.apple2e .js-components-css-Keyboard-module__key-SHIFT{width:81px}.apple2e .js-components-css-Keyboard-module__key-nbsp{margin-left:0;width:215px}.js-components-css-Keyboard-module__key-POW{width:38px;height:38px;border:2px groove #000;background-color:#ffd;color:#000;border-radius:2px}.js-components-css-Keyboard-module__key-POW div{bottom:15px}.js-components-css-Keyboard-module__key-POW span{background:#4f4;color:#4f4}.js-components-css-Keyboard-module__key-OPEN_APPLE div{background-image:url("+m+");width:24px;height:24px;bottom:1px;left:4px}.js-components-css-Keyboard-module__key-CLOSED_APPLE div{background-image:url("+p+");width:24px;height:24px;bottom:1px;left:4px}.js-components-css-Keyboard-module__key-OPEN_APPLE span{display:none}.js-components-css-Keyboard-module__key-CLOSED_APPLE span{display:none}.js-components-css-Keyboard-module__key-OPEN_APPLE.js-components-css-Keyboard-module__active div{background-image:url("+g+")}.js-components-css-Keyboard-module__key-CLOSED_APPLE.js-components-css-Keyboard-module__active div{background-image:url("+f+")}","",{version:3,sources:["webpack://./js/components/css/Keyboard.module.scss"],names:[],mappings:"AAAA,6CACI,gBAAA,CACA,gBAAA,CAGJ,sDACI,aAAA,CAGJ,wCACI,aAAA,CACA,QAAA,CACA,SAAA,CACA,WAAA,CACA,gCAAA,CACA,WAAA,CAGJ,iDACI,WAAA,CAGJ,yCACI,gBAAA,CAGJ,yCACI,gBAAA,CAGJ,yCACI,gBAAA,CAGJ,yCACI,gBAAA,CAGJ,kDACI,aAAA,CAGJ,kDACI,aAAA,CAGJ,kDACI,aAAA,CAGJ,kDACI,aAAA,CAGJ,wCACI,oBAAA,CACA,QAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,wBAAA,CACA,UAAA,CACA,iBAAA,CACA,iBAAA,CACA,6BAAA,CACA,4BAAA,CACA,8BAAA,CACA,+BAAA,CAGA,iBAAA,CACA,cAAA,CAEA,mFACI,UAAA,CAGJ,kFACI,aAAA,CAGJ,4CACI,iBAAA,CACA,iBAAA,CACA,QAAA,CACA,UAAA,CACA,iBAAA,CAGJ,6CACI,cAAA,CAIR,4CACI,wBAAA,CACA,6BAAA,CACA,4BAAA,CACA,2BAAA,CACA,4BAAA,CAKJ,gDACI,WAAA,CAGJ,iDACI,UAAA,CACA,gBAAA,CAGJ,+CACI,UAAA,CAGJ,+CACI,UAAA,CAGJ,4CACI,UAAA,CAGJ,8CACI,UAAA,CACA,WAAA,CACA,sBAAA,CACA,qBAAA,CACA,UAAA,CACA,iBAAA,CAEA,kDACI,WAAA,CAIR,6CACI,gBAAA,CACA,WAAA,CAGJ,sDACI,UAAA,CAGJ,wDACI,UAAA,CAGJ,uDACI,UAAA,CAGJ,sDACI,aAAA,CACA,WAAA,CAGJ,4CACI,UAAA,CACA,WAAA,CACA,sBAAA,CACA,qBAAA,CACA,UAAA,CACA,iBAAA,CAGJ,gDACI,WAAA,CAGJ,iDACI,eAAA,CACA,UAAA,CAGJ,uDACI,wDAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,QAAA,CAGJ,yDACI,wDAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,QAAA,CAGJ,wDACI,YAAA,CAGJ,0DACI,YAAA,CAGJ,iGACI,wDAAA,CAGJ,mGACI,wDAAA",sourcesContent:['.keyboard {\n    margin-left: 15px;\n    user-select: none;\n}\n\n:global(.apple2e) .keyboard {\n    margin-left: 0;\n}\n\n.row {\n    display: block;\n    margin: 0;\n    padding: 0;\n    height: 42px;\n    font-family: Helvetica, sans-serif;\n    width: 570px;\n}\n\n:global(.apple2e) .row {\n    width: 610px;\n}\n\n.row0 {\n    margin-left: 20px;\n}\n\n.row2 {\n    margin-left: 10px;\n}\n\n.row3 {\n    margin-left: 10px;\n}\n\n.row4 {\n    margin-left: 10px;\n}\n\n:global(.apple2e) .row0 {\n    margin-left: 0;\n}\n\n:global(.apple2e) .row2 {\n    margin-left: 0;\n}\n\n:global(.apple2e) .row3 {\n    margin-left: 0;\n}\n\n:global(.apple2e) .row4 {\n    margin-left: 0;\n}\n\n.key {\n    display: inline-block;\n    margin: 0;\n    padding: 0;\n    width: 32px;\n    height: 32px;\n    background-color: #44372c;\n    color: white;\n    text-align: center;\n    position: relative;\n    border-left: 5px solid #65594d;\n    border-top: 5px solid #65594d;\n    border-right: 5px solid #110e0d;\n    border-bottom: 5px solid #110e0d;\n\n    /* border: 5px outset #66594E; */\n    border-radius: 5px;\n    cursor: pointer;\n\n    .active {\n        color: #4f4;\n    }\n\n    .small {\n        font-size: 7px;\n    }\n\n    div {\n        border-radius: 3px;\n        position: absolute;\n        bottom: 0;\n        width: 100%;\n        text-align: center;\n    }\n\n    span {\n        font-size: 13px;\n    }\n}\n\n.pressed {\n    background-color: #22150a;\n    border-left: 5px solid #44372c;\n    border-top: 5px solid #44372c;\n    border-right: 5px solid #000;\n    border-bottom: 5px solid #000;\n\n    /* border: 5px outset #44372C; */\n}\n\n.vCenter div {\n    bottom: 10px;\n}\n\n.vCenter2 div {\n    bottom: 5px;\n    line-height: 10px;\n}\n\n.key-RETURN {\n    width: 52px;\n}\n\n.key-DELETE {\n    width: 47px;\n}\n\n.key-TAB {\n    width: 47px;\n}\n\n.key-POWER {\n    width: 38px;\n    height: 38px;\n    border: 2px groove black;\n    background-color: #ffd;\n    color: black;\n    border-radius: 2px;\n\n    div {\n        bottom: 15px;\n    }\n}\n\n.key-nbsp {\n    margin-left: 62px;\n    width: 330px;\n}\n\n:global(.apple2e) .key-CTRL {\n    width: 60px;\n}\n\n:global(.apple2e) .key-RETURN {\n    width: 60px;\n}\n\n:global(.apple2e) .key-SHIFT {\n    width: 81px;\n}\n\n:global(.apple2e) .key-nbsp {\n    margin-left: 0;\n    width: 215px;\n}\n\n.key-POW {\n    width: 38px;\n    height: 38px;\n    border: 2px groove black;\n    background-color: #ffd;\n    color: black;\n    border-radius: 2px;\n}\n\n.key-POW div {\n    bottom: 15px;\n}\n\n.key-POW span {\n    background: #4f4;\n    color: #4f4;\n}\n\n.key-OPEN_APPLE div {\n    background-image: url("../../../img/open-apple24.png");\n    width: 24px;\n    height: 24px;\n    bottom: 1px;\n    left: 4px;\n}\n\n.key-CLOSED_APPLE div {\n    background-image: url("../../../img/closed-apple24.png");\n    width: 24px;\n    height: 24px;\n    bottom: 1px;\n    left: 4px;\n}\n\n.key-OPEN_APPLE span {\n    display: none;\n}\n\n.key-CLOSED_APPLE span {\n    display: none;\n}\n\n.key-OPEN_APPLE.active div {\n    background-image: url("../../../img/open-apple24-green.png");\n}\n\n.key-CLOSED_APPLE.active div {\n    background-image: url("../../../img/closed-apple24-green.png");\n}\n'],sourceRoot:""}]),A.locals={keyboard:"js-components-css-Keyboard-module__keyboard",row:"js-components-css-Keyboard-module__row",row0:"js-components-css-Keyboard-module__row0",row2:"js-components-css-Keyboard-module__row2",row3:"js-components-css-Keyboard-module__row3",row4:"js-components-css-Keyboard-module__row4",key:"js-components-css-Keyboard-module__key",active:"js-components-css-Keyboard-module__active",small:"js-components-css-Keyboard-module__small",pressed:"js-components-css-Keyboard-module__pressed",vCenter:"js-components-css-Keyboard-module__vCenter",vCenter2:"js-components-css-Keyboard-module__vCenter2","key-RETURN":"js-components-css-Keyboard-module__key-RETURN","key-DELETE":"js-components-css-Keyboard-module__key-DELETE","key-TAB":"js-components-css-Keyboard-module__key-TAB","key-POWER":"js-components-css-Keyboard-module__key-POWER","key-nbsp":"js-components-css-Keyboard-module__key-nbsp","key-CTRL":"js-components-css-Keyboard-module__key-CTRL","key-SHIFT":"js-components-css-Keyboard-module__key-SHIFT","key-POW":"js-components-css-Keyboard-module__key-POW","key-OPEN_APPLE":"js-components-css-Keyboard-module__key-OPEN_APPLE","key-CLOSED_APPLE":"js-components-css-Keyboard-module__key-CLOSED_APPLE"};const _=A},3455:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Modal-module__modalOverlay{position:fixed;left:0;right:0;top:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:1}.js-components-css-Modal-module__modalOverlay button{min-width:36px;margin:0 2px}.js-components-css-Modal-module__modal{background-color:#c4c1a0;padding:10px;max-height:100vh;border-radius:4px;overflow-y:auto;box-sizing:border-box}.js-components-css-Modal-module__modalHeader{display:flex;font-size:14px;justify-content:space-between;align-items:center;background:#44372c;color:#fff;padding:5px 11px;border:1px outset #66594e;border-radius:3px;user-select:none}.js-components-css-Modal-module__modalHeader button{min-width:36px}.js-components-css-Modal-module__modalTitle{margin-top:0;margin-bottom:0;font-weight:600;font-size:1.25rem;line-height:1.25;color:#fff;box-sizing:border-box}.js-components-css-Modal-module__modalContent{margin-top:10px;margin-bottom:10px;line-height:1.5;color:#000}.js-components-css-Modal-module__modalFooter{text-align:right;user-select:none}.js-components-css-Modal-module__modalFooter a[role=button],.js-components-css-Modal-module__modalFooter button{margin:0 0 0 5px;min-width:75px}","",{version:3,sources:["webpack://./js/components/css/Modal.module.scss"],names:[],mappings:"AAAA,8CACI,cAAA,CACA,MAAA,CACA,OAAA,CACA,KAAA,CACA,QAAA,CACA,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,yBAAA,CACA,SAAA,CAEA,qDACI,cAAA,CACA,YAAA,CAIR,uCACI,wBAAA,CACA,YAAA,CACA,gBAAA,CACA,iBAAA,CACA,eAAA,CACA,qBAAA,CAGJ,6CACI,YAAA,CACA,cAAA,CACA,6BAAA,CACA,kBAAA,CACA,kBAAA,CACA,UAAA,CACA,gBAAA,CACA,yBAAA,CACA,iBAAA,CACA,gBAAA,CAEA,oDACI,cAAA,CAIR,4CACI,YAAA,CACA,eAAA,CACA,eAAA,CACA,iBAAA,CACA,gBAAA,CACA,UAAA,CACA,qBAAA,CAGJ,8CACI,eAAA,CACA,kBAAA,CACA,eAAA,CACA,UAAA,CAGJ,6CACI,gBAAA,CACA,gBAAA,CAEA,gHAEI,gBAAA,CACA,cAAA",sourcesContent:['.modalOverlay {\n    position: fixed;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: rgb(0 0 0 / 60%);\n    z-index: 1;\n\n    button {\n        min-width: 36px;\n        margin: 0 2px;\n    }\n}\n\n.modal {\n    background-color: #c4c1a0;\n    padding: 10px;\n    max-height: 100vh;\n    border-radius: 4px;\n    overflow-y: auto;\n    box-sizing: border-box;\n}\n\n.modalHeader {\n    display: flex;\n    font-size: 14px;\n    justify-content: space-between;\n    align-items: center;\n    background: #44372c;\n    color: #fff;\n    padding: 5px 11px;\n    border: 1px outset #66594e;\n    border-radius: 3px;\n    user-select: none;\n\n    button {\n        min-width: 36px;\n    }\n}\n\n.modalTitle {\n    margin-top: 0;\n    margin-bottom: 0;\n    font-weight: 600;\n    font-size: 1.25rem;\n    line-height: 1.25;\n    color: #fff;\n    box-sizing: border-box;\n}\n\n.modalContent {\n    margin-top: 10px;\n    margin-bottom: 10px;\n    line-height: 1.5;\n    color: #000;\n}\n\n.modalFooter {\n    text-align: right;\n    user-select: none;\n\n    a[role="button"],\n    button {\n        margin: 0 0 0 5px;\n        min-width: 75px;\n    }\n}\n'],sourceRoot:""}]),o.locals={modalOverlay:"js-components-css-Modal-module__modalOverlay",modal:"js-components-css-Modal-module__modal",modalHeader:"js-components-css-Modal-module__modalHeader",modalTitle:"js-components-css-Modal-module__modalTitle",modalContent:"js-components-css-Modal-module__modalContent",modalFooter:"js-components-css-Modal-module__modalFooter"};const a=o},8086:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-OptionsModal-module__optionsModal{width:300px}.js-components-css-OptionsModal-module__optionsModal h3{font-size:13px}.js-components-css-OptionsModal-module__optionsModal li{list-style-type:none}","",{version:3,sources:["webpack://./js/components/css/OptionsModal.module.scss"],names:[],mappings:"AAAA,qDACI,WAAA,CAGJ,wDACI,cAAA,CAGJ,wDACI,oBAAA",sourcesContent:[".optionsModal {\n    width: 300px;\n}\n\n.optionsModal h3 {\n    font-size: 13px;\n}\n\n.optionsModal li {\n    list-style-type: none;\n}\n"],sourceRoot:""}]),o.locals={optionsModal:"js-components-css-OptionsModal-module__optionsModal"};const a=o},7017:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Printer-module__printer{background:#fff;font:monospace;width:60em;padding:5em;height:60vh;overflow:auto;border:2px inset #f0edd0}","",{version:3,sources:["webpack://./js/components/css/Printer.module.scss"],names:[],mappings:"AAAA,2CACI,eAAA,CACA,cAAA,CACA,UAAA,CACA,WAAA,CACA,WAAA,CACA,aAAA,CACA,wBAAA",sourcesContent:[".printer {\n    background: white;\n    font: monospace;\n    width: 60em;\n    padding: 5em;\n    height: 60vh;\n    overflow: auto;\n    border: 2px inset #f0edd0;\n}\n"],sourceRoot:""}]),o.locals={printer:"js-components-css-Printer-module__printer"};const a=o},5879:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-ProgressModal-module__progressContainer{width:320px;height:20px;background:#000}.js-components-css-ProgressModal-module__progressBar{height:20px;background:lime}","",{version:3,sources:["webpack://./js/components/css/ProgressModal.module.scss"],names:[],mappings:"AAAA,2DACI,WAAA,CACA,WAAA,CACA,eAAA,CAGJ,qDACI,WAAA,CACA,eAAA",sourcesContent:[".progressContainer {\n    width: 320px;\n    height: 20px;\n    background: #000;\n}\n\n.progressBar {\n    height: 20px;\n    background: #0f0;\n}\n"],sourceRoot:""}]),o.locals={progressContainer:"js-components-css-ProgressModal-module__progressContainer",progressBar:"js-components-css-ProgressModal-module__progressBar"};const a=o},7489:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,'.mono{filter:url("#green")}.js-components-css-Screen-module__display{margin:5px auto 10px}.full-page .js-components-css-Screen-module__display{width:100vw;height:68.5714vw;max-height:100vh;max-width:145.83vh;padding:0;border:0;position:fixed;top:0;bottom:0;left:0;right:0;justify-content:center;align-items:center;margin:auto !important}.js-components-css-Screen-module__overscan{margin:auto;position:relative;background-color:#000;width:592px;height:416px;border:6px inset #f0edd0;border-radius:10px}.full-page .js-components-css-Screen-module__overscan{margin:initial;padding:0;width:initial;border:0;border-radius:0;height:100%;display:flex;justify-content:center;align-items:center}.scanlines::after{display:block;pointer-events:none;background-image:repeating-linear-gradient(to bottom, transparent 0, transparent 1px, rgba(0, 0, 0, 0.5) 1px, rgba(0, 0, 0, 0.5) 2px);content:"";position:absolute;top:0;left:0;bottom:0;right:0}.full-page .scanlines::after{background-image:repeating-linear-gradient(to bottom, transparent 0, transparent 0.25vh, rgba(0, 0, 0, 0.5) 0.25vh, rgba(0, 0, 0, 0.5) 0.5vh)}.js-components-css-Screen-module__screen{cursor:crosshair;image-rendering:crisp-edges;width:592px;height:416px;touch-action:manipulation;user-select:none}.js-components-css-Screen-module__screen.mouseMode{cursor:none}.full-page .js-components-css-Screen-module__screen{width:100%;height:100%}',"",{version:3,sources:["webpack://./js/components/css/Screen.module.scss"],names:[],mappings:"AAAA,MACI,oBAAA,CAGJ,0CACI,oBAAA,CAGJ,qDACI,WAAA,CACA,gBAAA,CACA,gBAAA,CACA,kBAAA,CACA,SAAA,CACA,QAAA,CACA,cAAA,CACA,KAAA,CACA,QAAA,CACA,MAAA,CACA,OAAA,CACA,sBAAA,CACA,kBAAA,CACA,sBAAA,CAGJ,2CACI,WAAA,CACA,iBAAA,CACA,qBAAA,CACA,WAAA,CACA,YAAA,CACA,wBAAA,CACA,kBAAA,CAGJ,sDACI,cAAA,CACA,SAAA,CACA,aAAA,CACA,QAAA,CACA,eAAA,CACA,WAAA,CACA,YAAA,CACA,sBAAA,CACA,kBAAA,CAGJ,kBACI,aAAA,CACA,mBAAA,CACA,qIACI,CAOJ,UAAA,CACA,iBAAA,CACA,KAAA,CACA,MAAA,CACA,QAAA,CACA,OAAA,CAGJ,6BACI,6IACI,CASR,yCACI,gBAAA,CACA,2BAAA,CACA,WAAA,CACA,YAAA,CACA,yBAAA,CACA,gBAAA,CAGJ,mDACI,WAAA,CAGJ,oDACI,UAAA,CACA,WAAA",sourcesContent:[':global(.mono) {\n    filter: url("#green");\n}\n\n.display {\n    margin: 5px auto 10px;\n}\n\n:global(.full-page) .display {\n    width: 100vw;\n    height: 68.5714vw; /* 384px / 560px * 100% */\n    max-height: 100vh;\n    max-width: 145.83vh; /* 560px / 384px * 100% */\n    padding: 0;\n    border: 0;\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    justify-content: center;\n    align-items: center;\n    margin: auto !important;\n}\n\n.overscan {\n    margin: auto;\n    position: relative;\n    background-color: black;\n    width: 592px;\n    height: 416px;\n    border: 6px inset #f0edd0;\n    border-radius: 10px;\n}\n\n:global(.full-page) .overscan {\n    margin: initial;\n    padding: 0;\n    width: initial;\n    border: 0;\n    border-radius: 0;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n:global(.scanlines)::after {\n    display: block;\n    pointer-events: none;\n    background-image:\n        repeating-linear-gradient(\n            to bottom,\n            transparent 0,\n            transparent 1px,\n            rgb(0 0 0 / 50%) 1px,\n            rgb(0 0 0 / 50%) 2px\n        );\n    content: "";\n    position: absolute;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n}\n\n:global(.full-page) :global(.scanlines)::after {\n    background-image:\n        repeating-linear-gradient(\n            to bottom,\n            transparent 0,\n            transparent 0.25vh,\n            rgb(0 0 0 / 50%) 0.25vh,\n            rgb(0 0 0 / 50%) 0.5vh\n        );\n}\n\n.screen {\n    cursor: crosshair;\n    image-rendering: crisp-edges;\n    width: 592px;\n    height: 416px;\n    touch-action: manipulation;\n    user-select: none;\n}\n\n.screen:global(.mouseMode) {\n    cursor: none;\n}\n\n:global(.full-page) .screen {\n    width: 100%;\n    height: 100%;\n}\n'],sourceRoot:""}]),o.locals={display:"js-components-css-Screen-module__display",overscan:"js-components-css-Screen-module__overscan",screen:"js-components-css-Screen-module__screen"};const a=o},101:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-css-Tabs-module__tab{border-top:2px groove;border-left:2px groove;border-right:2px groove;margin:0 2px;font-weight:bold;padding:4px;border-radius:4px 4px 0 0}.js-components-css-Tabs-module__tab .js-components-css-Tabs-module__selected{background-color:#c4c1a0;border-bottom:none;margin-bottom:-2px;color:#080}.js-components-css-Tabs-module__tabs{display:flex;flex-direction:row;border-bottom:2px groove;margin-bottom:6px;user-select:none}","",{version:3,sources:["webpack://./js/components/css/Tabs.module.scss"],names:[],mappings:"AAAA,oCACI,qBAAA,CACA,sBAAA,CACA,uBAAA,CACA,YAAA,CACA,gBAAA,CACA,WAAA,CACA,yBAAA,CAEA,6EACI,wBAAA,CACA,kBAAA,CACA,kBAAA,CACA,UAAA,CAIR,qCACI,YAAA,CACA,kBAAA,CACA,wBAAA,CACA,iBAAA,CACA,gBAAA",sourcesContent:[".tab {\n    border-top: 2px groove;\n    border-left: 2px groove;\n    border-right: 2px groove;\n    margin: 0 2px;\n    font-weight: bold;\n    padding: 4px;\n    border-radius: 4px 4px 0 0;\n\n    .selected {\n        background-color: #c4c1a0;\n        border-bottom: none;\n        margin-bottom: -2px;\n        color: #080;\n    }\n}\n\n.tabs {\n    display: flex;\n    flex-direction: row;\n    border-bottom: 2px groove;\n    margin-bottom: 6px;\n    user-select: none;\n}\n"],sourceRoot:""}]),o.locals={tab:"js-components-css-Tabs-module__tab",selected:"js-components-css-Tabs-module__selected",tabs:"js-components-css-Tabs-module__tabs"};const a=o},7458:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-Applesoft-module__listing{width:calc(100% - 12px);height:320px;overflow:auto;white-space:pre-wrap}.js-components-debugger-css-Applesoft-module__variables{width:100%;height:320px;overflow:auto}.js-components-debugger-css-Applesoft-module__variables table{width:100%}.js-components-debugger-css-Applesoft-module__variables td{background-color:#fff;border:1px inset;white-space:pre;font-family:monospace}.js-components-debugger-css-Applesoft-module__internals{width:100%}.js-components-debugger-css-Applesoft-module__internals table{width:100%}.js-components-debugger-css-Applesoft-module__internals td{background-color:#fff;border:1px inset;white-space:pre;font-family:monospace;width:30%}.js-components-debugger-css-Applesoft-module__internals th{width:20%;text-align:right}.js-components-debugger-css-Applesoft-module__stack{width:10em}","",{version:3,sources:["webpack://./js/components/debugger/css/Applesoft.module.scss"],names:[],mappings:"AAAA,sDACI,uBAAA,CACA,YAAA,CACA,aAAA,CACA,oBAAA,CAGJ,wDACI,UAAA,CACA,YAAA,CACA,aAAA,CAEA,8DACI,UAAA,CAGJ,2DACI,qBAAA,CACA,gBAAA,CACA,eAAA,CACA,qBAAA,CAIR,wDACI,UAAA,CAEA,8DACI,UAAA,CAGJ,2DACI,qBAAA,CACA,gBAAA,CACA,eAAA,CACA,qBAAA,CACA,SAAA,CAGJ,2DACI,SAAA,CACA,gBAAA,CAIR,oDACI,UAAA",sourcesContent:[".listing {\n    width: calc(100% - 12px);\n    height: 320px;\n    overflow: auto;\n    white-space: pre-wrap;\n}\n\n.variables {\n    width: 100%;\n    height: 320px;\n    overflow: auto;\n\n    table {\n        width: 100%;\n    }\n\n    td {\n        background-color: #fff;\n        border: 1px inset;\n        white-space: pre;\n        font-family: monospace;\n    }\n}\n\n.internals {\n    width: 100%;\n\n    table {\n        width: 100%;\n    }\n\n    td {\n        background-color: #fff;\n        border: 1px inset;\n        white-space: pre;\n        font-family: monospace;\n        width: 30%;\n    }\n\n    th {\n        width: 20%;\n        text-align: right;\n    }\n}\n\n.stack {\n    width: 10em;\n}\n"],sourceRoot:""}]),o.locals={listing:"js-components-debugger-css-Applesoft-module__listing",variables:"js-components-debugger-css-Applesoft-module__variables",internals:"js-components-debugger-css-Applesoft-module__internals",stack:"js-components-debugger-css-Applesoft-module__stack"};const a=o},1971:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-CPU-module__controls{padding:3px 0;margin:2px 0}.js-components-debugger-css-CPU-module__zeroPage{width:53em}.js-components-debugger-css-CPU-module__trace{width:53em}.js-components-debugger-css-CPU-module__stack{width:10em}.js-components-debugger-css-CPU-module__fileChooser{padding:5px 0}.js-components-debugger-css-CPU-module__invalid{color:red}.js-components-debugger-css-CPU-module__errorIcon{position:relative;display:inline-block}.js-components-debugger-css-CPU-module__errorIcon i{position:absolute;top:-9px;left:-16px}","",{version:3,sources:["webpack://./js/components/debugger/css/CPU.module.scss"],names:[],mappings:"AAAA,iDACI,aAAA,CACA,YAAA,CAGJ,iDACI,UAAA,CAGJ,8CACI,UAAA,CAGJ,8CACI,UAAA,CAGJ,oDACI,aAAA,CAGJ,gDACI,SAAA,CAGJ,kDACI,iBAAA,CACA,oBAAA,CAEA,oDACI,iBAAA,CACA,QAAA,CACA,UAAA",sourcesContent:[".controls {\n    padding: 3px 0;\n    margin: 2px 0;\n}\n\n.zeroPage {\n    width: 53em;\n}\n\n.trace {\n    width: 53em;\n}\n\n.stack {\n    width: 10em;\n}\n\n.fileChooser {\n    padding: 5px 0;\n}\n\n.invalid {\n    color: #f00;\n}\n\n.errorIcon {\n    position: relative;\n    display: inline-block;\n\n    i {\n        position: absolute;\n        top: -9px;\n        left: -16px;\n    }\n}\n"],sourceRoot:""}]),o.locals={controls:"js-components-debugger-css-CPU-module__controls",zeroPage:"js-components-debugger-css-CPU-module__zeroPage",trace:"js-components-debugger-css-CPU-module__trace",stack:"js-components-debugger-css-CPU-module__stack",fileChooser:"js-components-debugger-css-CPU-module__fileChooser",invalid:"js-components-debugger-css-CPU-module__invalid",errorIcon:"js-components-debugger-css-CPU-module__errorIcon"};const a=o},2391:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-Debugger-module__inset{margin:5px 10px 0;display:flex;flex-direction:column;width:auto}.js-components-debugger-css-Debugger-module__heading{font-weight:bold;font-size:18px;margin:5px 0}.js-components-debugger-css-Debugger-module__subHeading{font-weight:bold;font-size:12px}.js-components-debugger-css-Debugger-module__row{display:flex;flex-direction:row}.js-components-debugger-css-Debugger-module__column{display:flex;flex-direction:column}.js-components-debugger-css-Debugger-module__debugger{font-size:12px;width:590px}.js-components-debugger-css-Debugger-module__debugger pre{font-size:9px;background:#fff;color:#000;padding:3px;margin:2px;border:1px inset}.js-components-debugger-css-Debugger-module__debugger button,.js-components-debugger-css-Debugger-module__debugger input{font-size:12px}.js-components-debugger-css-Debugger-module__debugger input[type=text]{border:1px inset}.js-components-debugger-css-Debugger-module__debugger hr{color:#c4c1a0}","",{version:3,sources:["webpack://./js/components/debugger/css/Debugger.module.scss"],names:[],mappings:"AAAA,mDACI,iBAAA,CACA,YAAA,CACA,qBAAA,CACA,UAAA,CAGJ,qDACI,gBAAA,CACA,cAAA,CACA,YAAA,CAGJ,wDACI,gBAAA,CACA,cAAA,CAGJ,iDACI,YAAA,CACA,kBAAA,CAGJ,oDACI,YAAA,CACA,qBAAA,CAGJ,sDACI,cAAA,CACA,WAAA,CAGJ,0DACI,aAAA,CACA,eAAA,CACA,UAAA,CACA,WAAA,CACA,UAAA,CACA,gBAAA,CAGJ,yHAEI,cAAA,CAGJ,uEACI,gBAAA,CAGJ,yDACI,aAAA",sourcesContent:['.inset {\n    margin: 5px 10px 0;\n    display: flex;\n    flex-direction: column;\n    width: auto;\n}\n\n.heading {\n    font-weight: bold;\n    font-size: 18px;\n    margin: 5px 0;\n}\n\n.subHeading {\n    font-weight: bold;\n    font-size: 12px;\n}\n\n.row {\n    display: flex;\n    flex-direction: row;\n}\n\n.column {\n    display: flex;\n    flex-direction: column;\n}\n\n.debugger {\n    font-size: 12px;\n    width: 590px;\n}\n\n.debugger pre {\n    font-size: 9px;\n    background: white;\n    color: black;\n    padding: 3px;\n    margin: 2px;\n    border: 1px inset;\n}\n\n.debugger button,\n.debugger input {\n    font-size: 12px;\n}\n\n.debugger input[type="text"] {\n    border: 1px inset;\n}\n\n.debugger hr {\n    color: #c4c1a0;\n}\n'],sourceRoot:""}]),o.locals={inset:"js-components-debugger-css-Debugger-module__inset",heading:"js-components-debugger-css-Debugger-module__heading",subHeading:"js-components-debugger-css-Debugger-module__subHeading",row:"js-components-debugger-css-Debugger-module__row",column:"js-components-debugger-css-Debugger-module__column",debugger:"js-components-debugger-css-Debugger-module__debugger"};const a=o},3313:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-Disks-module__volume{font-family:monospace;width:100%;border:1px inset;background-color:#fff;overflow-y:auto;height:320px}.js-components-debugger-css-Disks-module__volume table{border-spacing:0;width:100%}.js-components-debugger-css-Disks-module__volume tfoot td{border-top:1px solid #000}.js-components-debugger-css-Disks-module__volume thead th{border-bottom:1px solid #000;padding:2px}.js-components-debugger-css-Disks-module__volume tbody{line-height:.8em}.js-components-debugger-css-Disks-module__filename{width:16em;max-width:16em;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.js-components-debugger-css-Disks-module__deleted{text-decoration:line-through}.js-components-debugger-css-Disks-module__type{width:2em}.js-components-debugger-css-Disks-module__sectors{width:2em}.js-components-debugger-css-Disks-module__aux{width:3em}","",{version:3,sources:["webpack://./js/components/debugger/css/Disks.module.scss"],names:[],mappings:"AAAA,iDACI,qBAAA,CACA,UAAA,CACA,gBAAA,CACA,qBAAA,CACA,eAAA,CACA,YAAA,CAGJ,uDACI,gBAAA,CACA,UAAA,CAGJ,0DACI,yBAAA,CAGJ,0DACI,4BAAA,CACA,WAAA,CAGJ,uDACI,gBAAA,CAGJ,mDACI,UAAA,CACA,cAAA,CACA,sBAAA,CACA,eAAA,CACA,kBAAA,CAGJ,kDACI,4BAAA,CAGJ,+CACI,SAAA,CAGJ,kDACI,SAAA,CAGJ,8CACI,SAAA",sourcesContent:[".volume {\n    font-family: monospace;\n    width: 100%;\n    border: 1px inset;\n    background-color: white;\n    overflow-y: auto;\n    height: 320px;\n}\n\n.volume table {\n    border-spacing: 0;\n    width: 100%;\n}\n\n.volume tfoot td {\n    border-top: 1px solid black;\n}\n\n.volume thead th {\n    border-bottom: 1px solid black;\n    padding: 2px;\n}\n\n.volume tbody {\n    line-height: 0.8em;\n}\n\n.filename {\n    width: 16em;\n    max-width: 16em;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n}\n\n.deleted {\n    text-decoration: line-through;\n}\n\n.type {\n    width: 2em;\n}\n\n.sectors {\n    width: 2em;\n}\n\n.aux {\n    width: 3em;\n}\n"],sourceRoot:""}]),o.locals={volume:"js-components-debugger-css-Disks-module__volume",filename:"js-components-debugger-css-Disks-module__filename",deleted:"js-components-debugger-css-Disks-module__deleted",type:"js-components-debugger-css-Disks-module__type",sectors:"js-components-debugger-css-Disks-module__sectors",aux:"js-components-debugger-css-Disks-module__aux"};const a=o},6500:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-FileViewer-module__fileViewer{width:60em;max-height:60vh;overflow-y:auto;display:flex;flex-direction:column;align-items:center}.js-components-debugger-css-FileViewer-module__textViewer{background:#fff;font-family:monospace;width:57em;padding:1em;height:60vh;line-height:1em;overflow-y:auto;border:2px inset #f0edd0;white-space:pre-wrap}.js-components-debugger-css-FileViewer-module__hiresPreview{border:2px inset #f0edd0;width:560px;height:384px;min-width:560px;min-height:384px}","",{version:3,sources:["webpack://./js/components/debugger/css/FileViewer.module.scss"],names:[],mappings:"AAAA,0DACI,UAAA,CACA,eAAA,CACA,eAAA,CACA,YAAA,CACA,qBAAA,CACA,kBAAA,CAGJ,0DACI,eAAA,CACA,qBAAA,CACA,UAAA,CACA,WAAA,CACA,WAAA,CACA,eAAA,CACA,eAAA,CACA,wBAAA,CACA,oBAAA,CAGJ,4DACI,wBAAA,CACA,WAAA,CACA,YAAA,CACA,eAAA,CACA,gBAAA",sourcesContent:[".fileViewer {\n    width: 60em;\n    max-height: 60vh;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.textViewer {\n    background: white;\n    font-family: monospace;\n    width: 57em;\n    padding: 1em;\n    height: 60vh;\n    line-height: 1em;\n    overflow-y: auto;\n    border: 2px inset #f0edd0;\n    white-space: pre-wrap;\n}\n\n.hiresPreview {\n    border: 2px inset #f0edd0;\n    width: 560px;\n    height: 384px;\n    min-width: 560px;\n    min-height: 384px;\n}\n"],sourceRoot:""}]),o.locals={fileViewer:"js-components-debugger-css-FileViewer-module__fileViewer",textViewer:"js-components-debugger-css-FileViewer-module__textViewer",hiresPreview:"js-components-debugger-css-FileViewer-module__hiresPreview"};const a=o},9154:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-Memory-module__memory{width:auto;box-sizing:border-box}.js-components-debugger-css-Memory-module__bank{width:128px;border-right:1px solid #000}.js-components-debugger-css-Memory-module__bank,.js-components-debugger-css-Memory-module__bank div,.js-components-debugger-css-Memory-module__io,.js-components-debugger-css-Memory-module__rom,.js-components-debugger-css-Memory-module__intcxrom{text-align:center;justify-content:center}.js-components-debugger-css-Memory-module__upperMemory{height:96px;width:385px;border-bottom:1px solid #000;border-left:1px solid #000;border-top:1px solid #000}.js-components-debugger-css-Memory-module__upperMemory .js-components-debugger-css-Memory-module__bank{height:96px}.js-components-debugger-css-Memory-module__rom{display:flex;align-items:center;height:96px;width:128px}.js-components-debugger-css-Memory-module__intcxrom{display:flex;align-items:center;height:32px;width:128px;border-right:1px solid #000;border-bottom:1px solid #000}.js-components-debugger-css-Memory-module__languageCard{width:256px;height:96px;border:1px solid #000}.js-components-debugger-css-Memory-module__lc{display:flex;align-items:center;position:relative;width:127px;height:63px}.js-components-debugger-css-Memory-module__lcbanks{width:127px;display:flex;flex-direction:row}.js-components-debugger-css-Memory-module__lcbank{display:flex;align-items:center;width:64px;height:31px;border-top:1px solid #000}.js-components-debugger-css-Memory-module__lcbank0{border-right:1px solid #000}.js-components-debugger-css-Memory-module__io{display:flex;align-items:center;width:255px;height:32px;border-left:1px solid #000;border-right:1px solid #000;border-bottom:1px solid #000}.js-components-debugger-css-Memory-module__hires{display:flex;align-items:center;height:64px;width:127px;position:absolute;bottom:64px;border-top:1px solid #000;border-bottom:1px solid #000}.js-components-debugger-css-Memory-module__text{display:flex;align-items:center;height:16px;width:127px;position:absolute;bottom:24px;border-top:1px solid #000;border-bottom:1px solid #000}.js-components-debugger-css-Memory-module__zp{display:flex;align-items:center;height:16px;width:127px;position:absolute;bottom:0;border-top:1px solid #000}.js-components-debugger-css-Memory-module__lowerMemory{border-left:1px solid #000;border-bottom:1px solid #000;width:256px}.js-components-debugger-css-Memory-module__lowerMemory .js-components-debugger-css-Memory-module__bank{height:256px;position:relative}.js-components-debugger-css-Memory-module__read{background-color:#8f8}.js-components-debugger-css-Memory-module__write{background-color:#f88}.js-components-debugger-css-Memory-module__read.js-components-debugger-css-Memory-module__write{background-color:#88f}.js-components-debugger-css-Memory-module__inactive{background-color:#bbb}.js-components-debugger-css-Memory-module__legend{width:1em;height:1em;display:inline-block;border:1px solid #000}","",{version:3,sources:["webpack://./js/components/debugger/css/Memory.module.scss"],names:[],mappings:"AAAA,kDACI,UAAA,CACA,qBAAA,CAGJ,gDACI,WAAA,CACA,2BAAA,CAGJ,qPAKI,iBAAA,CACA,sBAAA,CAGJ,uDACI,WAAA,CACA,WAAA,CACA,4BAAA,CACA,0BAAA,CACA,yBAAA,CAGJ,uGACI,WAAA,CAGJ,+CACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CAGJ,oDACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CACA,2BAAA,CACA,4BAAA,CAGJ,wDACI,WAAA,CACA,WAAA,CACA,qBAAA,CAGJ,8CACI,YAAA,CACA,kBAAA,CACA,iBAAA,CACA,WAAA,CACA,WAAA,CAGJ,mDACI,WAAA,CACA,YAAA,CACA,kBAAA,CAGJ,kDACI,YAAA,CACA,kBAAA,CACA,UAAA,CACA,WAAA,CACA,yBAAA,CAGJ,mDACI,2BAAA,CAGJ,8CACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CACA,0BAAA,CACA,2BAAA,CACA,4BAAA,CAGJ,iDACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CACA,iBAAA,CACA,WAAA,CACA,yBAAA,CACA,4BAAA,CAGJ,gDACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CACA,iBAAA,CACA,WAAA,CACA,yBAAA,CACA,4BAAA,CAGJ,8CACI,YAAA,CACA,kBAAA,CACA,WAAA,CACA,WAAA,CACA,iBAAA,CACA,QAAA,CACA,yBAAA,CAGJ,uDACI,0BAAA,CACA,4BAAA,CACA,WAAA,CAGJ,uGACI,YAAA,CACA,iBAAA,CAGJ,gDACI,qBAAA,CAGJ,iDACI,qBAAA,CAGJ,gGACI,qBAAA,CAGJ,oDACI,qBAAA,CAGJ,kDACI,SAAA,CACA,UAAA,CACA,oBAAA,CACA,qBAAA",sourcesContent:[".memory {\n    width: auto;\n    box-sizing: border-box;\n}\n\n.bank {\n    width: 128px;\n    border-right: 1px solid #000;\n}\n\n.bank,\n.bank div,\n.io,\n.rom,\n.intcxrom {\n    text-align: center;\n    justify-content: center;\n}\n\n.upperMemory {\n    height: 96px;\n    width: 385px;\n    border-bottom: 1px solid #000;\n    border-left: 1px solid #000;\n    border-top: 1px solid #000;\n}\n\n.upperMemory .bank {\n    height: 96px;\n}\n\n.rom {\n    display: flex;\n    align-items: center;\n    height: 96px;\n    width: 128px;\n}\n\n.intcxrom {\n    display: flex;\n    align-items: center;\n    height: 32px;\n    width: 128px;\n    border-right: 1px solid #000;\n    border-bottom: 1px solid #000;\n}\n\n.languageCard {\n    width: 256px;\n    height: 96px;\n    border: 1px solid #000;\n}\n\n.lc {\n    display: flex;\n    align-items: center;\n    position: relative;\n    width: 127px;\n    height: 63px;\n}\n\n.lcbanks {\n    width: 127px;\n    display: flex;\n    flex-direction: row;\n}\n\n.lcbank {\n    display: flex;\n    align-items: center;\n    width: 64px;\n    height: 31px;\n    border-top: 1px solid #000;\n}\n\n.lcbank0 {\n    border-right: 1px solid #000;\n}\n\n.io {\n    display: flex;\n    align-items: center;\n    width: 255px;\n    height: 32px;\n    border-left: 1px solid #000;\n    border-right: 1px solid #000;\n    border-bottom: 1px solid #000;\n}\n\n.hires {\n    display: flex;\n    align-items: center;\n    height: 64px;\n    width: 127px;\n    position: absolute;\n    bottom: 64px;\n    border-top: 1px solid #000;\n    border-bottom: 1px solid #000;\n}\n\n.text {\n    display: flex;\n    align-items: center;\n    height: 16px;\n    width: 127px;\n    position: absolute;\n    bottom: 24px;\n    border-top: 1px solid #000;\n    border-bottom: 1px solid #000;\n}\n\n.zp {\n    display: flex;\n    align-items: center;\n    height: 16px;\n    width: 127px;\n    position: absolute;\n    bottom: 0;\n    border-top: 1px solid #000;\n}\n\n.lowerMemory {\n    border-left: 1px solid #000;\n    border-bottom: 1px solid #000;\n    width: 256px;\n}\n\n.lowerMemory .bank {\n    height: 256px;\n    position: relative;\n}\n\n.read {\n    background-color: #8f8;\n}\n\n.write {\n    background-color: #f88;\n}\n\n.read.write {\n    background-color: #88f;\n}\n\n.inactive {\n    background-color: #bbb;\n}\n\n.legend {\n    width: 1em;\n    height: 1em;\n    display: inline-block;\n    border: 1px solid #000;\n}\n"],sourceRoot:""}]),o.locals={memory:"js-components-debugger-css-Memory-module__memory",bank:"js-components-debugger-css-Memory-module__bank",io:"js-components-debugger-css-Memory-module__io",rom:"js-components-debugger-css-Memory-module__rom",intcxrom:"js-components-debugger-css-Memory-module__intcxrom",upperMemory:"js-components-debugger-css-Memory-module__upperMemory",languageCard:"js-components-debugger-css-Memory-module__languageCard",lc:"js-components-debugger-css-Memory-module__lc",lcbanks:"js-components-debugger-css-Memory-module__lcbanks",lcbank:"js-components-debugger-css-Memory-module__lcbank",lcbank0:"js-components-debugger-css-Memory-module__lcbank0",hires:"js-components-debugger-css-Memory-module__hires",text:"js-components-debugger-css-Memory-module__text",zp:"js-components-debugger-css-Memory-module__zp",lowerMemory:"js-components-debugger-css-Memory-module__lowerMemory",read:"js-components-debugger-css-Memory-module__read",write:"js-components-debugger-css-Memory-module__write",inactive:"js-components-debugger-css-Memory-module__inactive",legend:"js-components-debugger-css-Memory-module__legend"};const a=o},6368:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});var i=s(7537),n=s.n(i),r=s(3645),o=s.n(r)()(n());o.push([e.id,".js-components-debugger-css-VideoModes-module__pages canvas{border:1px inset;width:280px;height:192px;margin:5px}.js-components-debugger-css-VideoModes-module__active canvas{border:1px inset blue}","",{version:3,sources:["webpack://./js/components/debugger/css/VideoModes.module.scss"],names:[],mappings:"AAAA,4DACI,gBAAA,CACA,WAAA,CACA,YAAA,CACA,UAAA,CAGJ,6DACI,qBAAA",sourcesContent:[".pages canvas {\n    border: 1px inset;\n    width: 280px;\n    height: 192px;\n    margin: 5px;\n}\n\n.active canvas {\n    border: 1px inset #00f;\n}\n"],sourceRoot:""}]),o.locals={pages:"js-components-debugger-css-VideoModes-module__pages",active:"js-components-debugger-css-VideoModes-module__active"};const a=o},3645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var s="",i=void 0!==t[5];return t[4]&&(s+="@supports (".concat(t[4],") {")),t[2]&&(s+="@media ".concat(t[2]," {")),i&&(s+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),s+=e(t),i&&(s+="}"),t[2]&&(s+="}"),t[4]&&(s+="}"),s})).join("")},t.i=function(e,s,i,n,r){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(i)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(o[l]=!0)}for(var h=0;h<e.length;h++){var c=[].concat(e[h]);i&&o[c[0]]||(void 0!==r&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=r),s&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=s):c[2]=s),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},1667:e=>{"use strict";e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]|(%20)/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e):e}},7537:e=>{"use strict";e.exports=function(e){var t=e[1],s=e[3];if(!s)return t;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),r="/*# ".concat(n," */"),o=s.sources.map((function(e){return"/*# sourceURL=".concat(s.sourceRoot||"").concat(e," */")}));return[t].concat(o).concat([r]).join("\n")}return[t].join("\n")}},3379:e=>{"use strict";var t=[];function s(e){for(var s=-1,i=0;i<t.length;i++)if(t[i].identifier===e){s=i;break}return s}function i(e,i){for(var r={},o=[],a=0;a<e.length;a++){var l=e[a],h=i.base?l[0]+i.base:l[0],c=r[h]||0,d="".concat(h," ").concat(c);r[h]=c+1;var u=s(d),A={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==u)t[u].references++,t[u].updater(A);else{var m=n(A,i);i.byIndex=a,t.splice(a,0,{identifier:d,updater:m,references:1})}o.push(d)}return o}function n(e,t){var s=t.domAPI(t);return s.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;s.update(e=t)}else s.remove()}}e.exports=function(e,n){var r=i(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<r.length;o++){var a=s(r[o]);t[a].references--}for(var l=i(e,n),h=0;h<r.length;h++){var c=s(r[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}r=l}}},569:e=>{"use strict";var t={};e.exports=function(e,s){var i=function(e){if(void 0===t[e]){var s=document.querySelector(e);if(window.HTMLIFrameElement&&s instanceof window.HTMLIFrameElement)try{s=s.contentDocument.head}catch(e){s=null}t[e]=s}return t[e]}(e);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(s)}},9216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},3565:(e,t,s)=>{"use strict";e.exports=function(e){var t=s.nc;t&&e.setAttribute("nonce",t)}},7795:e=>{"use strict";e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(s){!function(e,t,s){var i="";s.supports&&(i+="@supports (".concat(s.supports,") {")),s.media&&(i+="@media ".concat(s.media," {"));var n=void 0!==s.layer;n&&(i+="@layer".concat(s.layer.length>0?" ".concat(s.layer):""," {")),i+=s.css,n&&(i+="}"),s.media&&(i+="}"),s.supports&&(i+="}");var r=s.sourceMap;r&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(i,e,t.options)}(t,e,s)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},4589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},8933:(e,t,s)=>{"use strict";e.exports=s.p+"e0daf8083d2ee45acc1e.png"},5521:(e,t,s)=>{"use strict";e.exports=s.p+"31fd4ed49aa4f9c0624b.png"},1345:(e,t,s)=>{"use strict";e.exports=s.p+"72377ae7e10d9e185357.png"},3145:(e,t,s)=>{"use strict";e.exports=s.p+"55364cb8712d2fa5e3cf.png"},7442:(e,t,s)=>{"use strict";e.exports=s.p+"8f21661bb0a045376e2f.png"},6731:(e,t,s)=>{"use strict";e.exports=s.p+"10102029d1ca771c1074.png"},4122:(e,t,s)=>{"use strict";e.exports=s.p+"ede97467fe3cd1a9dab1.png"},3314:(e,t,s)=>{"use strict";e.exports=s.p+"e7e6d1165dda248afc23.png"},8452:(e,t,s)=>{"use strict";e.exports=s.p+"47a546648f092ee1be01.png"},5149:(e,t,s)=>{"use strict";e.exports=s.p+"58fd00281f9b95d49122.png"},3199:(e,t,s)=>{"use strict";e.exports=s.p+"b5c951b15b1a06012134.png"},869:(e,t,s)=>{"use strict";e.exports=s.p+"e72ca06770752d4a0843.png"}},i={};function n(e){var t=i[e];if(void 0!==t)return t.exports;var r=i[e]={id:e,exports:{}};return s[e](r,r.exports,n),r.exports}n.m=s,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,s)=>(n.f[s](e,t),t)),[])),n.u=e=>e+".bundle.js",n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="Apple2:",n.l=(s,i,r,o)=>{if(e[s])e[s].push(i);else{var a,l;if(void 0!==r)for(var h=document.getElementsByTagName("script"),c=0;c<h.length;c++){var d=h[c];if(d.getAttribute("src")==s||d.getAttribute("data-webpack")==t+r){a=d;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+r),a.src=s),e[s]=[i];var u=(t,i)=>{a.onerror=a.onload=null,clearTimeout(A);var n=e[s];if(delete e[s],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach((e=>e(i))),t)return t(i)},A=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),l&&document.head.appendChild(a)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="dist/",(()=>{n.b=document.baseURI||self.location.href;var e={168:0};n.f.j=(t,s)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)s.push(i[2]);else{var r=new Promise(((s,n)=>i=e[t]=[s,n]));s.push(i[2]=r);var o=n.p+n.u(t),a=new Error;n.l(o,(s=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var r=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,s)=>{var i,r,[o,a,l]=s,h=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);l&&l(n)}for(t&&t(s);h<o.length;h++)r=o[h],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0},s=self.webpackChunkApple2=self.webpackChunkApple2||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),n.nc=void 0;var r={};return(()=>{"use strict";var e,t,s,i,r,o,a,l={},h=[],c=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function d(e,t){for(var s in t)e[s]=t[s];return e}function u(e){var t=e.parentNode;t&&t.removeChild(e)}function A(t,s,i){var n,r,o,a={};for(o in s)"key"==o?n=s[o]:"ref"==o?r=s[o]:a[o]=s[o];if(arguments.length>2&&(a.children=arguments.length>3?e.call(arguments,2):i),"function"==typeof t&&null!=t.defaultProps)for(o in t.defaultProps)void 0===a[o]&&(a[o]=t.defaultProps[o]);return m(t,a,n,r,null)}function m(e,i,n,r,o){var a={type:e,props:i,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++s:o};return null==o&&null!=t.vnode&&t.vnode(a),a}function p(e){return e.children}function g(e,t){this.props=e,this.context=t}function f(e,t){if(null==t)return e.__?f(e.__,e.__.__k.indexOf(e)+1):null;for(var s;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e)return s.__e;return"function"==typeof e.type?f(e):null}function _(e){var t,s;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(s=e.__k[t])&&null!=s.__e){e.__e=e.__c.base=s.__e;break}return _(e)}}function b(e){(!e.__d&&(e.__d=!0)&&i.push(e)&&!C.__r++||o!==t.debounceRendering)&&((o=t.debounceRendering)||r)(C)}function C(){for(var e;C.__r=i.length;)e=i.sort((function(e,t){return e.__v.__b-t.__v.__b})),i=[],e.some((function(e){var t,s,i,n,r,o;e.__d&&(r=(n=(t=e).__v).__e,(o=t.__P)&&(s=[],(i=d({},n)).__v=n.__v+1,R(o,n,i,t.__n,void 0!==o.ownerSVGElement,null!=n.__h?[r]:null,s,null==r?f(n):r,n.__h),T(s,n),n.__e!=r&&_(n)))}))}function y(e,t,s,i,n,r,o,a,c,d){var u,A,g,_,b,C,y,v=i&&i.__k||h,x=v.length;for(s.__k=[],u=0;u<t.length;u++)if(null!=(_=s.__k[u]=null==(_=t[u])||"boolean"==typeof _?null:"string"==typeof _||"number"==typeof _||"bigint"==typeof _?m(null,_,null,null,_):Array.isArray(_)?m(p,{children:_},null,null,null):_.__b>0?m(_.type,_.props,_.key,null,_.__v):_)){if(_.__=s,_.__b=s.__b+1,null===(g=v[u])||g&&_.key==g.key&&_.type===g.type)v[u]=void 0;else for(A=0;A<x;A++){if((g=v[A])&&_.key==g.key&&_.type===g.type){v[A]=void 0;break}g=null}R(e,_,g=g||l,n,r,o,a,c,d),b=_.__e,(A=_.ref)&&g.ref!=A&&(y||(y=[]),g.ref&&y.push(g.ref,null,_),y.push(A,_.__c||b,_)),null!=b?(null==C&&(C=b),"function"==typeof _.type&&_.__k===g.__k?_.__d=c=w(_,c,e):c=k(e,_,g,v,b,c),"function"==typeof s.type&&(s.__d=c)):c&&g.__e==c&&c.parentNode!=e&&(c=f(g))}for(s.__e=C,u=x;u--;)null!=v[u]&&("function"==typeof s.type&&null!=v[u].__e&&v[u].__e==s.__d&&(s.__d=f(i,u+1)),B(v[u],v[u]));if(y)for(u=0;u<y.length;u++)D(y[u],y[++u],y[++u])}function w(e,t,s){for(var i,n=e.__k,r=0;n&&r<n.length;r++)(i=n[r])&&(i.__=e,t="function"==typeof i.type?w(i,t,s):k(s,i,i,n,i.__e,t));return t}function v(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){v(e,t)})):t.push(e)),t}function k(e,t,s,i,n,r){var o,a,l;if(void 0!==t.__d)o=t.__d,t.__d=void 0;else if(null==s||n!=r||null==n.parentNode)e:if(null==r||r.parentNode!==e)e.appendChild(n),o=null;else{for(a=r,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==n)break e;e.insertBefore(n,r),o=r}return void 0!==o?o:n.nextSibling}function x(e,t,s){"-"===t[0]?e.setProperty(t,s):e[t]=null==s?"":"number"!=typeof s||c.test(t)?s:s+"px"}function E(e,t,s,i,n){var r;e:if("style"===t)if("string"==typeof s)e.style.cssText=s;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)s&&t in s||x(e.style,t,"");if(s)for(t in s)i&&s[t]===i[t]||x(e.style,t,s[t])}else if("o"===t[0]&&"n"===t[1])r=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=s,s?i||e.addEventListener(t,r?P:S,r):e.removeEventListener(t,r?P:S,r);else if("dangerouslySetInnerHTML"!==t){if(n)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==s?"":s;break e}catch(e){}"function"==typeof s||(null!=s&&(!1!==s||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,s):e.removeAttribute(t))}}function S(e){this.l[e.type+!1](t.event?t.event(e):e)}function P(e){this.l[e.type+!0](t.event?t.event(e):e)}function R(e,s,i,n,r,o,a,l,h){var c,u,A,m,f,_,b,C,w,v,k,x=s.type;if(void 0!==s.constructor)return null;null!=i.__h&&(h=i.__h,l=s.__e=i.__e,s.__h=null,o=[l]),(c=t.__b)&&c(s);try{e:if("function"==typeof x){if(C=s.props,w=(c=x.contextType)&&n[c.__c],v=c?w?w.props.value:c.__:n,i.__c?b=(u=s.__c=i.__c).__=u.__E:("prototype"in x&&x.prototype.render?s.__c=u=new x(C,v):(s.__c=u=new g(C,v),u.constructor=x,u.render=M),w&&w.sub(u),u.props=C,u.state||(u.state={}),u.context=v,u.__n=n,A=u.__d=!0,u.__h=[]),null==u.__s&&(u.__s=u.state),null!=x.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=d({},u.__s)),d(u.__s,x.getDerivedStateFromProps(C,u.__s))),m=u.props,f=u.state,A)null==x.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(null==x.getDerivedStateFromProps&&C!==m&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(C,v),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(C,u.__s,v)||s.__v===i.__v){u.props=C,u.state=u.__s,s.__v!==i.__v&&(u.__d=!1),u.__v=s,s.__e=i.__e,s.__k=i.__k,s.__k.forEach((function(e){e&&(e.__=s)})),u.__h.length&&a.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(C,u.__s,v),null!=u.componentDidUpdate&&u.__h.push((function(){u.componentDidUpdate(m,f,_)}))}u.context=v,u.props=C,u.state=u.__s,(c=t.__r)&&c(s),u.__d=!1,u.__v=s,u.__P=e,c=u.render(u.props,u.state,u.context),u.state=u.__s,null!=u.getChildContext&&(n=d(d({},n),u.getChildContext())),A||null==u.getSnapshotBeforeUpdate||(_=u.getSnapshotBeforeUpdate(m,f)),k=null!=c&&c.type===p&&null==c.key?c.props.children:c,y(e,Array.isArray(k)?k:[k],s,i,n,r,o,a,l,h),u.base=s.__e,s.__h=null,u.__h.length&&a.push(u),b&&(u.__E=u.__=null),u.__e=!1}else null==o&&s.__v===i.__v?(s.__k=i.__k,s.__e=i.__e):s.__e=I(i.__e,s,i,n,r,o,a,h);(c=t.diffed)&&c(s)}catch(e){s.__v=null,(h||null!=o)&&(s.__e=l,s.__h=!!h,o[o.indexOf(l)]=null),t.__e(e,s,i)}}function T(e,s){t.__c&&t.__c(s,e),e.some((function(s){try{e=s.__h,s.__h=[],e.some((function(e){e.call(s)}))}catch(e){t.__e(e,s.__v)}}))}function I(t,s,i,n,r,o,a,h){var c,d,A,m=i.props,p=s.props,g=s.type,_=0;if("svg"===g&&(r=!0),null!=o)for(;_<o.length;_++)if((c=o[_])&&"setAttribute"in c==!!g&&(g?c.localName===g:3===c.nodeType)){t=c,o[_]=null;break}if(null==t){if(null===g)return document.createTextNode(p);t=r?document.createElementNS("http://www.w3.org/2000/svg",g):document.createElement(g,p.is&&p),o=null,h=!1}if(null===g)m===p||h&&t.data===p||(t.data=p);else{if(o=o&&e.call(t.childNodes),d=(m=i.props||l).dangerouslySetInnerHTML,A=p.dangerouslySetInnerHTML,!h){if(null!=o)for(m={},_=0;_<t.attributes.length;_++)m[t.attributes[_].name]=t.attributes[_].value;(A||d)&&(A&&(d&&A.__html==d.__html||A.__html===t.innerHTML)||(t.innerHTML=A&&A.__html||""))}if(function(e,t,s,i,n){var r;for(r in s)"children"===r||"key"===r||r in t||E(e,r,null,s[r],i);for(r in t)n&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||s[r]===t[r]||E(e,r,t[r],s[r],i)}(t,p,m,r,h),A)s.__k=[];else if(_=s.props.children,y(t,Array.isArray(_)?_:[_],s,i,n,r&&"foreignObject"!==g,o,a,o?o[0]:i.__k&&f(i,0),h),null!=o)for(_=o.length;_--;)null!=o[_]&&u(o[_]);h||("value"in p&&void 0!==(_=p.value)&&(_!==t.value||"progress"===g&&!_||"option"===g&&_!==m.value)&&E(t,"value",_,m.value,!1),"checked"in p&&void 0!==(_=p.checked)&&_!==t.checked&&E(t,"checked",_,m.checked,!1))}return t}function D(e,s,i){try{"function"==typeof e?e(s):e.current=s}catch(e){t.__e(e,i)}}function B(e,s,i){var n,r;if(t.unmount&&t.unmount(e),(n=e.ref)&&(n.current&&n.current!==e.__e||D(n,null,s)),null!=(n=e.__c)){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(e){t.__e(e,s)}n.base=n.__P=null}if(n=e.__k)for(r=0;r<n.length;r++)n[r]&&B(n[r],s,"function"!=typeof e.type);i||null==e.__e||u(e.__e),e.__e=e.__d=void 0}function M(e,t,s){return this.constructor(e,s)}function O(s,i,n){var r,o,a;t.__&&t.__(s,i),o=(r="function"==typeof n)?null:n&&n.__k||i.__k,a=[],R(i,s=(!r&&n||i).__k=A(p,null,[s]),o||l,l,void 0!==i.ownerSVGElement,!r&&n?[n]:o?null:i.firstChild?e.call(i.childNodes):null,a,!r&&n?n:o?o.__e:i.firstChild,r),T(a,s)}e=h.slice,t={__e:function(e,t,s,i){for(var n,r,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e,i||{}),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e}},s=0,g.prototype.setState=function(e,t){var s;s=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=d({},this.state),"function"==typeof e&&(e=e(d({},s),this.props)),e&&d(s,e),null!=e&&this.__v&&(t&&this.__h.push(t),b(this))},g.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),b(this))},g.prototype.render=p,i=[],r="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,C.__r=0,a=0,"undefined"!=typeof window&&window.__PREACT_DEVTOOLS__&&window.__PREACT_DEVTOOLS__.attachPreact("10.7.1",t,{Fragment:p,Component:g});var N={};function L(e){return e.type===p?"Fragment":"function"==typeof e.type?e.type.displayName||e.type.name:"string"==typeof e.type?e.type:"#text"}var U=[],F=[];function j(){return U.length>0?U[U.length-1]:null}var z=!1;function X(e){return"function"==typeof e.type&&e.type!=p}function Z(e){for(var t=[e],s=e;null!=s.__o;)t.push(s.__o),s=s.__o;return t.reduce((function(e,t){e+="  in "+L(t);var s=t.__source;return s?e+=" (at "+s.fileName+":"+s.lineNumber+")":z||(z=!0,console.warn("Add @babel/plugin-transform-react-jsx-source to get a more detailed component stack. Note that you should not add it to production builds of your App for bundle size reasons.")),e+"\n"}),"")}var G="function"==typeof WeakMap,H=g.prototype.setState;g.prototype.setState=function(e,t){return null==this.__v?null==this.state&&console.warn('Calling "this.setState" inside the constructor of a component is a no-op and might be a bug in your application. Instead, set "this.state = {}" directly.\n\n'+Z(j())):null==this.__P&&console.warn('Can\'t call "this.setState" on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.\n\n'+Z(this.__v)),H.call(this,e,t)};var W=g.prototype.forceUpdate;function Y(e){var t=e.props,s=L(e),i="";for(var n in t)if(t.hasOwnProperty(n)&&"children"!==n){var r=t[n];"function"==typeof r&&(r="function "+(r.displayName||r.name)+"() {}"),r=Object(r)!==r||r.toString?r+"":Object.prototype.toString.call(r),i+=" "+n+"="+JSON.stringify(r)}var o=t.children;return"<"+s+i+(o&&o.length?">..</"+s+">":" />")}g.prototype.forceUpdate=function(e){return null==this.__v?console.warn('Calling "this.forceUpdate" inside the constructor of a component is a no-op and might be a bug in your application.\n\n'+Z(j())):null==this.__P&&console.warn('Can\'t call "this.forceUpdate" on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in the componentWillUnmount method.\n\n'+Z(this.__v)),W.call(this,e)},function(){!function(){var e=t.__b,s=t.diffed,i=t.__,n=t.vnode,r=t.__r;t.diffed=function(e){X(e)&&F.pop(),U.pop(),s&&s(e)},t.__b=function(t){X(t)&&U.push(t),e&&e(t)},t.__=function(e,t){F=[],i&&i(e,t)},t.vnode=function(e){e.__o=F.length>0?F[F.length-1]:null,n&&n(e)},t.__r=function(e){X(e)&&F.push(e),r&&r(e)}}();var e=!1,s=t.__b,i=t.diffed,n=t.vnode,r=t.__e,o=t.__,a=t.__h,l=G?{useEffect:new WeakMap,useLayoutEffect:new WeakMap,lazyPropTypes:new WeakMap}:null,h=[];t.__e=function(e,t,s,i){if(t&&t.__c&&"function"==typeof e.then){var n=e;e=new Error("Missing Suspense. The throwing component was: "+L(t));for(var o=t;o;o=o.__)if(o.__c&&o.__c.__c){e=n;break}if(e instanceof Error)throw e}try{(i=i||{}).componentStack=Z(t),r(e,t,s,i),"function"!=typeof e.then&&setTimeout((function(){throw e}))}catch(e){throw e}},t.__=function(e,t){if(!t)throw new Error("Undefined parent passed to render(), this is the second argument.\nCheck if the element is available in the DOM/has the correct id.");var s;switch(t.nodeType){case 1:case 11:case 9:s=!0;break;default:s=!1}if(!s){var i=L(e);throw new Error("Expected a valid HTML node as a second argument to render.\tReceived "+t+" instead: render(<"+i+" />, "+t+");")}o&&o(e,t)},t.__b=function(t){var i=t.type,n=function e(t){return t?"function"==typeof t.type?e(t.__):t:{}}(t.__);if(e=!0,void 0===i)throw new Error("Undefined component passed to createElement()\n\nYou likely forgot to export your component or might have mixed up default and named imports"+Y(t)+"\n\n"+Z(t));if(null!=i&&"object"==typeof i){if(void 0!==i.__k&&void 0!==i.__e)throw new Error("Invalid type passed to createElement(): "+i+"\n\nDid you accidentally pass a JSX literal as JSX twice?\n\n  let My"+L(t)+" = "+Y(i)+";\n  let vnode = <My"+L(t)+" />;\n\nThis usually happens when you export a JSX literal and not the component.\n\n"+Z(t));throw new Error("Invalid type passed to createElement(): "+(Array.isArray(i)?"array":i))}if("thead"!==i&&"tfoot"!==i&&"tbody"!==i||"table"===n.type?"tr"===i&&"thead"!==n.type&&"tfoot"!==n.type&&"tbody"!==n.type&&"table"!==n.type?console.error("Improper nesting of table. Your <tr> should have a <thead/tbody/tfoot/table> parent."+Y(t)+"\n\n"+Z(t)):"td"===i&&"tr"!==n.type?console.error("Improper nesting of table. Your <td> should have a <tr> parent."+Y(t)+"\n\n"+Z(t)):"th"===i&&"tr"!==n.type&&console.error("Improper nesting of table. Your <th> should have a <tr>."+Y(t)+"\n\n"+Z(t)):console.error("Improper nesting of table. Your <thead/tbody/tfoot> should have a <table> parent."+Y(t)+"\n\n"+Z(t)),void 0!==t.ref&&"function"!=typeof t.ref&&"object"!=typeof t.ref&&!("$$typeof"in t))throw new Error('Component\'s "ref" property should be a function, or an object created by createRef(), but got ['+typeof t.ref+"] instead\n"+Y(t)+"\n\n"+Z(t));if("string"==typeof t.type)for(var r in t.props)if("o"===r[0]&&"n"===r[1]&&"function"!=typeof t.props[r]&&null!=t.props[r])throw new Error("Component's \""+r+'" property should be a function, but got ['+typeof t.props[r]+"] instead\n"+Y(t)+"\n\n"+Z(t));if("function"==typeof t.type&&t.type.propTypes){if("Lazy"===t.type.displayName&&l&&!l.lazyPropTypes.has(t.type)){var o="PropTypes are not supported on lazy(). Use propTypes on the wrapped component itself. ";try{var a=t.type();l.lazyPropTypes.set(t.type,!0),console.warn(o+"Component wrapped in lazy() is "+L(a))}catch(t){console.warn(o+"We will log the wrapped component's name once it is loaded.")}}var h=t.props;t.type.__f&&delete(h=function(e,t){for(var s in t)e[s]=t[s];return e}({},h)).ref,function(e,t,s,i,n){Object.keys(e).forEach((function(s){var r;try{r=e[s](t,s,i,"prop",null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){r=e}!r||r.message in N||(N[r.message]=!0,console.error("Failed prop type: "+r.message+(n&&"\n"+n()||"")))}))}(t.type.propTypes,h,0,L(t),(function(){return Z(t)}))}s&&s(t)},t.__h=function(t,s,i){if(!t||!e)throw new Error("Hook can only be invoked from render methods.");a&&a(t,s,i)};var c=function(e,t){return{get:function(){var s="get"+e+t;h&&h.indexOf(s)<0&&(h.push(s),console.warn("getting vnode."+e+" is deprecated, "+t))},set:function(){var s="set"+e+t;h&&h.indexOf(s)<0&&(h.push(s),console.warn("setting vnode."+e+" is not allowed, "+t))}}},d={nodeName:c("nodeName","use vnode.type"),attributes:c("attributes","use vnode.props"),children:c("children","use vnode.props.children")},u=Object.create({},d);t.vnode=function(e){var t=e.props;if(null!==e.type&&null!=t&&("__source"in t||"__self"in t)){var s=e.props={};for(var i in t){var r=t[i];"__source"===i?e.__source=r:"__self"===i?e.__self=r:s[i]=r}}e.__proto__=u,n&&n(e)},t.diffed=function(t){if(t.__k&&t.__k.forEach((function(e){if(e&&void 0===e.type){delete e.__,delete e.__b;var s=Object.keys(e).join(",");throw new Error("Objects are not valid as a child. Encountered an object with the keys {"+s+"}.\n\n"+Z(t))}})),e=!1,i&&i(t),null!=t.__k)for(var s=[],n=0;n<t.__k.length;n++){var r=t.__k[n];if(r&&null!=r.key){var o=r.key;if(-1!==s.indexOf(o)){console.error('Following component has two or more children with the same key attribute: "'+o+'". This may cause glitches and misbehavior in rendering process. Component: \n\n'+Y(t)+"\n\n"+Z(t));break}s.push(o)}}}}();var K=n(4184),J=n.n(K),V=n(3379),q=n.n(V),$=n(7795),Q=n.n($),ee=n(569),te=n.n(ee),se=n(3565),ie=n.n(se),ne=n(9216),re=n.n(ne),oe=n(4589),ae=n.n(oe),le=n(3162),he={};he.styleTagTransform=ae(),he.setAttributes=ie(),he.insert=te().bind(null,"head"),he.domAPI=Q(),he.insertStyleElement=re(),q()(le.Z,he);const ce=le.Z&&le.Z.locals?le.Z.locals:void 0,de=({e})=>A("div",{className:ce.header},A("a",{href:"https://github.com/whscullin/apple2js#readme",rel:"noreferrer",target:"_blank"},A("img",{src:"img/badge.png",className:ce.badge})),A("div",{className:ce.subtitle},"An Apple ",e?"//e":"]["," Emulator in JavaScript"));var ue,Ae,me,pe=0,ge=[],fe=t.__b,_e=t.__r,be=t.diffed,Ce=t.__c,ye=t.unmount;function we(e,s){t.__h&&t.__h(Ae,e,pe||s),pe=0;var i=Ae.__H||(Ae.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function ve(e){return pe=1,function(e,t,s){var i=we(ue++,2);return i.t=e,i.__c||(i.__=[s?s(t):Me(void 0,t),function(e){var t=i.t(i.__[0],e);i.__[0]!==t&&(i.__=[t,i.__[1]],i.__c.setState({}))}],i.__c=Ae),i.__}(Me,e)}function ke(e,s){var i=we(ue++,3);!t.__s&&Be(i.__H,s)&&(i.__=e,i.__H=s,Ae.__H.__h.push(i))}function xe(e){return pe=5,Ee((function(){return{current:e}}),[])}function Ee(e,t){var s=we(ue++,7);return Be(s.__H,t)&&(s.__=e(),s.__H=t,s.__h=e),s.__}function Se(e,t){return pe=8,Ee((function(){return e}),t)}function Pe(e){var t=Ae.context[e.__c],s=we(ue++,9);return s.c=e,t?(null==s.__&&(s.__=!0,t.sub(Ae)),t.props.value):e.__}function Re(){for(var e;e=ge.shift();)if(e.__P)try{e.__H.__h.forEach(Ie),e.__H.__h.forEach(De),e.__H.__h=[]}catch(s){e.__H.__h=[],t.__e(s,e.__v)}}t.__b=function(e){Ae=null,fe&&fe(e)},t.__r=function(e){_e&&_e(e),ue=0;var t=(Ae=e.__c).__H;t&&(t.__h.forEach(Ie),t.__h.forEach(De),t.__h=[])},t.diffed=function(e){be&&be(e);var s=e.__c;s&&s.__H&&s.__H.__h.length&&(1!==ge.push(s)&&me===t.requestAnimationFrame||((me=t.requestAnimationFrame)||function(e){var t,s=function(){clearTimeout(i),Te&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(s,100);Te&&(t=requestAnimationFrame(s))})(Re)),Ae=null},t.__c=function(e,s){s.some((function(e){try{e.__h.forEach(Ie),e.__h=e.__h.filter((function(e){return!e.__||De(e)}))}catch(i){s.some((function(e){e.__h&&(e.__h=[])})),s=[],t.__e(i,e.__v)}})),Ce&&Ce(e,s)},t.unmount=function(e){ye&&ye(e);var s,i=e.__c;i&&i.__H&&(i.__H.__.forEach((function(e){try{Ie(e)}catch(e){s=e}})),s&&t.__e(s,i.__v))};var Te="function"==typeof requestAnimationFrame;function Ie(e){var t=Ae,s=e.__c;"function"==typeof s&&(e.__c=void 0,s()),Ae=t}function De(e){var t=Ae;e.__c=e.__(),Ae=t}function Be(e,t){return!e||e.length!==t.length||t.some((function(t,s){return t!==e[s]}))}function Me(e,t){return"function"==typeof t?t(e):t}const Oe="0123456789ABCDEF";function Ne(){return 256*Math.random()&255}function Le(e){const t=new Uint8Array(e);for(let s=0;s<e;s++)t[s]=2&s?0:255;for(let s=0;s<e;s+=512)t[s+40]=Ne(),t[s+41]=Ne(),t[s+104]=Ne(),t[s+105]=Ne();return t}function Ue(e){return Le(e<<8)}function Fe(e){return new Uint8Array(e)}function je(...e){console.log(...e)}function ze(e,t){t||(t=e<256?2:4);let s="";for(let i=0;i<t;i++)s=Oe[15&e]+s,e>>=4;return s}class Xe{constructor(e,t){this.cpu=e,this.vm=t,this._slot=new Array(7).fill(null),this._auxRom=null,this._khz=1023,this._rate=44e3,this._sample_size=4096,this._buffer=[],this._key=0,this._keyDown=!1,this._button=[!1,!1,!1],this._paddle=[0,0,0,0],this._phase=-1,this._sample=[],this._sampleIdx=0,this._sampleTime=0,this._didAudio=!1,this._high=.5,this._low=-.5,this._trigger=0,this._annunciators=[!1,!1,!1,!1],this._tape=[],this._tapeOffset=0,this._tapeNext=0,this._tapeCurrent=!1,this.init()}init(){this._calcSampleRate()}_debug(...e){}_tick(){const e=this.cpu.getCycles(),t=this._didAudio?this._phase>0?this._high:this._low:0;for(;this._sampleTime<e;this._sampleTime+=this._cycles_per_sample)this._sample[this._sampleIdx++]=t,this._sampleIdx===this._sample_size&&(this._audioListener&&this._audioListener(this._sample),this._sample=new Array(this._sample_size),this._sampleIdx=0);this._didAudio=!1}_calcSampleRate(){this._cycles_per_sample=1e3*this._khz/this._rate}_updateKHz(e){this._khz=e,this._calcSampleRate()}_access(e,t){let s=0;const i=this.cpu.getCycles(),n=void 0===t,r=i-this._trigger;switch(e){case 80:this._debug("Graphics Mode"),this.vm.text(!1);break;case 81:this._debug("Text Mode"),this.vm.text(!0);break;case 82:this._debug("Mixed Mode off"),this.vm.mixed(!1);break;case 83:this._debug("Mixed Mode on"),this.vm.mixed(!0);break;case 86:this._debug("LoRes Mode"),this.vm.hires(!1);break;case 87:this._debug("HiRes Mode"),this.vm.hires(!0);break;case 84:this.vm.page(1);break;case 85:this.vm.page(2);break;case 89:this._debug("Annunciator 0 on"),this._annunciators[0]=!0;break;case 91:this._debug("Annunciator 1 on"),this._annunciators[1]=!0;break;case 93:this._debug("Annunciator 2 on"),this._annunciators[2]=!0;break;case 95:this._debug("Annunciator 3 on"),this._annunciators[3]=!0;break;case 88:this._debug("Annunciator 0 off"),this._annunciators[0]=!1;break;case 90:this._debug("Annunciator 1 off"),this._annunciators[1]=!1;break;case 92:this._debug("Annunciator 2 off"),this._annunciators[2]=!1;break;case 94:this._debug("Annunciator 3 off"),this._annunciators[3]=!1;break;case 97:s=this._button[0]?128:0;break;case 98:s=this._button[1]?128:0;break;case 99:s=this._button[2]?128:0;break;case 100:s=r<2756*this._paddle[0]?128:0;break;case 101:s=r<2756*this._paddle[1]?128:0;break;case 102:s=r<2756*this._paddle[2]?128:0;break;case 103:s=r<2756*this._paddle[3]?128:0;break;case 116:void 0!==t&&this._updateKHz(1&t?1023:4096);break;case 96:if(-1===this._tapeOffset&&(this._tapeOffset=0,this._tapeNext=i),this._tapeOffset<this._tape.length)for(this._tapeCurrent=this._tape[this._tapeOffset][1];i>=this._tapeNext;)this._tapeOffset%1e3==0&&je("Read "+this._tapeOffset/1e3),this._tapeCurrent=this._tape[this._tapeOffset][1],this._tapeNext+=this._tape[this._tapeOffset++][0];s=this._tapeCurrent?128:0;break;default:switch(240&e){case 0:s=this._key;break;case 16:if((16===e||n)&&(this._key&=127),this._buffer.length>0){let e=this._buffer.shift();"\n"===e&&(e="\r"),this._key=128|e.charCodeAt(0)}s=127&this._key,16===e&&(s|=this._keyDown?128:0);break;case 32:case 64:break;case 48:this._phase=-this._phase,this._didAudio=!0,this._tick();break;case 112:this._trigger=this.cpu.getCycles()}}return void 0!==t&&(s=void 0),s}start(){return 192}end(){return 207}ioSwitch(e,t){let s;if(e<128)s=this._access(e,t);else{const i=(112&e)>>4,n=this._slot[i];n&&n.ioSwitch&&(s=n.ioSwitch(e,t))}return s}reset(){var e;for(let t=0;t<8;t++){const s=this._slot[t];s&&(null===(e=s.reset)||void 0===e||e.call(s))}this.vm.reset()}blit(){var e;const t=this._slot[3];if(t)return null===(e=t.blit)||void 0===e?void 0:e.call(t)}read(e,t){let s,i,n=0;switch(e){case 192:n=this.ioSwitch(t,void 0)||0;break;case 193:case 194:case 195:case 196:case 197:case 198:case 199:s=15&e,i=this._slot[s],this._auxRom!==i&&(this._auxRom=i),n=i?i.read(e,t):Ne();break;default:this._auxRom&&(n=this._auxRom.read(e,t))}return n}write(e,t,s){let i,n;switch(e){case 192:this.ioSwitch(t,s);break;case 193:case 194:case 195:case 196:case 197:case 198:case 199:i=15&e,n=this._slot[i],this._auxRom!==n&&(this._auxRom=n),n&&n.write(e,t,s);break;default:this._auxRom&&this._auxRom.write(e,t,s)}}getState(){return{annunciators:this._annunciators,cards:this._slot.map((e=>e?e.getState():null))}}setState(e){this._annunciators=e.annunciators,e.cards.map(((e,t)=>{var s;return null===(s=this._slot[t])||void 0===s?void 0:s.setState(e)}))}setSlot(e,t){this._slot[e]=t}getSlot(e){return this._slot[e]}keyDown(e){this._keyDown=!0,this._key=128|e}keyUp(){this._keyDown=!1}buttonDown(e,t=!0){this._button[e]=t}buttonUp(e){this._button[e]=!1}paddle(e,t){this._paddle[e]=t}updateKHz(e){this._updateKHz(e)}getKHz(){return this._khz}setKeyBuffer(e){if(this._buffer=e.split(""),this._buffer.length>0){this._keyDown=!0;const e=this._buffer.shift();this._key=128|e.charCodeAt(0)}}setTape(e){je(`Tape length: ${e.length}`),this._tape=e,this._tapeOffset=-1}sampleRate(e,t){this._rate=e,this._sample_size=t,this._sample=new Array(this._sample_size),this._sampleIdx=0,this._calcSampleRate()}tick(){var e,t;this._tick();for(let s=0;s<8;s++)null===(t=null===(e=this._slot[s])||void 0===e?void 0:e.tick)||void 0===t||t.call(e)}addSampleListener(e){this._audioListener=e}annunciator(e){return this._annunciators[e]}cycles(){return this.cpu.getCycles()}}const Ze=e=>[.75*e[0]&255,.75*e[1]&255,.75*e[2]&255],Ge=[255,106,60],He=[20,245,60],We=[20,207,253],Ye=[255,68,253],Ke=[255,255,255],Je=[0,0,0],Ve=[[0,0,0],[227,30,96],[96,78,189],[255,68,253],[0,163,96],[156,156,156],[20,207,253],[208,195,255],[96,114,3],[255,106,60],[156,156,156],[255,160,208],[20,245,60],[208,221,141],[114,255,208],[255,255,255]],qe=[0,2,4,6,8,5,12,14,1,3,10,7,9,11,13,15],$e=[[0,0,0],[227,30,96],[96,78,189],[255,68,253],[0,163,96],[156,156,156],[20,207,253],[208,195,255],[96,114,3],[255,106,60],[156,156,156],[255,160,208],[20,245,60],[208,221,141],[114,255,208],[255,255,255]],Qe={top:193,bottom:-1,left:561,right:-1};class et{constructor(e,t,s,i){this.vm=e,this.page=t,this.charset=s,this.e=i,this._buffer=[],this._refreshing=!1,this._blink=!1,this.highColorTextMode=!1,this.dirty=Object.assign({},Qe),this.imageData=this.vm.context.createImageData(560,192),this.imageData.data.fill(255),this._buffer[0]=Ue(4),this._buffer[1]=Ue(4),this.vm.setLoresPage(t,this)}_drawPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=i,e[t+1]=e[t+5]=n,e[t+2]=e[t+6]=r}_drawHalfPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=i,e[t+1]=n,e[t+2]=r}_checkInverse(e){let t=!1;return this.e?this.vm._80colMode||this.vm.altCharMode||(t=64==(192&e)&&this._blink):t=!(128&e||64&e&&this._blink),t}bank0(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,0),write:(e,t,s)=>this._write(e,t,s,0)}}bank1(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,1),write:(e,t,s)=>this._write(e,t,s,1)}}_start(){return 4*this.page}_end(){return 4*this.page+3}_read(e,t,s){const i=1023&(e<<8|t);return this._buffer[s][i]}_write(e,t,s,i){const n=1023&(e<<8|t);let r,o;if(this._buffer[i][n]===s&&!this._refreshing)return;this._buffer[i][n]=s;const a=n%128%40,l=t-a,h=24&l|(3&e)<<1|l>>7,c=this.imageData.data;if(h<24&&a<40){let e=h<<3;e<this.dirty.top&&(this.dirty.top=e),e+=8,e>this.dirty.bottom&&(this.dirty.bottom=e);let t=14*a;if(t<this.dirty.left&&(this.dirty.left=t),t+=14,t>this.dirty.right&&(this.dirty.right=t),this.vm.textMode||this.vm.hiresMode||this.vm.mixedMode&&h>19)if(this.vm._80colMode){const e=this._checkInverse(s);r=e?Je:Ke,o=e?Ke:Je,this.vm.altCharMode||(s=s>=64&&s<128?s-64:s);let t=4*(14*a+7*(i?0:1)+560*h*8);for(let e=0;e<8;e++){let i=this.charset[8*s+e];for(let e=0;e<7;e++){const e=1&i?o:r;this._drawHalfPixel(c,t,e),i>>=1,t+=4}t+=2212}}else{s=this._buffer[0][n];const e=this._checkInverse(s);r=e?Je:Ke,o=e?Ke:Je,this.vm.altCharMode||(s=s>=64&&s<128?s-64:s);let t=4*(14*a+560*h*8);if(this.highColorTextMode&&(r=Ve[this._buffer[1][n]>>4],o=Ve[15&this._buffer[1][n]]),this.e)for(let e=0;e<8;e++){let i=this.charset[8*s+e];for(let e=0;e<7;e++){const e=1&i?o:r;this._drawPixel(c,t,e),i>>=1,t+=8}t+=2184}else{const i=this.vm.mixedMode&&!this.vm.textMode&&!this.vm.monoMode;for(let n=0;n<8;n++){let l=!(1&a),h=this.charset[8*s+n]<<1;i&&e&&(h^=511);for(let e=0;e<7;e++){let e;i?(e=128&h?128!=(448&h)?Ke:l?Ye:He:Je,l=!l):e=128&h?r:o,this._drawPixel(c,t,e),h<<=1,t+=8}t+=2184}}}else if(this.vm._80colMode&&!this.vm.an3State){let e=4*(14*a+7*(i?0:1)+560*h*8);if(this.vm.monoMode)for(let t=0;t<8;t++){let i=t<4?15&s:s>>4;i|=i<<4,i|=i<<8,1&a&&(i>>=2);for(let t=0;t<7;t++){const t=1&i?Ke:Je;this._drawHalfPixel(c,e,t),i>>=1,e+=4}e+=2212}else{1&i&&(s=(119&s)<<1|(136&s)>>3);for(let t=0;t<8;t++){const i=Ve[t<4?15&s:s>>4];for(let t=0;t<7;t++)this._drawHalfPixel(c,e,i),e+=4;e+=2212}}}else if(0===i){let e=4*(14*a+560*h*8);if(this.vm.monoMode)for(let t=0;t<8;t++){let i=t<4?15&s:s>>4;i|=i<<4,i|=i<<8,1&a&&(i>>=2);for(let t=0;t<14;t++){const t=1&i?Ke:Je;this._drawHalfPixel(c,e,t),i>>=1,e+=4}e+=2184}else for(let t=0;t<8;t++){const i=Ve[t<4?15&s:s>>4];for(let t=0;t<7;t++)this._drawPixel(c,e,i),e+=8;e+=2184}}}}refresh(){this.highColorTextMode=!this.vm.an3State&&this.vm.textMode&&!this.vm._80colMode;let e=1024*this.page;this._refreshing=!0;for(let t=0;t<1024;t++,e++)this._write(e>>8,255&e,this._buffer[0][t],0),this.vm._80colMode&&this._write(e>>8,255&e,this._buffer[1][t],1);this._refreshing=!1}blink(){let e=1024*this.page;this._refreshing=!0,this._blink=!this._blink;for(let t=0;t<1024;t++,e++)64==(192&this._buffer[0][t])&&this._write(e>>8,255&e,this._buffer[0][t],0);this._refreshing=!1}start(){return setInterval((()=>this.blink()),267),this._start()}end(){return this._end()}read(e,t){return this._read(e,t,0)}write(e,t,s){return this._write(e,t,s,0)}getState(){return{buffer:[new Uint8Array(this._buffer[0]),new Uint8Array(this._buffer[1])]}}setState(e){this._buffer[0]=new Uint8Array(e.buffer[0]),this._buffer[1]=new Uint8Array(e.buffer[1]),this.refresh()}rowToBase(e){const t=e>>3&3;return(e>>1&3)<<8|(1&e)<<7|t<<5|t<<3}mapCharCode(e){return(e&=127)<32&&(e+=64),!this.e&&e>=96&&(e-=64),e}getText(){let e,t,s,i,n,r="";for(s=0;s<24;s++){if(n=this.rowToBase(s),e="",this.e&&this.vm._80colMode)for(i=0;i<80;i++)t=this.mapCharCode(this._buffer[1-i%2][n+Math.floor(i/2)]),e+=String.fromCharCode(t);else for(i=0;i<40;i++)t=this.mapCharCode(this._buffer[0][n+i]),e+=String.fromCharCode(t);e=e.trimRight(),r+=e+"\n"}return r}}class tt{constructor(e,t){this.vm=e,this.page=t,this.dirty=Object.assign({},Qe),this._buffer=[],this._refreshing=!1,this.colorDHRMode=!0,this.imageData=this.vm.context.createImageData(560,192),this.imageData.data.fill(255),this._buffer[0]=Ue(32),this._buffer[1]=Ue(32),this.vm.setHiresPage(t,this)}_drawPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=i,e[t+1]=e[t+5]=n,e[t+2]=e[t+6]=r}_drawHalfPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=i,e[t+1]=n,e[t+2]=r}_draw3Pixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=e[t+8]=i,e[t+1]=e[t+5]=e[t+9]=n,e[t+2]=e[t+6]=e[t+10]=r}_draw4Pixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=e[t+8]=e[t+12]=i,e[t+1]=e[t+5]=e[t+9]=e[t+13]=n,e[t+2]=e[t+6]=e[t+10]=e[t+14]=r}bank0(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,0),write:(e,t,s)=>this._write(e,t,s,0)}}bank1(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,1),write:(e,t,s)=>this._write(e,t,s,1)}}_start(){return 32*this.page}_end(){return 32*this.page+31}_read(e,t,s){const i=8191&(e<<8|t);return this._buffer[s][i]}_write(e,t,s,i){const n=e<<8|t,r=8191&n;if(this._buffer[i][r]===s&&!this._refreshing)return;this._buffer[i][r]=s;const o=r%128%40,a=t-o,l=24&a|(3&e)<<1|a>>7,h=r>>10,c=this.imageData.data;let d,u;if(l<24&&o<40&&(this.vm.hiresMode||this._refreshing)){let e=l<<4|h<<1;e<this.dirty.top&&(this.dirty.top=e),e+=1,e>this.dirty.bottom&&(this.dirty.bottom=e);let t,a,A,m,p,g,f,_=14*o-2;if(_<this.dirty.left&&(this.dirty.left=_),_+=18,_>this.dirty.right&&(this.dirty.right=_),u=l<<4|h<<1,this.oneSixtyMode&&!this.vm.monoMode){const e=15&s,t=s>>4;d=2*o+(1^i);const n=28*d+280*u*4;this._draw3Pixel(c,n,$e[e]),this._draw4Pixel(c,n+12,$e[t])}else if(this.vm.doubleHiresMode){s&=127;const e=o%2,l=o-e,h=r-e;t=this._buffer[0][h-1],a=this._buffer[1][h],A=this._buffer[0][h],m=this._buffer[1][h+1],p=this._buffer[0][h+1],g=this._buffer[1][h+2],f=[0,(15&a)>>0,(112&a)>>4|(1&A)<<3,(30&A)>>1,(96&A)>>5|(3&m)<<2,(60&m)>>2,(64&m)>>6|(7&p)<<1,(120&p)>>3,0];const _=[0,128&a,128&a,128&A,128&m,128&m,128&p,128&p,0];o>0&&(f[0]=(120&t)>>3,_[0]=128&t),o<39&&(f[8]=15&g,_[8]=128&g),d=14*l;let b=4*d+280*u*4,C=null;(this.vm.monoMode||this.monoDHRMode)&&(C=Ke);for(let e=1;e<8;e++){const t=_[e],s=$e[qe[f[e]]];let i=f[e-1]|f[e]<<4|f[e+1]<<8;for(let n=0;n<4;n++,b+=4)C?16&i?this._drawHalfPixel(c,b,C):this._drawHalfPixel(c,b,Je):this.mixedDHRMode?t?this._drawHalfPixel(c,b,s):16&i?this._drawHalfPixel(c,b,Ke):this._drawHalfPixel(c,b,Je):this.colorDHRMode?this._drawHalfPixel(c,b,s):f[e]===f[e-1]||f[e]===f[e+1]||28!=(28&i)&&112!=(112&i)&&56!=(56&i)?56&i||f[e]===f[e+1]||f[e]===f[e-1]?this._drawHalfPixel(c,b,s):40&i?this._drawHalfPixel(c,b,Ze(s)):this._drawHalfPixel(c,b,Je):this._drawHalfPixel(c,b,Ke),i>>=1}if(!this._refreshing){this._refreshing=!0;const e=i?0:1;for(let t=n-1;t<=n+1;t++){const s=this._read(t>>8,255&t,e);this._write(t>>8,255&t,s,e)}this._refreshing=!1}}else{const e=128&(s=this._buffer[0][r]);s&=127,d=14*o-2,a=o>0?this._buffer[0][r-1]:0,m=o<39?this._buffer[0][r+1]:0;let t,i=32&a,n=64&a,l=1&(s|=(3&m)<<7),h=!(1&o);const A=e?Ge:He,p=e?We:Ye;let g=4*d+280*u*4;const f=this.vm.monoMode?Ke:null;for(let e=0;e<9;e++,g+=8)s>>=1,t=n?f||(this.highColorHGRMode?$e[this._buffer[1][r]>>4]:i||l?Ke:h?A:p):f?Je:this.highColorHGRMode?$e[15&this._buffer[1][r]]:h&&l&&i?i?Ze(p):p:!h&&i&&l?l?Ze(A):A:Je,d>-1&&d<560&&this._drawPixel(c,g,t),d+=2,i=n,n=l,l=1&s,h=!h}}}refresh(){this.highColorHGRMode=!this.vm.an3State&&this.vm.hiresMode&&!this.vm._80colMode,this.oneSixtyMode=1===this.vm.flag&&this.vm.doubleHiresMode,this.mixedDHRMode=2===this.vm.flag&&this.vm.doubleHiresMode,this.monoDHRMode=3===this.vm.flag&&this.vm.doubleHiresMode;let e=8192*this.page;this._refreshing=!0;for(let t=0;t<8192;t++,e++){const s=e>>8,i=255&e;this._write(s,i,this._buffer[0][t],0),this.vm._80colMode&&this._write(s,i,this._buffer[1][t],1)}this._refreshing=!1}start(){return this._start()}end(){return this._end()}read(e,t){return this._read(e,t,0)}write(e,t,s){return this._write(e,t,s,0)}getState(){return{buffer:[new Uint8Array(this._buffer[0]),new Uint8Array(this._buffer[1])]}}setState(e){this._buffer[0]=new Uint8Array(e.buffer[0]),this._buffer[1]=new Uint8Array(e.buffer[1]),this.refresh()}}class st{constructor(e,t){this.screen=e,this.e=t,this._grs=[],this._hgrs=[],this._refreshFlag=!0,this.ready=Promise.resolve(),this.flag=0,this.monoMode=!1,this._canvas=document.createElement("canvas");const s=this._canvas.getContext("2d"),i=this.screen.getContext("2d");if(!s||!i)throw new Error("No 2d context");this.context=s;const{width:n,height:r}={width:560,height:192};this._canvas.width=n,this._canvas.height=r,this._screenContext=i,this._screenContext.imageSmoothingEnabled=!1,this._left=(this.screen.width-560)/2,this._top=(this.screen.height-384)/2}_refresh(){this.doubleHiresMode=!this.an3State&&this.hiresMode&&this._80colMode,this._refreshFlag=!0}refresh(){this._refresh()}reset(){this.textMode=!0,this.mixedMode=!1,this.hiresMode=!0,this.pageMode=1,this._80colMode=!1,this.altCharMode=!1,this.flag=0,this.an3State=!0,this._refresh()}setLoresPage(e,t){this._grs[e-1]=t}setHiresPage(e,t){this._hgrs[e-1]=t}getLoresPage(e){return this._grs[e-1]}getHiresPage(e){return this._hgrs[e-1]}text(e){const t=this.textMode;this.textMode=e,e&&(this.flag=0),t!==e&&this._refresh()}_80col(e){if(!this.e)return;const t=this._80colMode;this._80colMode=e,t!==e&&this._refresh()}altChar(e){if(!this.e)return;const t=this.altCharMode;this.altCharMode=e,t!==e&&this._refresh()}hires(e){const t=this.hiresMode;this.hiresMode=e,e||(this.flag=0),t!==e&&this._refresh()}an3(e){if(!this.e)return;const t=this.an3State;this.an3State=e,e&&(this.flag=3&(this.flag<<1|(this._80colMode?0:1))),t!==e&&this._refresh()}doubleHires(e){this.an3(!e)}mixed(e){const t=this.mixedMode;this.mixedMode=e,t!==e&&this._refresh()}page(e){const t=this.pageMode;this.pageMode=e,t!==e&&this._refresh()}isText(){return this.textMode}isMixed(){return this.mixedMode}isPage2(){return 2===this.pageMode}isHires(){return this.hiresMode}isDoubleHires(){return this.doubleHiresMode}is80Col(){return this._80colMode}isAltChar(){return this.altCharMode}buildScreen(e,t){const{x:s,y:i}=(this._80colMode,{x:0,y:0});return t?(this.context.putImageData(e,s,i,0,0,560,160),this.context.putImageData(t,s,i,0,160,560,32)):this.context.putImageData(e,s,i),this._canvas}updateImage(e,t,s,i){let n=!1;if(-1!==t.bottom||i&&-1!==i.bottom){const t=this.buildScreen(e,s);this._screenContext.drawImage(t,0,0,560,192,this._left,this._top,560,384),n=!0}return n}blit(e){let t=!1;const s=this._hgrs[this.pageMode-1],i=this._grs[this.pageMode-1];return this._refreshFlag&&(s.refresh(),i.refresh(),this._refreshFlag=!1),t=e?this.updateImage(e,{top:0,left:0,right:560,bottom:192}):this.hiresMode&&!this.textMode?this.updateImage(s.imageData,s.dirty,this.mixedMode?i.imageData:null,this.mixedMode?i.dirty:null):this.updateImage(i.imageData,i.dirty),s.dirty=Object.assign({},Qe),i.dirty=Object.assign({},Qe),t}getState(){return{grs:[this._grs[0].getState(),this._grs[1].getState()],hgrs:[this._hgrs[0].getState(),this._hgrs[1].getState()],textMode:this.textMode,mixedMode:this.mixedMode,hiresMode:this.hiresMode,pageMode:this.pageMode,_80colMode:this._80colMode,altCharMode:this.altCharMode,an3State:this.an3State,flag:this.flag}}setState(e){this.textMode=e.textMode,this.mixedMode=e.mixedMode,this.hiresMode=e.hiresMode,this.pageMode=e.pageMode,this._80colMode=e._80colMode,this.altCharMode=e.altCharMode,this.an3State=e.an3State,this.flag=e.flag,this._grs[0].setState(e.grs[0]),this._grs[1].setState(e.grs[1]),this._hgrs[0].setState(e.hgrs[0]),this._hgrs[1].setState(e.hgrs[1]),this._refresh()}mono(e){e?this.screen.classList.add("mono"):this.screen.classList.remove("mono"),this.monoMode=e,this._refresh()}scanlines(e){const t=this.screen.parentElement;t&&(e?t.classList.add("scanlines"):t.classList.remove("scanlines"))}getText(){return this._grs[this.pageMode-1].getText()}}var it=n(7911);const nt=[255,255,255],rt=[0,0,0],ot={top:193,bottom:-1,left:561,right:-1};class at{constructor(e,t,s,i){this.vm=e,this.page=t,this.charset=s,this.e=i,this._buffer=[],this._refreshing=!1,this._blink=!1,this.dirty=Object.assign({},ot),this.imageData=this.vm.context.createImageData(560,192),this.imageData.data.fill(255),this._buffer[0]=Ue(4),this._buffer[1]=Ue(4),this.vm.setLoresPage(t,this)}_drawPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=i,e[t+1]=e[t+5]=n,e[t+2]=e[t+6]=r}_drawHalfPixel(e,t,s){const i=s[0],n=s[1],r=s[2];e[t+0]=i,e[t+1]=n,e[t+2]=r}_checkInverse(e){let t=!1;return this.e?this.vm._80colMode||this.vm.altCharMode||(t=64==(192&e)&&this._blink):t=!(128&e||64&e&&this._blink),t}bank0(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,0),write:(e,t,s)=>this._write(e,t,s,0)}}bank1(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,1),write:(e,t,s)=>this._write(e,t,s,1)}}_start(){return 4*this.page}_end(){return 4*this.page+3}_read(e,t,s){const i=1023&(e<<8|t);return this._buffer[s][i]}_write(e,t,s,i){const n=1023&(e<<8|t);let r,o;if(this._buffer[i][n]===s&&!this._refreshing)return;this._buffer[i][n]=s;const a=n%128%40,l=t-a,h=24&l|(3&e)<<1|l>>7,c=this.imageData.data;if(h<24&&a<40){let e=h<<3;e<this.dirty.top&&(this.dirty.top=e),e+=8,e>this.dirty.bottom&&(this.dirty.bottom=e);let t=14*a;if(t<this.dirty.left&&(this.dirty.left=t),t+=14,t>this.dirty.right&&(this.dirty.right=t),this.vm.textMode||this.vm.hiresMode||this.vm.mixedMode&&h>19){if(this.vm._80colMode){const e=this._checkInverse(s);r=e?rt:nt,o=e?nt:rt,this.vm.altCharMode||(s=s>=64&&s<128?s-64:s);let t=4*(14*a+7*(i?0:1)+560*h*8);for(let e=0;e<8;e++){let i=this.charset[8*s+e];for(let e=0;e<7;e++){const e=1&i?o:r;this._drawHalfPixel(c,t,e),i>>=1,t+=4}t+=2212}}else if(0===i){s=this._buffer[0][n];const e=this._checkInverse(s);r=e?rt:nt,o=e?nt:rt,this.vm.altCharMode||(s=s>=64&&s<128?s-64:s);let t=4*(14*a+560*h*8);if(this.e)for(let e=0;e<8;e++){let i=this.charset[8*s+e];for(let e=0;e<7;e++){const e=1&i?o:r;this._drawPixel(c,t,e),i>>=1,t+=8}t+=2184}else for(let e=0;e<8;e++){let i=this.charset[8*s+e]<<1;for(let e=0;e<7;e++){const e=128&i?r:o;this._drawPixel(c,t,e),i<<=1,t+=8}t+=2184}}}else if(this.vm._80colMode&&!this.vm.an3State){let e=4*(14*a+7*(i?0:1)+560*h*8);for(let t=0;t<8;t++){let i=t<4?15&s:s>>4;i|=i<<4,i|=i<<8,1&a&&(i>>=2);for(let t=0;t<7;t++){const t=1&i?nt:rt;this._drawHalfPixel(c,e,t),i>>=1,e+=4}e+=2212}}else if(0===i){let e=4*(14*a+560*h*8);for(let t=0;t<8;t++){let i=t<4?15&s:s>>4;i|=i<<4,i|=i<<8,1&a&&(i>>=2);for(let t=0;t<14;t++){const t=1&i?nt:rt;this._drawHalfPixel(c,e,t),i>>=1,e+=4}e+=2184}}}}refresh(){let e=1024*this.page;this._refreshing=!0;for(let t=0;t<1024;t++,e++)this._write(e>>8,255&e,this._buffer[0][t],0),this.vm._80colMode&&this._write(e>>8,255&e,this._buffer[1][t],1);this._refreshing=!1}blink(){let e=1024*this.page;this._refreshing=!0,this._blink=!this._blink;for(let t=0;t<1024;t++,e++)64==(192&this._buffer[0][t])&&this._write(e>>8,255&e,this._buffer[0][t],0);this._refreshing=!1}start(){return setInterval((()=>this.blink()),267),this._start()}end(){return this._end()}read(e,t){return this._read(e,t,0)}write(e,t,s){return this._write(e,t,s,0)}getState(){return{buffer:[new Uint8Array(this._buffer[0]),new Uint8Array(this._buffer[1])]}}setState(e){this._buffer[0]=new Uint8Array(e.buffer[0]),this._buffer[1]=new Uint8Array(e.buffer[1]),this.refresh()}rowToBase(e){const t=e>>3&3;return(e>>1&3)<<8|(1&e)<<7|t<<5|t<<3}mapCharCode(e){return(e&=127)<32&&(e+=64),!this.e&&e>=96&&(e-=64),e}getText(){let e,t,s,i,n,r="";for(s=0;s<24;s++){if(n=this.rowToBase(s),e="",this.e&&this.vm._80colMode)for(i=0;i<80;i++)t=this.mapCharCode(this._buffer[1-i%2][n+Math.floor(i/2)]),e+=String.fromCharCode(t);else for(i=0;i<40;i++)t=this.mapCharCode(this._buffer[0][n+i]),e+=String.fromCharCode(t);e=e.trimRight(),r+=e+"\n"}return r}}const lt=(e,t,s)=>{const i=s[0],n=s[1],r=s[2];e[t+0]=e[t+4]=i,e[t+1]=e[t+5]=n,e[t+2]=e[t+6]=r},ht=(e,t,s)=>{const i=s[0],n=s[1],r=s[2];e[t+0]=i,e[t+1]=n,e[t+2]=r};class ct{constructor(e,t){this.vm=e,this.page=t,this.dirty=Object.assign({},ot),this._buffer=[],this._refreshing=!1,this.imageData=this.vm.context.createImageData(560,192),this.imageData.data.fill(255),this._buffer[0]=Ue(32),this._buffer[1]=Ue(32),this.vm.setHiresPage(t,this)}bank0(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,0),write:(e,t,s)=>this._write(e,t,s,0)}}bank1(){return{start:()=>this._start(),end:()=>this._end(),read:(e,t)=>this._read(e,t,1),write:(e,t,s)=>this._write(e,t,s,1)}}_start(){return 32*this.page}_end(){return 32*this.page+31}_read(e,t,s){const i=8191&(e<<8|t);return this._buffer[s][i]}_write(e,t,s,i){const n=e<<8|t,r=8191&n;if(this._buffer[i][r]===s&&!this._refreshing)return;this._buffer[i][r]=s;const o=r%128%40,a=t-o,l=24&a|(3&e)<<1|a>>7,h=r>>10,c=this.imageData.data;if(l<24&&o<40&&this.vm.hiresMode){let e=l<<3|h;e<this.dirty.top&&(this.dirty.top=e),e+=1,e>this.dirty.bottom&&(this.dirty.bottom=e);let t=14*o-2;t<this.dirty.left&&(this.dirty.left=t),t+=14,t>this.dirty.right&&(this.dirty.right=t);const a=l<<3|h;if(this.vm.doubleHiresMode){let e=4*(14*o+(i?0:7))+280*a*4*2,t=s;for(let s=0;s<7;s++,e+=4)ht(c,e,1&t?nt:rt),t>>=1}else if(0===i){const e=128&s,t=e&&39===o;let l=14*o*4+560*a*4;if(e){const e=this._buffer[i][r-1]||0;ht(c,l,64&e?nt:rt),l+=4}let h=s;for(let e=0;e<7;e++,l+=8){(t&&6===e?ht:lt)(c,l,1&h?nt:rt),h>>=1}if(!this._refreshing){this._refreshing=!0;const e=n+1;this._write(e>>8,255&e,this._buffer[0][8191&e],0),this._refreshing=!1}}}}refresh(){let e=8192*this.page;this._refreshing=!0;for(let t=0;t<8192;t++,e++){const s=e>>8,i=255&e;this._write(s,i,this._buffer[0][t],0),this.vm._80colMode&&this._write(s,i,this._buffer[1][t],1)}this._refreshing=!1}start(){return this._start()}end(){return this._end()}read(e,t){return this._read(e,t,0)}write(e,t,s){return this._write(e,t,s,0)}getState(){return{buffer:[new Uint8Array(this._buffer[0]),new Uint8Array(this._buffer[1])]}}setState(e){this._buffer[0]=new Uint8Array(e.buffer[0]),this._buffer[1]=new Uint8Array(e.buffer[1]),this.refresh()}}class dt{constructor(e,t){this.screen=e,this.e=t,this._grs=[],this._hgrs=[],this._scanlines=!1,this._refreshFlag=!0,this.flag=0,this.monoMode=!1,this._canvas=document.createElement("canvas");const s=this._canvas.getContext("2d");if(!s)throw new Error("no 2d context");const{width:i,height:n}=it.screenEmu.C.NTSC_DETAILS.imageSize;this._canvas.width=i,this._canvas.height=n,this.context=s,this._sv=new it.screenEmu.ScreenView(this.screen),this.ready=this.init()}init(){return function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){yield this._sv.initOpenGL(),this._displayConfig=this.defaultMonitor(),this._sv.displayConfiguration=this._displayConfig}))}defaultMonitor(){const e=new it.screenEmu.DisplayConfiguration;return e.displayResolution=new it.screenEmu.Size(this.screen.width,this.screen.height),e.displayScanlineLevel=.5,e.videoWhiteOnly=!0,e.videoSaturation=.8,e.videoSize=new it.screenEmu.Size(1.25,1.15),e.videoCenter=new it.screenEmu.Point(.01,.02),e}monitorII(){const e=new it.screenEmu.DisplayConfiguration;return e.displayResolution=new it.screenEmu.Size(this.screen.width,this.screen.height),e.videoDecoder="CANVAS_MONOCHROME",e.videoBrightness=.15,e.videoContrast=.8,e.videoSaturation=1.45,e.videoHue=.27,e.videoCenter=new it.screenEmu.Point(.01,.02),e.videoSize=new it.screenEmu.Size(1.25,1.15),e.videoBandwidth=9e6,e.displayBarrel=.1,e.displayScanlineLevel=.5,e.displayCenterLighting=.5,e.displayLuminanceGain=1.5,e}_refresh(){this.doubleHiresMode=!this.an3State&&this.hiresMode&&this._80colMode,this._refreshFlag=!0,this._displayConfig&&(this._displayConfig.videoWhiteOnly=this.textMode||this.monoMode,this._displayConfig.displayScanlineLevel=this._scanlines?.5:0,this._sv.displayConfiguration=this._displayConfig)}refresh(){this._refresh()}reset(){this.textMode=!0,this.mixedMode=!1,this.hiresMode=!0,this.pageMode=1,this._80colMode=!1,this.altCharMode=!1,this.an3State=!0,this._refresh()}setLoresPage(e,t){this._grs[e-1]=t}setHiresPage(e,t){this._hgrs[e-1]=t}getLoresPage(e){return this._grs[e-1]}getHiresPage(e){return this._hgrs[e-1]}text(e){const t=this.textMode;this.textMode=e,t!==e&&this._refresh()}_80col(e){if(!this.e)return;const t=this._80colMode;this._80colMode=e,t!==e&&this._refresh()}altChar(e){if(!this.e)return;const t=this.altCharMode;this.altCharMode=e,t!==e&&this._refresh()}hires(e){const t=this.hiresMode;this.hiresMode=e,t!==e&&this._refresh()}an3(e){if(!this.e)return;const t=this.an3State;this.an3State=e,t!==e&&this._refresh()}doubleHires(e){this.an3(!e)}mixed(e){const t=this.mixedMode;this.mixedMode=e,t!==e&&this._refresh()}page(e){const t=this.pageMode;this.pageMode=e,t!==e&&this._refresh()}isText(){return this.textMode}isMixed(){return this.mixedMode}isPage2(){return 2===this.pageMode}isHires(){return this.hiresMode}isDoubleHires(){return this.doubleHiresMode}is80Col(){return this._80colMode}isAltChar(){return this.altCharMode}updateImage(e,t,s,i){let n=!1;if(-1!==t.bottom||i&&-1!==i.bottom){const t=this.buildScreen(e,s),i=new it.screenEmu.ImageInfo(t);this._sv.image=i,n=!0}return this._sv.vsync(),n}buildScreen(e,t){const s=it.screenEmu.C.NTSC_DETAILS,{width:i,height:n}=s.imageSize,{x:r,y:o}=this._80colMode?s.topLeft80Col:s.topLeft;return t?(this.context.putImageData(e,r,o,0,0,560,160),this.context.putImageData(t,r,o,0,160,560,32)):this.context.putImageData(e,r,o),this.context.getImageData(0,0,i,n)}blit(e){let t=!1;const s=this._hgrs[this.pageMode-1],i=this._grs[this.pageMode-1];if(this._refreshFlag){const{width:e,height:t}=it.screenEmu.C.NTSC_DETAILS.imageSize;this.context.clearRect(0,0,e,t),s.refresh(),i.refresh(),this._refreshFlag=!1}return t=e?this.updateImage(e,{top:0,left:0,right:560,bottom:192}):this.hiresMode&&!this.textMode?this.updateImage(s.imageData,s.dirty,this.mixedMode?i.imageData:null,this.mixedMode?i.dirty:null):this.updateImage(i.imageData,i.dirty),s.dirty=Object.assign({},ot),i.dirty=Object.assign({},ot),t}getState(){return{grs:[this._grs[0].getState(),this._grs[1].getState()],hgrs:[this._hgrs[0].getState(),this._hgrs[1].getState()],textMode:this.textMode,mixedMode:this.mixedMode,hiresMode:this.hiresMode,pageMode:this.pageMode,_80colMode:this._80colMode,altCharMode:this.altCharMode,an3State:this.an3State,flag:0}}setState(e){this.textMode=e.textMode,this.mixedMode=e.mixedMode,this.hiresMode=e.hiresMode,this.pageMode=e.pageMode,this._80colMode=e._80colMode,this.altCharMode=e.altCharMode,this.an3State=e.an3State,this._grs[0].setState(e.grs[0]),this._grs[1].setState(e.grs[1]),this._hgrs[0].setState(e.hgrs[0]),this._hgrs[1].setState(e.hgrs[1]),this._refresh()}mono(e){this.monoMode=e,this._displayConfig=e?this.monitorII():this.defaultMonitor(),this._refresh()}scanlines(e){this._scanlines=e,this._refresh()}getText(){return this._grs[this.pageMode-1].getText()}}const ut="6502",At="rockwell65c02",mt="wdc65c02",pt=[At,mt],gt={accumulator:1,implied:1,immediate:2,absolute:3,zeroPage:2,relative:2,absoluteX:3,absoluteY:3,zeroPageX:2,zeroPageY:2,absoluteIndirect:3,zeroPageXIndirect:2,zeroPageIndirectY:2,zeroPageIndirect:2,absoluteXIndirect:3,zeroPage_relative:3},ft=128,_t=64,bt=16,Ct={read:function(){return 0},write:function(){}};class yt{constructor({flavor:e}={}){this.pc=0,this.sr=32,this.ar=0,this.xr=0,this.yr=0,this.sp=255,this.addr=0,this.memPages=new Array(256),this.resetHandlers=[],this.cycles=0,this.sync=!1,this.wait=!1,this.stop=!1,this.implied=()=>{this.readByte(this.pc)},this.readImmediate=()=>this.readBytePC(),this.readAbsolute=()=>this.readByte(this.readWordPC()),this.readZeroPage=()=>this.readByte(this.readBytePC()),this.readAbsoluteX=()=>{const e=this.readWordPC(),t=this.addr,s=e+this.xr&65535;return this.workCycleIndexedRead(t,e,s),this.readByte(s)},this.readAbsoluteY=()=>{const e=this.readWordPC(),t=this.addr,s=e+this.yr&65535;return this.workCycleIndexedRead(t,e,s),this.readByte(s)},this.readZeroPageX=()=>{const e=this.readBytePC();return this.readByte(e),this.readByte(e+this.xr&255)},this.readZeroPageY=()=>{const e=this.readBytePC();return this.readByte(e),this.readByte(e+this.yr&255)},this.readZeroPageXIndirect=()=>{const e=this.readBytePC();this.readByte(e);const t=this.readZPWord(e+this.xr&255);return this.readByte(t)},this.readZeroPageIndirectY=()=>{const e=this.readBytePC(),t=this.addr,s=this.readZPWord(e),i=s+this.yr&65535;return this.workCycleIndexedRead(t,s,i),this.readByte(i)},this.readZeroPageIndirect=()=>this.readByte(this.readZPWord(this.readBytePC())),this.writeAbsolute=e=>{this.writeByte(this.readWordPC(),e)},this.writeZeroPage=e=>{this.writeByte(this.readBytePC(),e)},this.writeAbsoluteX=e=>{const t=this.readWordPC(),s=this.addr,i=t+this.xr&65535;this.workCycleIndexedWrite(s,t,i),this.writeByte(i,e)},this.writeAbsoluteY=e=>{const t=this.readWordPC(),s=this.addr,i=t+this.yr&65535;this.workCycleIndexedWrite(s,t,i),this.writeByte(i,e)},this.writeZeroPageX=e=>{const t=this.readBytePC();this.readByte(t),this.writeByte(t+this.xr&255,e)},this.writeZeroPageY=e=>{const t=this.readBytePC();this.readByte(t),this.writeByte(t+this.yr&255,e)},this.writeZeroPageXIndirect=e=>{const t=this.readBytePC();this.readByte(t);const s=this.readZPWord(t+this.xr&255);this.writeByte(s,e)},this.writeZeroPageIndirectY=e=>{const t=this.readBytePC(),s=this.addr,i=this.readZPWord(t),n=i+this.yr&65535;this.workCycleIndexedWrite(s,i,n),this.writeByte(n,e)},this.writeZeroPageIndirect=e=>{this.writeByte(this.readZPWord(this.readBytePC()),e)},this.readAddrZeroPage=()=>this.readBytePC(),this.readAddrZeroPageX=()=>{const e=this.readBytePC();return this.readByte(e),e+this.xr&255},this.readAddrAbsolute=()=>this.readWordPC(),this.readAddrAbsoluteIndirectBug=()=>{const e=this.readWordPC(),t=65280&e,s=255&e,i=this.readByte(e);return this.readByte(t|s+1&255)<<8|i},this.readAddrAbsoluteIndirect=()=>{const e=this.readWord(this.readWordPC());return this.readByte(this.addr),e},this.readAddrAbsoluteX=e=>{let t=this.readWordPC();const s=65280&t;if(t=t+this.xr&65535,this.is65C02)((null==e?void 0:e.inc)||s!==(65280&t))&&this.readByte(this.addr);else{const e=255&t;this.readByte(s|e)}return t},this.readAddrAbsoluteY=()=>{let e=this.readWordPC();const t=65280&e;e=e+this.yr&65535;const s=255&e;return this.readByte(t|s),e},this.readAddrZeroPageXIndirect=()=>{const e=this.readBytePC();return this.readByte(e),this.readZPWord(e+this.xr&255)},this.readAddrZeroPageIndirectY=()=>{const e=this.readBytePC(),t=this.readZPWord(e),s=t+this.yr&65535,i=65280&t,n=255&s;return this.readByte(i|n),s},this.readAddrAbsoluteXIndirect=()=>{const e=this.readBytePC(),t=this.addr,s=(this.readBytePC()<<8|e)+this.xr&65535;return this.readByte(t),this.readWord(s)},this.readNop=()=>{this.readWordPC(),this.readByte(this.addr)},this.readNopImplied=()=>{},this.brk=e=>{e(),this.pushWord(this.pc),this.pushByte(this.sr|bt),this.is65C02&&this.setFlag(8,!1),this.setFlag(4,!0),this.pc=this.readWord(65534)},this.stp=()=>{this.stop=!0,this.readByte(this.pc),this.readByte(this.pc)},this.wai=()=>{this.wait=!0,this.readByte(this.pc),this.readByte(this.pc)},this.lda=e=>{this.ar=this.testNZ(e())},this.ldx=e=>{this.xr=this.testNZ(e())},this.ldy=e=>{this.yr=this.testNZ(e())},this.sta=e=>{e(this.ar)},this.stx=e=>{e(this.xr)},this.sty=e=>{e(this.yr)},this.stz=e=>{e(0)},this.adc=e=>{this.ar=this.add(this.ar,e(),!1)},this.sbc=e=>{this.ar=this.add(this.ar,255^e(),!0)},this.incA=()=>{this.readByte(this.pc),this.ar=this.increment(this.ar)},this.inc=e=>{const t=e({inc:!0}),s=this.readByte(t);this.workCycle(t,s);const i=this.increment(s);this.writeByte(t,i)},this.inx=()=>{this.readByte(this.pc),this.xr=this.increment(this.xr)},this.iny=()=>{this.readByte(this.pc),this.yr=this.increment(this.yr)},this.decA=()=>{this.readByte(this.pc),this.ar=this.decrement(this.ar)},this.dec=e=>{const t=e({inc:!0}),s=this.readByte(t);this.workCycle(t,s);const i=this.decrement(s);this.writeByte(t,i)},this.dex=()=>{this.readByte(this.pc),this.xr=this.decrement(this.xr)},this.dey=()=>{this.readByte(this.pc),this.yr=this.decrement(this.yr)},this.shiftLeft=e=>(this.setFlag(1,!!(128&e)),this.testNZ(e<<1&255)),this.aslA=()=>{this.readByte(this.pc),this.ar=this.shiftLeft(this.ar)},this.asl=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.shiftLeft(s);this.writeByte(t,i)},this.shiftRight=e=>(this.setFlag(1,!!(1&e)),this.testNZ(e>>1)),this.lsrA=()=>{this.readByte(this.pc),this.ar=this.shiftRight(this.ar)},this.lsr=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.shiftRight(s);this.writeByte(t,i)},this.rotateLeft=e=>{const t=1&this.sr;return this.setFlag(1,!!(128&e)),this.testNZ(255&(e<<1|(t?1:0)))},this.rolA=()=>{this.readByte(this.pc),this.ar=this.rotateLeft(this.ar)},this.rol=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.rotateLeft(s);this.writeByte(t,i)},this.rorA=()=>{this.readByte(this.pc),this.ar=this.rotateRight(this.ar)},this.ror=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.rotateRight(s);this.writeByte(t,i)},this.and=e=>{this.ar=this.testNZ(this.ar&e())},this.ora=e=>{this.ar=this.testNZ(this.ar|e())},this.eor=e=>{this.ar=this.testNZ(this.ar^e())},this.rmb=e=>{const t=1<<e^255,s=this.readBytePC();let i=this.readByte(s);this.readByte(s),i&=t,this.writeByte(s,i)},this.smb=e=>{const t=1<<e,s=this.readBytePC();let i=this.readByte(s);this.readByte(s),i|=t,this.writeByte(s,i)},this.trb=e=>{const t=e(),s=this.readByte(t);this.testZ(s&this.ar),this.readByte(t),this.writeByte(t,s&~this.ar)},this.tsb=e=>{const t=e(),s=this.readByte(t);this.testZ(s&this.ar),this.readByte(t),this.writeByte(t,s|this.ar)},this.bit=e=>{const t=e();this.setFlag(2,0==(t&this.ar)),this.setFlag(ft,!!(128&t)),this.setFlag(_t,!!(64&t))},this.bitI=e=>{const t=e();this.setFlag(2,0==(t&this.ar))},this.cmp=e=>{this.compare(this.ar,e())},this.cpx=e=>{this.compare(this.xr,e())},this.cpy=e=>{this.compare(this.yr,e())},this.brs=e=>{const t=this.readBytePC();if(0!=(e&this.sr)){this.readByte(this.pc);const e=65280&this.pc;this.pc+=t>127?t-256:t,this.pc&=65535;const s=65280&this.pc,i=255&this.pc;s!==e&&this.readByte(e|i)}},this.brc=e=>{const t=this.readBytePC();if(0==(e&this.sr)){this.readByte(this.pc);const e=65280&this.pc;this.pc+=t>127?t-256:t,this.pc&=65535;const s=65280&this.pc,i=255&this.pc;s!==e&&this.readByte(e|i)}},this.bbr=e=>{const t=this.readBytePC(),s=this.readByte(t);this.writeByte(t,s);const i=this.readBytePC(),n=65280&this.pc;let r=this.pc+(i>127?i-256:i);r&=65535;const o=255&r;this.readByte(n|o),0==(1<<e&s)&&(this.pc=r)},this.bbs=e=>{const t=this.readBytePC(),s=this.readByte(t);this.writeByte(t,s);const i=this.readBytePC(),n=65280&this.pc;let r=this.pc+(i>127?i-256:i);r&=65535;const o=255&r;this.readByte(n|o),0!=(1<<e&s)&&(this.pc=r)},this.tax=()=>{this.readByte(this.pc),this.testNZ(this.xr=this.ar)},this.txa=()=>{this.readByte(this.pc),this.testNZ(this.ar=this.xr)},this.tay=()=>{this.readByte(this.pc),this.testNZ(this.yr=this.ar)},this.tya=()=>{this.readByte(this.pc),this.testNZ(this.ar=this.yr)},this.tsx=()=>{this.readByte(this.pc),this.testNZ(this.xr=this.sp)},this.txs=()=>{this.readByte(this.pc),this.sp=this.xr},this.pha=()=>{this.readByte(this.pc),this.pushByte(this.ar)},this.pla=()=>{this.readByte(this.pc),this.readByte(256|this.sp),this.testNZ(this.ar=this.pullByte())},this.phx=()=>{this.readByte(this.pc),this.pushByte(this.xr)},this.plx=()=>{this.readByte(this.pc),this.readByte(256|this.sp),this.testNZ(this.xr=this.pullByte())},this.phy=()=>{this.readByte(this.pc),this.pushByte(this.yr)},this.ply=()=>{this.readByte(this.pc),this.readByte(256|this.sp),this.testNZ(this.yr=this.pullByte())},this.php=()=>{this.readByte(this.pc),this.pushByte(this.sr|bt)},this.plp=()=>{this.readByte(this.pc),this.readByte(256|this.sp),this.sr=-17&this.pullByte()|32},this.jmp=e=>{this.pc=e()},this.jsr=()=>{const e=this.readBytePC();this.readByte(256|this.sp),this.pushWord(this.pc);const t=this.readBytePC();this.pc=65535&(t<<8|e)},this.rts=()=>{this.readByte(this.pc),this.readByte(256|this.sp);const e=this.pullWordRaw();this.readByte(e),this.pc=e+1&65535},this.rti=()=>{this.readByte(this.pc),this.readByte(256|this.sp),this.sr=-17&this.pullByte()|32,this.pc=this.pullWordRaw()},this.set=e=>{this.readByte(this.pc),this.sr|=e},this.clr=e=>{this.readByte(this.pc),this.sr&=~e},this.nop=e=>{e()},this.aso=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.shiftLeft(s);this.writeByte(t,i),this.ar|=i,this.testNZ(this.ar)},this.rla=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.rotateLeft(s);this.writeByte(t,i),this.ar&=i,this.testNZ(this.ar)},this.lse=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.shiftRight(s);this.writeByte(t,i),this.ar^=i,this.testNZ(this.ar)},this.rra=e=>{const t=e(),s=this.readByte(t);this.workCycle(t,s);const i=this.rotateRight(s);this.writeByte(t,i),this.ar=this.add(this.ar,i,!1)},this.axs=e=>{e(this.ar&this.xr)},this.lax=e=>{const t=e();this.ar=t,this.xr=t,this.testNZ(t)},this.dcm=e=>{const t=e({inc:!0}),s=this.readByte(t);this.workCycle(t,s);const i=this.decrement(s);this.writeByte(t,i),this.compare(this.ar,i)},this.ins=e=>{const t=e({inc:!0}),s=this.readByte(t);this.workCycle(t,s);const i=this.increment(s);this.writeByte(t,i),this.ar=this.add(this.ar,255^i,!0)},this.alr=e=>{const t=e()&this.ar;this.ar=this.shiftRight(t)},this.arr=e=>{const t=e()&this.ar,s=t>>4,i=15&t,n=t>>7,r=t>>6&1;this.ar=this.rotateRight(t);let o=!!n;const a=!!(n^r);8&this.sr&&(i+(1&i)>5&&(this.ar=240&this.ar|this.ar+6&15),s+(1&s)>5&&(o=!0,this.ar=this.ar+96&255)),this.setFlag(_t,a),this.setFlag(1,o)},this.xaa=e=>{const t=e();this.ar=238&this.xr|this.xr&this.ar&17,this.ar=this.testNZ(this.ar&t)},this.oal=e=>{this.ar|=238;const t=this.testNZ(this.ar&e());this.ar=t,this.xr=t},this.sax=e=>{const t=this.xr&this.ar;let s=e();s^=255;const i=t+s+1;this.setFlag(1,i>255),this.xr=this.testNZ(255&i)},this.tas=e=>{const t=e();let s=this.xr&this.ar;this.sp=s,s=s&1+(t>>8)&255,this.writeByte(t,s)},this.say=e=>{const t=e(),s=t>>8,i=this.yr&s+1&255;this.writeByte(t,i)},this.xas=e=>{const t=e(),s=t>>8,i=this.xr&s+1&255;this.writeByte(t,i)},this.axa=e=>{const t=e();let s=this.xr&this.ar;s=s&1+(t>>8)&255,this.writeByte(t,s)},this.anc=e=>{this.ar=this.testNZ(this.ar&e());const t=!!(128&this.ar);this.setFlag(1,t)},this.las=e=>{const t=this.sp&e();this.sp=t,this.xr=t,this.ar=this.testNZ(t)},this.skp=e=>{e()},this.hlt=e=>{this.readByte(this.pc),this.readByte(this.pc),this.pc=65535&--this.pc,this.stop=!0},this.OPS_6502={169:{name:"LDA",fn:()=>this.lda(this.readImmediate),mode:"immediate"},165:{name:"LDA",fn:()=>this.lda(this.readZeroPage),mode:"zeroPage"},181:{name:"LDA",fn:()=>this.lda(this.readZeroPageX),mode:"zeroPageX"},173:{name:"LDA",fn:()=>this.lda(this.readAbsolute),mode:"absolute"},189:{name:"LDA",fn:()=>this.lda(this.readAbsoluteX),mode:"absoluteX"},185:{name:"LDA",fn:()=>this.lda(this.readAbsoluteY),mode:"absoluteY"},161:{name:"LDA",fn:()=>this.lda(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},177:{name:"LDA",fn:()=>this.lda(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},162:{name:"LDX",fn:()=>this.ldx(this.readImmediate),mode:"immediate"},166:{name:"LDX",fn:()=>this.ldx(this.readZeroPage),mode:"zeroPage"},182:{name:"LDX",fn:()=>this.ldx(this.readZeroPageY),mode:"zeroPageY"},174:{name:"LDX",fn:()=>this.ldx(this.readAbsolute),mode:"absolute"},190:{name:"LDX",fn:()=>this.ldx(this.readAbsoluteY),mode:"absoluteY"},160:{name:"LDY",fn:()=>this.ldy(this.readImmediate),mode:"immediate"},164:{name:"LDY",fn:()=>this.ldy(this.readZeroPage),mode:"zeroPage"},180:{name:"LDY",fn:()=>this.ldy(this.readZeroPageX),mode:"zeroPageX"},172:{name:"LDY",fn:()=>this.ldy(this.readAbsolute),mode:"absolute"},188:{name:"LDY",fn:()=>this.ldy(this.readAbsoluteX),mode:"absoluteX"},133:{name:"STA",fn:()=>this.sta(this.writeZeroPage),mode:"zeroPage"},149:{name:"STA",fn:()=>this.sta(this.writeZeroPageX),mode:"zeroPageX"},141:{name:"STA",fn:()=>this.sta(this.writeAbsolute),mode:"absolute"},157:{name:"STA",fn:()=>this.sta(this.writeAbsoluteX),mode:"absoluteX"},153:{name:"STA",fn:()=>this.sta(this.writeAbsoluteY),mode:"absoluteY"},129:{name:"STA",fn:()=>this.sta(this.writeZeroPageXIndirect),mode:"zeroPageXIndirect"},145:{name:"STA",fn:()=>this.sta(this.writeZeroPageIndirectY),mode:"zeroPageIndirectY"},134:{name:"STX",fn:()=>this.stx(this.writeZeroPage),mode:"zeroPage"},150:{name:"STX",fn:()=>this.stx(this.writeZeroPageY),mode:"zeroPageY"},142:{name:"STX",fn:()=>this.stx(this.writeAbsolute),mode:"absolute"},132:{name:"STY",fn:()=>this.sty(this.writeZeroPage),mode:"zeroPage"},148:{name:"STY",fn:()=>this.sty(this.writeZeroPageX),mode:"zeroPageX"},140:{name:"STY",fn:()=>this.sty(this.writeAbsolute),mode:"absolute"},105:{name:"ADC",fn:()=>this.adc(this.readImmediate),mode:"immediate"},101:{name:"ADC",fn:()=>this.adc(this.readZeroPage),mode:"zeroPage"},117:{name:"ADC",fn:()=>this.adc(this.readZeroPageX),mode:"zeroPageX"},109:{name:"ADC",fn:()=>this.adc(this.readAbsolute),mode:"absolute"},125:{name:"ADC",fn:()=>this.adc(this.readAbsoluteX),mode:"absoluteX"},121:{name:"ADC",fn:()=>this.adc(this.readAbsoluteY),mode:"absoluteY"},97:{name:"ADC",fn:()=>this.adc(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},113:{name:"ADC",fn:()=>this.adc(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},233:{name:"SBC",fn:()=>this.sbc(this.readImmediate),mode:"immediate"},229:{name:"SBC",fn:()=>this.sbc(this.readZeroPage),mode:"zeroPage"},245:{name:"SBC",fn:()=>this.sbc(this.readZeroPageX),mode:"zeroPageX"},237:{name:"SBC",fn:()=>this.sbc(this.readAbsolute),mode:"absolute"},253:{name:"SBC",fn:()=>this.sbc(this.readAbsoluteX),mode:"absoluteX"},249:{name:"SBC",fn:()=>this.sbc(this.readAbsoluteY),mode:"absoluteY"},225:{name:"SBC",fn:()=>this.sbc(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},241:{name:"SBC",fn:()=>this.sbc(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},230:{name:"INC",fn:()=>this.inc(this.readAddrZeroPage),mode:"zeroPage"},246:{name:"INC",fn:()=>this.inc(this.readAddrZeroPageX),mode:"zeroPageX"},238:{name:"INC",fn:()=>this.inc(this.readAddrAbsolute),mode:"absolute"},254:{name:"INC",fn:()=>this.inc(this.readAddrAbsoluteX),mode:"absoluteX"},232:{name:"INX",fn:()=>this.inx(),mode:"implied"},200:{name:"INY",fn:()=>this.iny(),mode:"implied"},198:{name:"DEC",fn:()=>this.dec(this.readAddrZeroPage),mode:"zeroPage"},214:{name:"DEC",fn:()=>this.dec(this.readAddrZeroPageX),mode:"zeroPageX"},206:{name:"DEC",fn:()=>this.dec(this.readAddrAbsolute),mode:"absolute"},222:{name:"DEC",fn:()=>this.dec(this.readAddrAbsoluteX),mode:"absoluteX"},202:{name:"DEX",fn:()=>this.dex(),mode:"implied"},136:{name:"DEY",fn:()=>this.dey(),mode:"implied"},10:{name:"ASL",fn:()=>this.aslA(),mode:"accumulator"},6:{name:"ASL",fn:()=>this.asl(this.readAddrZeroPage),mode:"zeroPage"},22:{name:"ASL",fn:()=>this.asl(this.readAddrZeroPageX),mode:"zeroPageX"},14:{name:"ASL",fn:()=>this.asl(this.readAddrAbsolute),mode:"absolute"},30:{name:"ASL",fn:()=>this.asl(this.readAddrAbsoluteX),mode:"absoluteX"},74:{name:"LSR",fn:()=>this.lsrA(),mode:"accumulator"},70:{name:"LSR",fn:()=>this.lsr(this.readAddrZeroPage),mode:"zeroPage"},86:{name:"LSR",fn:()=>this.lsr(this.readAddrZeroPageX),mode:"zeroPageX"},78:{name:"LSR",fn:()=>this.lsr(this.readAddrAbsolute),mode:"absolute"},94:{name:"LSR",fn:()=>this.lsr(this.readAddrAbsoluteX),mode:"absoluteX"},42:{name:"ROL",fn:()=>this.rolA(),mode:"accumulator"},38:{name:"ROL",fn:()=>this.rol(this.readAddrZeroPage),mode:"zeroPage"},54:{name:"ROL",fn:()=>this.rol(this.readAddrZeroPageX),mode:"zeroPageX"},46:{name:"ROL",fn:()=>this.rol(this.readAddrAbsolute),mode:"absolute"},62:{name:"ROL",fn:()=>this.rol(this.readAddrAbsoluteX),mode:"absoluteX"},106:{name:"ROR",fn:()=>this.rorA(),mode:"accumulator"},102:{name:"ROR",fn:()=>this.ror(this.readAddrZeroPage),mode:"zeroPage"},118:{name:"ROR",fn:()=>this.ror(this.readAddrZeroPageX),mode:"zeroPageX"},110:{name:"ROR",fn:()=>this.ror(this.readAddrAbsolute),mode:"absolute"},126:{name:"ROR",fn:()=>this.ror(this.readAddrAbsoluteX),mode:"absoluteX"},41:{name:"AND",fn:()=>this.and(this.readImmediate),mode:"immediate"},37:{name:"AND",fn:()=>this.and(this.readZeroPage),mode:"zeroPage"},53:{name:"AND",fn:()=>this.and(this.readZeroPageX),mode:"zeroPageX"},45:{name:"AND",fn:()=>this.and(this.readAbsolute),mode:"absolute"},61:{name:"AND",fn:()=>this.and(this.readAbsoluteX),mode:"absoluteX"},57:{name:"AND",fn:()=>this.and(this.readAbsoluteY),mode:"absoluteY"},33:{name:"AND",fn:()=>this.and(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},49:{name:"AND",fn:()=>this.and(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},9:{name:"ORA",fn:()=>this.ora(this.readImmediate),mode:"immediate"},5:{name:"ORA",fn:()=>this.ora(this.readZeroPage),mode:"zeroPage"},21:{name:"ORA",fn:()=>this.ora(this.readZeroPageX),mode:"zeroPageX"},13:{name:"ORA",fn:()=>this.ora(this.readAbsolute),mode:"absolute"},29:{name:"ORA",fn:()=>this.ora(this.readAbsoluteX),mode:"absoluteX"},25:{name:"ORA",fn:()=>this.ora(this.readAbsoluteY),mode:"absoluteY"},1:{name:"ORA",fn:()=>this.ora(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},17:{name:"ORA",fn:()=>this.ora(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},73:{name:"EOR",fn:()=>this.eor(this.readImmediate),mode:"immediate"},69:{name:"EOR",fn:()=>this.eor(this.readZeroPage),mode:"zeroPage"},85:{name:"EOR",fn:()=>this.eor(this.readZeroPageX),mode:"zeroPageX"},77:{name:"EOR",fn:()=>this.eor(this.readAbsolute),mode:"absolute"},93:{name:"EOR",fn:()=>this.eor(this.readAbsoluteX),mode:"absoluteX"},89:{name:"EOR",fn:()=>this.eor(this.readAbsoluteY),mode:"absoluteY"},65:{name:"EOR",fn:()=>this.eor(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},81:{name:"EOR",fn:()=>this.eor(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},201:{name:"CMP",fn:()=>this.cmp(this.readImmediate),mode:"immediate"},197:{name:"CMP",fn:()=>this.cmp(this.readZeroPage),mode:"zeroPage"},213:{name:"CMP",fn:()=>this.cmp(this.readZeroPageX),mode:"zeroPageX"},205:{name:"CMP",fn:()=>this.cmp(this.readAbsolute),mode:"absolute"},221:{name:"CMP",fn:()=>this.cmp(this.readAbsoluteX),mode:"absoluteX"},217:{name:"CMP",fn:()=>this.cmp(this.readAbsoluteY),mode:"absoluteY"},193:{name:"CMP",fn:()=>this.cmp(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},209:{name:"CMP",fn:()=>this.cmp(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},224:{name:"CPX",fn:()=>this.cpx(this.readImmediate),mode:"immediate"},228:{name:"CPX",fn:()=>this.cpx(this.readZeroPage),mode:"zeroPage"},236:{name:"CPX",fn:()=>this.cpx(this.readAbsolute),mode:"absolute"},192:{name:"CPY",fn:()=>this.cpy(this.readImmediate),mode:"immediate"},196:{name:"CPY",fn:()=>this.cpy(this.readZeroPage),mode:"zeroPage"},204:{name:"CPY",fn:()=>this.cpy(this.readAbsolute),mode:"absolute"},36:{name:"BIT",fn:()=>this.bit(this.readZeroPage),mode:"zeroPage"},44:{name:"BIT",fn:()=>this.bit(this.readAbsolute),mode:"absolute"},144:{name:"BCC",fn:()=>this.brc(1),mode:"relative"},176:{name:"BCS",fn:()=>this.brs(1),mode:"relative"},240:{name:"BEQ",fn:()=>this.brs(2),mode:"relative"},48:{name:"BMI",fn:()=>this.brs(ft),mode:"relative"},208:{name:"BNE",fn:()=>this.brc(2),mode:"relative"},16:{name:"BPL",fn:()=>this.brc(ft),mode:"relative"},80:{name:"BVC",fn:()=>this.brc(_t),mode:"relative"},112:{name:"BVS",fn:()=>this.brs(_t),mode:"relative"},170:{name:"TAX",fn:()=>this.tax(),mode:"implied"},138:{name:"TXA",fn:()=>this.txa(),mode:"implied"},168:{name:"TAY",fn:()=>this.tay(),mode:"implied"},152:{name:"TYA",fn:()=>this.tya(),mode:"implied"},186:{name:"TSX",fn:()=>this.tsx(),mode:"implied"},154:{name:"TXS",fn:()=>this.txs(),mode:"implied"},72:{name:"PHA",fn:()=>this.pha(),mode:"implied"},104:{name:"PLA",fn:()=>this.pla(),mode:"implied"},8:{name:"PHP",fn:()=>this.php(),mode:"implied"},40:{name:"PLP",fn:()=>this.plp(),mode:"implied"},76:{name:"JMP",fn:()=>this.jmp(this.readAddrAbsolute),mode:"absolute"},108:{name:"JMP",fn:()=>this.jmp(this.readAddrAbsoluteIndirectBug),mode:"absoluteIndirect"},32:{name:"JSR",fn:()=>this.jsr(),mode:"absolute"},96:{name:"RTS",fn:()=>this.rts(),mode:"implied"},64:{name:"RTI",fn:()=>this.rti(),mode:"implied"},56:{name:"SEC",fn:()=>this.set(1),mode:"implied"},248:{name:"SED",fn:()=>this.set(8),mode:"implied"},120:{name:"SEI",fn:()=>this.set(4),mode:"implied"},24:{name:"CLC",fn:()=>this.clr(1),mode:"implied"},216:{name:"CLD",fn:()=>this.clr(8),mode:"implied"},88:{name:"CLI",fn:()=>this.clr(4),mode:"implied"},184:{name:"CLV",fn:()=>this.clr(_t),mode:"implied"},234:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},0:{name:"BRK",fn:()=>this.brk(this.readImmediate),mode:"immediate"}},this.OPS_65C02={26:{name:"INC",fn:()=>this.incA(),mode:"accumulator"},58:{name:"DEC",fn:()=>this.decA(),mode:"accumulator"},18:{name:"ORA",fn:()=>this.ora(this.readZeroPageIndirect),mode:"zeroPageIndirect"},50:{name:"AND",fn:()=>this.and(this.readZeroPageIndirect),mode:"zeroPageIndirect"},82:{name:"EOR",fn:()=>this.eor(this.readZeroPageIndirect),mode:"zeroPageIndirect"},114:{name:"ADC",fn:()=>this.adc(this.readZeroPageIndirect),mode:"zeroPageIndirect"},146:{name:"STA",fn:()=>this.sta(this.writeZeroPageIndirect),mode:"zeroPageIndirect"},178:{name:"LDA",fn:()=>this.lda(this.readZeroPageIndirect),mode:"zeroPageIndirect"},210:{name:"CMP",fn:()=>this.cmp(this.readZeroPageIndirect),mode:"zeroPageIndirect"},242:{name:"SBC",fn:()=>this.sbc(this.readZeroPageIndirect),mode:"zeroPageIndirect"},52:{name:"BIT",fn:()=>this.bit(this.readZeroPageX),mode:"zeroPageX"},60:{name:"BIT",fn:()=>this.bit(this.readAbsoluteX),mode:"absoluteX"},137:{name:"BIT",fn:()=>this.bitI(this.readImmediate),mode:"immediate"},108:{name:"JMP",fn:()=>this.jmp(this.readAddrAbsoluteIndirect),mode:"absoluteIndirect"},124:{name:"JMP",fn:()=>this.jmp(this.readAddrAbsoluteXIndirect),mode:"absoluteXIndirect"},15:{name:"BBR0",fn:()=>this.bbr(0),mode:"zeroPage_relative"},31:{name:"BBR1",fn:()=>this.bbr(1),mode:"zeroPage_relative"},47:{name:"BBR2",fn:()=>this.bbr(2),mode:"zeroPage_relative"},63:{name:"BBR3",fn:()=>this.bbr(3),mode:"zeroPage_relative"},79:{name:"BBR4",fn:()=>this.bbr(4),mode:"zeroPage_relative"},95:{name:"BBR5",fn:()=>this.bbr(5),mode:"zeroPage_relative"},111:{name:"BBR6",fn:()=>this.bbr(6),mode:"zeroPage_relative"},127:{name:"BBR7",fn:()=>this.bbr(7),mode:"zeroPage_relative"},143:{name:"BBS0",fn:()=>this.bbs(0),mode:"zeroPage_relative"},159:{name:"BBS1",fn:()=>this.bbs(1),mode:"zeroPage_relative"},175:{name:"BBS2",fn:()=>this.bbs(2),mode:"zeroPage_relative"},191:{name:"BBS3",fn:()=>this.bbs(3),mode:"zeroPage_relative"},207:{name:"BBS4",fn:()=>this.bbs(4),mode:"zeroPage_relative"},223:{name:"BBS5",fn:()=>this.bbs(5),mode:"zeroPage_relative"},239:{name:"BBS6",fn:()=>this.bbs(6),mode:"zeroPage_relative"},255:{name:"BBS7",fn:()=>this.bbs(7),mode:"zeroPage_relative"},128:{name:"BRA",fn:()=>this.brc(0),mode:"relative"},2:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},34:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},66:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},68:{name:"NOP",fn:()=>this.nop(this.readZeroPage),mode:"immediate"},84:{name:"NOP",fn:()=>this.nop(this.readZeroPageX),mode:"immediate"},98:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},130:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},194:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},212:{name:"NOP",fn:()=>this.nop(this.readZeroPageX),mode:"immediate"},226:{name:"NOP",fn:()=>this.nop(this.readImmediate),mode:"immediate"},244:{name:"NOP",fn:()=>this.nop(this.readZeroPageX),mode:"immediate"},92:{name:"NOP",fn:()=>this.nop(this.readNop),mode:"absolute"},220:{name:"NOP",fn:()=>this.nop(this.readNop),mode:"absolute"},252:{name:"NOP",fn:()=>this.nop(this.readNop),mode:"absolute"},218:{name:"PHX",fn:()=>this.phx(),mode:"implied"},90:{name:"PHY",fn:()=>this.phy(),mode:"implied"},250:{name:"PLX",fn:()=>this.plx(),mode:"implied"},122:{name:"PLY",fn:()=>this.ply(),mode:"implied"},7:{name:"RMB0",fn:()=>this.rmb(0),mode:"zeroPage"},23:{name:"RMB1",fn:()=>this.rmb(1),mode:"zeroPage"},39:{name:"RMB2",fn:()=>this.rmb(2),mode:"zeroPage"},55:{name:"RMB3",fn:()=>this.rmb(3),mode:"zeroPage"},71:{name:"RMB4",fn:()=>this.rmb(4),mode:"zeroPage"},87:{name:"RMB5",fn:()=>this.rmb(5),mode:"zeroPage"},103:{name:"RMB6",fn:()=>this.rmb(6),mode:"zeroPage"},119:{name:"RMB7",fn:()=>this.rmb(7),mode:"zeroPage"},135:{name:"SMB0",fn:()=>this.smb(0),mode:"zeroPage"},151:{name:"SMB1",fn:()=>this.smb(1),mode:"zeroPage"},167:{name:"SMB2",fn:()=>this.smb(2),mode:"zeroPage"},183:{name:"SMB3",fn:()=>this.smb(3),mode:"zeroPage"},199:{name:"SMB4",fn:()=>this.smb(4),mode:"zeroPage"},215:{name:"SMB5",fn:()=>this.smb(5),mode:"zeroPage"},231:{name:"SMB6",fn:()=>this.smb(6),mode:"zeroPage"},247:{name:"SMB7",fn:()=>this.smb(7),mode:"zeroPage"},100:{name:"STZ",fn:()=>this.stz(this.writeZeroPage),mode:"zeroPage"},116:{name:"STZ",fn:()=>this.stz(this.writeZeroPageX),mode:"zeroPageX"},156:{name:"STZ",fn:()=>this.stz(this.writeAbsolute),mode:"absolute"},158:{name:"STZ",fn:()=>this.stz(this.writeAbsoluteX),mode:"absoluteX"},20:{name:"TRB",fn:()=>this.trb(this.readAddrZeroPage),mode:"zeroPage"},28:{name:"TRB",fn:()=>this.trb(this.readAddrAbsolute),mode:"absolute"},4:{name:"TSB",fn:()=>this.tsb(this.readAddrZeroPage),mode:"zeroPage"},12:{name:"TSB",fn:()=>this.tsb(this.readAddrAbsolute),mode:"absolute"}},this.OPS_NMOS_6502={15:{name:"ASO",fn:()=>this.aso(this.readAddrAbsolute),mode:"absolute"},31:{name:"ASO",fn:()=>this.aso(this.readAddrAbsoluteX),mode:"absoluteX"},27:{name:"ASO",fn:()=>this.aso(this.readAddrAbsoluteY),mode:"absoluteY"},7:{name:"ASO",fn:()=>this.aso(this.readAddrZeroPage),mode:"zeroPage"},23:{name:"ASO",fn:()=>this.aso(this.readAddrZeroPageX),mode:"zeroPageX"},3:{name:"ASO",fn:()=>this.aso(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},19:{name:"ASO",fn:()=>this.aso(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},47:{name:"RLA",fn:()=>this.rla(this.readAddrAbsolute),mode:"absolute"},63:{name:"RLA",fn:()=>this.rla(this.readAddrAbsoluteX),mode:"absoluteX"},59:{name:"RLA",fn:()=>this.rla(this.readAddrAbsoluteY),mode:"absoluteY"},39:{name:"RLA",fn:()=>this.rla(this.readAddrZeroPage),mode:"zeroPage"},55:{name:"RLA",fn:()=>this.rla(this.readAddrZeroPageX),mode:"zeroPageX"},35:{name:"RLA",fn:()=>this.rla(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},51:{name:"RLA",fn:()=>this.rla(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},79:{name:"LSE",fn:()=>this.lse(this.readAddrAbsolute),mode:"absolute"},95:{name:"LSE",fn:()=>this.lse(this.readAddrAbsoluteX),mode:"absoluteX"},91:{name:"LSE",fn:()=>this.lse(this.readAddrAbsoluteY),mode:"absoluteY"},71:{name:"LSE",fn:()=>this.lse(this.readAddrZeroPage),mode:"zeroPage"},87:{name:"LSE",fn:()=>this.lse(this.readAddrZeroPageX),mode:"zeroPageX"},67:{name:"LSE",fn:()=>this.lse(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},83:{name:"LSE",fn:()=>this.lse(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},111:{name:"RRA",fn:()=>this.rra(this.readAddrAbsolute),mode:"absolute"},127:{name:"RRA",fn:()=>this.rra(this.readAddrAbsoluteX),mode:"absoluteX"},123:{name:"RRA",fn:()=>this.rra(this.readAddrAbsoluteY),mode:"absoluteY"},103:{name:"RRA",fn:()=>this.rra(this.readAddrZeroPage),mode:"zeroPage"},119:{name:"RRA",fn:()=>this.rra(this.readAddrZeroPageX),mode:"zeroPageX"},99:{name:"RRA",fn:()=>this.rra(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},115:{name:"RRA",fn:()=>this.rra(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},143:{name:"AXS",fn:()=>this.axs(this.writeAbsolute),mode:"absolute"},135:{name:"AXS",fn:()=>this.axs(this.writeZeroPage),mode:"zeroPage"},151:{name:"AXS",fn:()=>this.axs(this.writeZeroPageY),mode:"zeroPageY"},131:{name:"AXS",fn:()=>this.axs(this.writeZeroPageXIndirect),mode:"zeroPageXIndirect"},175:{name:"LAX",fn:()=>this.lax(this.readAbsolute),mode:"absolute"},191:{name:"LAX",fn:()=>this.lax(this.readAbsoluteY),mode:"absoluteY"},167:{name:"LAX",fn:()=>this.lax(this.readZeroPage),mode:"zeroPage"},183:{name:"LAX",fn:()=>this.lax(this.readZeroPageY),mode:"zeroPageY"},163:{name:"LAX",fn:()=>this.lax(this.readZeroPageXIndirect),mode:"zeroPageXIndirect"},179:{name:"LAX",fn:()=>this.lax(this.readZeroPageIndirectY),mode:"zeroPageIndirectY"},207:{name:"DCM",fn:()=>this.dcm(this.readAddrAbsolute),mode:"absolute"},223:{name:"DCM",fn:()=>this.dcm(this.readAddrAbsoluteX),mode:"absoluteX"},219:{name:"DCM",fn:()=>this.dcm(this.readAddrAbsoluteY),mode:"absoluteY"},199:{name:"DCM",fn:()=>this.dcm(this.readAddrZeroPage),mode:"zeroPage"},215:{name:"DCM",fn:()=>this.dcm(this.readAddrZeroPageX),mode:"zeroPageX"},195:{name:"DCM",fn:()=>this.dcm(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},211:{name:"DCM",fn:()=>this.dcm(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},239:{name:"INS",fn:()=>this.ins(this.readAddrAbsolute),mode:"absolute"},255:{name:"INS",fn:()=>this.ins(this.readAddrAbsoluteX),mode:"absoluteX"},251:{name:"INS",fn:()=>this.ins(this.readAddrAbsoluteY),mode:"absoluteY"},231:{name:"INS",fn:()=>this.ins(this.readAddrZeroPage),mode:"zeroPage"},247:{name:"INS",fn:()=>this.ins(this.readAddrZeroPageX),mode:"zeroPageX"},227:{name:"INS",fn:()=>this.ins(this.readAddrZeroPageXIndirect),mode:"zeroPageXIndirect"},243:{name:"INS",fn:()=>this.ins(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},75:{name:"ALR",fn:()=>this.alr(this.readImmediate),mode:"immediate"},107:{name:"ARR",fn:()=>this.arr(this.readImmediate),mode:"immediate"},139:{name:"XAA",fn:()=>this.xaa(this.readImmediate),mode:"immediate"},171:{name:"OAL",fn:()=>this.oal(this.readImmediate),mode:"immediate"},203:{name:"SAX",fn:()=>this.sax(this.readImmediate),mode:"immediate"},26:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},58:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},90:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},122:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},218:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},250:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},128:{name:"SKB",fn:()=>this.skp(this.readImmediate),mode:"immediate"},130:{name:"SKB",fn:()=>this.skp(this.readImmediate),mode:"immediate"},137:{name:"SKB",fn:()=>this.skp(this.readImmediate),mode:"immediate"},194:{name:"SKB",fn:()=>this.skp(this.readImmediate),mode:"immediate"},226:{name:"SKB",fn:()=>this.skp(this.readImmediate),mode:"immediate"},4:{name:"SKB",fn:()=>this.skp(this.readZeroPage),mode:"zeroPage"},20:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},52:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},68:{name:"SKB",fn:()=>this.skp(this.readZeroPage),mode:"zeroPage"},84:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},100:{name:"SKB",fn:()=>this.skp(this.readZeroPage),mode:"zeroPage"},116:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},212:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},244:{name:"SKB",fn:()=>this.skp(this.readZeroPageX),mode:"zeroPageX"},12:{name:"SKW",fn:()=>this.skp(this.readAddrAbsolute),mode:"absolute"},28:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},60:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},92:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},124:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},220:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},252:{name:"SKW",fn:()=>this.skp(this.readAddrAbsoluteX),mode:"absoluteX"},2:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},18:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},34:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},50:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},66:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},82:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},98:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},114:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},146:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},178:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},210:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},242:{name:"HLT",fn:()=>this.hlt(this.readNopImplied),mode:"implied"},155:{name:"TAS",fn:()=>this.tas(this.readAddrAbsoluteY),mode:"absoluteY"},156:{name:"SAY",fn:()=>this.say(this.readAddrAbsoluteX),mode:"absoluteX"},158:{name:"XAS",fn:()=>this.xas(this.readAddrAbsoluteY),mode:"absoluteY"},159:{name:"AXA",fn:()=>this.axa(this.readAddrAbsoluteY),mode:"absoluteY"},147:{name:"AXA",fn:()=>this.axa(this.readAddrZeroPageIndirectY),mode:"zeroPageIndirectY"},43:{name:"ANC",fn:()=>this.anc(this.readImmediate),mode:"immediate"},11:{name:"ANC",fn:()=>this.anc(this.readImmediate),mode:"immediate"},187:{name:"LAS",fn:()=>this.las(this.readAbsoluteY),mode:"absoluteY"},235:{name:"SBC",fn:()=>this.sbc(this.readImmediate),mode:"immediate"}},this.OPS_ROCKWELL_65C02={203:{name:"NOP",fn:()=>this.nop(this.implied),mode:"implied"},219:{name:"NOP",fn:()=>this.nop(this.readZeroPageX),mode:"immediate"}},this.OPS_WDC_65C02={203:{name:"WAI",fn:()=>this.wai(),mode:"implied"},219:{name:"STP",fn:()=>this.stp(),mode:"implied"}},this.flavor=null!=e?e:ut,this.is65C02=!!e&&pt.includes(e),this.memPages.fill(Ct),this.memPages.fill(Ct);let t=Object.assign({},this.OPS_6502);switch(this.flavor){case mt:t=Object.assign(Object.assign(Object.assign({},t),this.OPS_65C02),this.OPS_WDC_65C02);break;case At:t=Object.assign(Object.assign(Object.assign({},t),this.OPS_65C02),this.OPS_ROCKWELL_65C02);break;default:t=Object.assign(Object.assign({},t),this.OPS_NMOS_6502)}this.opary=new Array(256);for(let e=0;e<256;e++)this.opary[e]=t[e]||this.unknown(e)}setFlag(e,t){this.sr=t?this.sr|e:this.sr&~e}testNZ(e){return this.sr=0===e?2|this.sr:-3&this.sr,this.sr=128&e?this.sr|ft:-129&this.sr,e}testZ(e){return this.sr=0===e?2|this.sr:-3&this.sr,e}add(e,t,s){const i=e>>7,n=t>>7,r=1&this.sr;let o,a,l,h,c;const d=s=>{h=(255&s)>>7,a=s>>8,c=!(e+t+r&255),l=i^n^h^a};return o=(15&e)+(15&t)+r,0!=(8&this.sr)?(s?(o<16&&(o=o-6&15),o+=(240&e)+(240&t),d(o),o<256&&(o+=160)):(o>9&&(o=16+(o+6&15)),o+=(240&e)+(240&t),d(o),o>=160&&(o+=96)),(e=>{if(this.is65C02){const t=255&e;h=t>>7,c=!t,"immediate"===this.op.mode?this.flavor===mt?this.readByte(s?184:127):this.readByte(s?177:89):this.readByte(this.addr)}s||(a=e>>8)})(o)):(o+=(240&e)+(240&t),d(o)),o&=255,this.setFlag(ft,!!h),this.setFlag(_t,!!l),this.setFlag(2,!!c),this.setFlag(1,!!a),o}increment(e){return this.testNZ(e+1&255)}decrement(e){return this.testNZ(e+255&255)}readBytePC(){const e=this.readByte(this.pc);return this.pc=this.pc+1&65535,e}readByte(e){this.addr=e;const t=e>>8,s=255&e,i=this.memPages[t].read(t,s);return this.cycles++,i}writeByte(e,t){this.addr=e;const s=e>>8,i=255&e;this.memPages[s].write(s,i,t),this.cycles++}readWord(e){return this.readByte(e)|this.readByte(e+1)<<8}readWordPC(){return this.readBytePC()|this.readBytePC()<<8}readZPWord(e){const t=this.readByte(255&e);return this.readByte(e+1&255)<<8|t}pushByte(e){this.writeByte(256|this.sp,e),this.sp=this.sp+255&255}pushWord(e){this.pushByte(e>>8),this.pushByte(255&e)}pullByte(){return this.sp=this.sp+1&255,this.readByte(256|this.sp)}pullWordRaw(){const e=this.pullByte();return this.pullByte()<<8|e}workCycle(e,t){this.is65C02?this.readByte(e):this.writeByte(e,t)}workCycleIndexedWrite(e,t,s){const i=65280&t;if(this.is65C02)this.readByte(e);else{const e=255&s;this.readByte(i|e)}}workCycleIndexedRead(e,t,s){const i=65280&t;if((65280&s)!==i)if(this.is65C02)this.readByte(e);else{const e=255&s;this.readByte(i|e)}}rotateRight(e){const t=1&this.sr;return this.setFlag(1,!!(1&e)),this.testNZ(e>>1|(t?128:0))}compare(e,t){const s=e+(t^=255)+1;this.setFlag(1,s>255),this.testNZ(255&s)}unknown(e){let t;if(!this.is65C02)throw new Error(`Missing ${ze(e)}`);return t={name:"NOP",fn:()=>this.nop(this.readNopImplied),mode:"implied"},t}step(e){this.sync=!0,this.op=this.opary[this.readBytePC()],this.sync=!1,this.op.fn(),null==e||e(this)}stepN(e,t){for(let s=0;s<e;s++)if(this.sync=!0,this.op=this.opary[this.readBytePC()],this.sync=!1,this.op.fn(),null==t?void 0:t(this))return}stepCycles(e){const t=this.cycles+e;for(;this.cycles<t;)this.sync=!0,this.op=this.opary[this.readBytePC()],this.sync=!1,this.op.fn()}stepCyclesDebug(e,t){const s=this.cycles+e;for(;this.cycles<s;)if(this.sync=!0,this.op=this.opary[this.readBytePC()],this.sync=!1,this.op.fn(),null==t?void 0:t(this))return}addPageHandler(e){for(let t=e.start();t<=e.end();t++)this.memPages[t]=e;void 0!==e.reset&&this.resetHandlers.push(e)}reset(){this.sr=32,this.sp=255,this.ar=0,this.yr=0,this.xr=0,this.pc=this.readWord(65532),this.wait=!1,this.stop=!1;for(let e=0;e<this.resetHandlers.length;e++)this.resetHandlers[e].reset()}irq(){0==(4&this.sr)&&(this.pushWord(this.pc),this.pushByte(-17&this.sr),this.is65C02&&this.setFlag(8,!1),this.setFlag(4,!0),this.pc=this.readWord(65534),this.wait=!1)}nmi(){this.pushWord(this.pc),this.pushByte(-17&this.sr),this.is65C02&&this.setFlag(8,!1),this.setFlag(4,!0),this.pc=this.readWord(65530),this.wait=!1}getPC(){return this.pc}setPC(e){this.pc=e}getDebugInfo(){const e=this.read(this.pc),t=this.opary[e],s=gt[t.mode],i=new Array(s);i[0]=e;for(let e=1;e<s;e++)i[e]=this.read(this.pc+e);return{pc:this.pc,ar:this.ar,xr:this.xr,yr:this.yr,sr:this.sr,sp:this.sp,cmd:i}}getSync(){return this.sync}getStop(){return this.stop}getWait(){return this.wait}getCycles(){return this.cycles}getOpInfo(e){return this.opary[e]}getState(){return{a:this.ar,x:this.xr,y:this.yr,s:this.sr,pc:this.pc,sp:this.sp,cycles:this.cycles}}setState(e){this.ar=e.a,this.xr=e.x,this.yr=e.y,this.sr=e.s,this.pc=e.pc,this.sp=e.sp,this.cycles=e.cycles}read(e,t){let s,i;return void 0!==t?(s=255&e,i=255&t):(s=e>>8&255,i=255&e),this.memPages[s].read(s,i)}write(e,t,s){let i,n,r;void 0!==s?(i=255&e,n=255&t,r=255&s):(i=e>>8&255,n=255&e,r=255&t),this.memPages[i].write(i,n,r)}}class wt{constructor(e,t){this.start_page=e,this.end_page=t,this.mem=Ue(t-e+1)}start(){return this.start_page}end(){return this.end_page}read(e,t){return this.mem[e-this.start_page<<8|t]}write(e,t,s){this.mem[e-this.start_page<<8|t]=s}getState(){return{mem:new Uint8Array(this.mem)}}setState(e){this.mem=new Uint8Array(e.mem)}}class vt{constructor(e){this.mmu=e}read(e,t){return this.mmu._access(t)||0}write(e,t,s){this.mmu._access(t,s)}}class kt{constructor(e,t){this.mmu=e,this.rom=t}_access(e,t){195===e&&(this.mmu._setIntc8rom(!0),this.mmu._updateBanks()),207===e&&255===t&&(this.mmu._setIntc8rom(!1),this.mmu._updateBanks())}read(e,t){return this._access(e,t),this.rom.read(e,t)}write(e,t,s){this._access(e,t)}}class xt{constructor(e,t,s,i,n,r,o,a){this.cpu=e,this.vm=t,this.lores1=s,this.lores2=i,this.hires1=n,this.hires2=r,this.io=o,this.rom=a,this._readPages=new Array(256),this._writePages=new Array(256),this._pages=new Array(256),this._vbEnd=0,this.switches=new vt(this),this.auxRom=new kt(this,this.rom),this.mem00_01=[new wt(0,1),new wt(0,1)],this.mem02_03=[new wt(2,3),new wt(2,3)],this.mem04_07=[this.lores1.bank0(),this.lores1.bank1()],this.mem08_0B=[this.lores2.bank0(),this.lores2.bank1()],this.mem0C_1F=[new wt(12,31),new wt(12,31)],this.mem20_3F=[this.hires1.bank0(),this.hires1.bank1()],this.mem40_5F=[this.hires2.bank0(),this.hires2.bank1()],this.mem60_BF=[new wt(96,191),new wt(96,191)],this.memC0_C0=[this.switches],this.memC1_CF=[this.io,this.auxRom],this.memD0_DF=[this.rom,new wt(208,223),new wt(208,223),new wt(208,223),new wt(208,223)],this.memE0_FF=[this.rom,new wt(224,255),new wt(224,255)];for(let e=0;e<2;e++)this._pages[e]=this.mem00_01,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=2;e<4;e++)this._pages[e]=this.mem02_03,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=4;e<8;e++)this._pages[e]=this.mem04_07,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=8;e<12;e++)this._pages[e]=this.mem08_0B,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=12;e<32;e++)this._pages[e]=this.mem0C_1F,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=32;e<64;e++)this._pages[e]=this.mem20_3F,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=64;e<96;e++)this._pages[e]=this.mem40_5F,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=96;e<192;e++)this._pages[e]=this.mem60_BF,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];{const e=192;this._pages[e]=this.memC0_C0,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0]}for(let e=193;e<208;e++)this._pages[e]=this.memC1_CF,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=208;e<224;e++)this._pages[e]=this.memD0_DF,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];for(let e=224;e<256;e++)this._pages[e]=this.memE0_FF,this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0]}_initSwitches(){this._bank1=!1,this._readbsr=!1,this._writebsr=!1,this._prewrite=!1,this._auxRamRead=!1,this._auxRamWrite=!1,this._altzp=!1,this._intcxrom=!1,this._slot3rom=!1,this._intc8rom=!1,this.__80store=!1,this._page2=!1,this._hires=!1,this._iouDisable=!0}_debug(...e){}_setIntc8rom(e){this._intc8rom=e}_updateBanks(){if(this._auxRamRead)for(let e=2;e<192;e++)this._readPages[e]=this._pages[e][1];else for(let e=2;e<192;e++)this._readPages[e]=this._pages[e][0];if(this._auxRamWrite)for(let e=2;e<192;e++)this._writePages[e]=this._pages[e][1];else for(let e=2;e<192;e++)this._writePages[e]=this._pages[e][0];if(this.__80store)if(this._page2){for(let e=4;e<8;e++)this._readPages[e]=this._pages[e][1],this._writePages[e]=this._pages[e][1];if(this._hires)for(let e=32;e<64;e++)this._readPages[e]=this._pages[e][1],this._writePages[e]=this._pages[e][1]}else{for(let e=4;e<8;e++)this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];if(this._hires)for(let e=32;e<64;e++)this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0]}if(this._intcxrom)for(let e=193;e<208;e++)this._readPages[e]=this._pages[e][1],this._writePages[e]=this._pages[e][1];else{for(let e=193;e<208;e++)this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];if(this._slot3rom||(this._readPages[195]=this._pages[195][1],this._writePages[195]=this._pages[195][1]),this._intc8rom)for(let e=200;e<208;e++)this._readPages[e]=this._pages[e][1],this._writePages[e]=this._pages[e][1]}if(this._altzp)for(let e=0;e<2;e++)this._readPages[e]=this._pages[e][1],this._writePages[e]=this._pages[e][1];else for(let e=0;e<2;e++)this._readPages[e]=this._pages[e][0],this._writePages[e]=this._pages[e][0];if(this._readbsr){if(this._bank1)for(let e=208;e<224;e++)this._readPages[e]=this._pages[e][this._altzp?2:1];else for(let e=208;e<224;e++)this._readPages[e]=this._pages[e][this._altzp?4:3];for(let e=224;e<256;e++)this._readPages[e]=this._pages[e][this._altzp?2:1]}else for(let e=208;e<256;e++)this._readPages[e]=this._pages[e][0];if(this._writebsr){if(this._bank1)for(let e=208;e<224;e++)this._writePages[e]=this._pages[e][this._altzp?2:1];else for(let e=208;e<224;e++)this._writePages[e]=this._pages[e][this._altzp?4:3];for(let e=224;e<256;e++)this._writePages[e]=this._pages[e][this._altzp?2:1]}else for(let e=208;e<256;e++)this._writePages[e]=this._pages[e][0]}_accessMMUSet(e,t){switch(e){case 0:this.__80store=!1,this._debug("80 Store Off",t),this.vm.page(this._page2?2:1);break;case 1:this.__80store=!0,this._debug("80 Store On",t);break;case 2:this._auxRamRead=!1,this._debug("Aux RAM Read Off");break;case 3:this._auxRamRead=!0,this._debug("Aux RAM Read On");break;case 4:this._auxRamWrite=!1,this._debug("Aux RAM Write Off");break;case 5:this._auxRamWrite=!0,this._debug("Aux RAM Write On");break;case 6:this._intcxrom=!1,this._slot3rom&&(this._intc8rom=!1),this._debug("Int CX ROM Off");break;case 7:this._intcxrom=!0,this._debug("Int CX ROM On");break;case 8:this._altzp=!1,this._debug("Alt ZP Off");break;case 9:this._altzp=!0,this._debug("Alt ZP On");break;case 10:this._slot3rom=!1,this._debug("Slot 3 ROM Off");break;case 11:this._slot3rom=!0,this._debug("Slot 3 ROM On");break;case 12:this._debug("80 Column Mode off"),this.vm._80col(!1);break;case 13:this._debug("80 Column Mode on"),this.vm._80col(!0);break;case 14:this._debug("Alt Char off"),this.vm.altChar(!1);break;case 15:this._debug("Alt Char on"),this.vm.altChar(!0)}this._updateBanks()}_accessStatus(e,t){let s;switch(e){case 17:this._debug("Bank 2 Read "+(this._bank1?"false":"true")),s=this._bank1?0:128;break;case 18:this._debug("Bank SW RAM Read "+(this._readbsr?"true":"false")),s=this._readbsr?128:0;break;case 19:this._debug("Aux RAM Read "+(this._auxRamRead?"true":"false")),s=this._auxRamRead?128:0;break;case 20:this._debug("Aux RAM Write "+(this._auxRamWrite?"true":"false")),s=this._auxRamWrite?128:0;break;case 21:s=this._intcxrom?128:0;break;case 22:this._debug("Alt ZP "+(this._altzp?"true":"false")),s=this._altzp?128:0;break;case 23:this._debug("Slot C3 ROM "+(this._slot3rom?"true":"false")),s=this._slot3rom?128:0;break;case 24:this._debug("80 Store "+(this.__80store?"true":"false")),s=this.__80store?128:0;break;case 25:s=this.cpu.getCycles()<this._vbEnd?128:0;break;case 26:s=this.vm.isText()?128:0;break;case 27:s=this.vm.isMixed()?128:0;break;case 28:s=this._page2?128:0;break;case 29:s=this.vm.isHires()?128:0;break;case 31:s=this.vm.is80Col()?128:0;break;case 30:s=this.vm.isAltChar()?128:0;break;default:s=this.io.ioSwitch(e,t)}return s}_accessIOUDisable(e,t){const s=void 0!==t;let i;switch(e){case 126:s?this._iouDisable=!0:i=this._iouDisable?0:128;break;case 127:s?this._iouDisable=!1:i=this.vm.isDoubleHires()?128:0;break;default:i=this.io.ioSwitch(e,t)}return i}_accessGraphics(e,t){let s=0;switch(e){case 84:this._page2=!1,this.__80store||(s=this.io.ioSwitch(e,t)),this._debug("Page 2 off");break;case 85:this._page2=!0,this.__80store||(s=this.io.ioSwitch(e,t)),this._debug("Page 2 on");break;case 86:this._hires=!1,s=this.io.ioSwitch(e,t),this._debug("Hires off");break;case 94:this._iouDisable?this.vm.doubleHires(!0):s=this.io.ioSwitch(e,t);break;case 95:this._iouDisable?this.vm.doubleHires(!1):s=this.io.ioSwitch(e,t);break;case 87:this._hires=!0,s=this.io.ioSwitch(e,t),this._debug("Hires on");break;default:s=this.io.ioSwitch(e,t)}return this._updateBanks(),s}_accessLangCard(e,t){const s=void 0===t,i=s?0:void 0,n=2&e,r=8&e;let o,a;return 1&e?(s&&this._prewrite&&(this._writebsr=!0),this._prewrite=s,n?(this._readbsr=!0,a="Read/Write"):(this._readbsr=!1,a="Write")):(this._writebsr=!1,this._prewrite=!1,n?(this._readbsr=!1,a="Off"):(this._readbsr=!0,a="Read")),r?(this._bank1=!0,o="Bank 1"):(this._bank1=!1,o="Bank 2"),this._debug(o,a),this._updateBanks(),i}_access(e,t){let s;const i=void 0!==t;switch(e>>4){case 0:i?this._accessMMUSet(e,t):s=this.io.ioSwitch(e);break;case 1:i?this.io.ioSwitch(e,t):s=this._accessStatus(e,t);break;case 5:s=this._accessGraphics(e,t);break;case 7:s=this._accessIOUDisable(e,t);break;case 8:s=this._accessLangCard(e,t);break;default:s=this.io.ioSwitch(e,t)}return s}start(){return this.lores1.start(),this.lores2.start(),0}end(){return 255}reset(){je("reset"),this._initSwitches(),this._updateBanks(),this.vm.reset(),this.io.reset()}read(e,t){return this._readPages[e].read(e,t)}write(e,t,s){this._writePages[e].write(e,t,s)}writeBank(e,t,s,i){this._pages[t][e].write(t,s,i)}resetVB(){this._vbEnd=this.cpu.getCycles()+1e3}get bank1(){return this._bank1}get readbsr(){return this._readbsr}get writebsr(){return this._writebsr}get auxread(){return this._auxRamRead}get auxwrite(){return this._auxRamWrite}get altzp(){return this._altzp}get _80store(){return this.__80store}get page2(){return this._page2}get hires(){return this._hires}get intcxrom(){return this._intcxrom}getState(){return{bank1:this._bank1,readbsr:this._readbsr,writebsr:this._writebsr,prewrite:this._prewrite,intcxrom:this._intcxrom,slot3rom:this._slot3rom,intc8rom:this._intc8rom,auxRamRead:this._auxRamRead,auxRamWrite:this._auxRamWrite,altzp:this._altzp,_80store:this.__80store,page2:this._page2,hires:this._hires,mem00_01:[this.mem00_01[0].getState(),this.mem00_01[1].getState()],mem02_03:[this.mem02_03[0].getState(),this.mem02_03[1].getState()],mem0C_1F:[this.mem0C_1F[0].getState(),this.mem0C_1F[1].getState()],mem60_BF:[this.mem60_BF[0].getState(),this.mem60_BF[1].getState()],memD0_DF:[this.memD0_DF[0].getState(),this.memD0_DF[1].getState(),this.memD0_DF[2].getState(),this.memD0_DF[3].getState(),this.memD0_DF[4].getState()],memE0_FF:[this.memE0_FF[0].getState(),this.memE0_FF[1].getState(),this.memE0_FF[2].getState()]}}setState(e){this._readbsr=e.readbsr,this._writebsr=e.writebsr,this._bank1=e.bank1,this._prewrite=e.prewrite,this._intcxrom=e.intcxrom,this._slot3rom=e.slot3rom,this._intc8rom=e.intc8rom,this._auxRamRead=e.auxRamRead,this._auxRamWrite=e.auxRamWrite,this._altzp=e.altzp,this.__80store=e._80store,this._page2=e.page2,this._hires=e.hires,this.mem00_01[0].setState(e.mem00_01[0]),this.mem00_01[1].setState(e.mem00_01[1]),this.mem02_03[0].setState(e.mem02_03[0]),this.mem02_03[1].setState(e.mem02_03[1]),this.mem0C_1F[0].setState(e.mem0C_1F[0]),this.mem0C_1F[1].setState(e.mem0C_1F[1]),this.mem60_BF[0].setState(e.mem60_BF[0]),this.mem60_BF[1].setState(e.mem60_BF[1]),this.memD0_DF[0].setState(e.memD0_DF[0]),this.memD0_DF[1].setState(e.memD0_DF[1]),this.memD0_DF[2].setState(e.memD0_DF[2]),this.memD0_DF[3].setState(e.memD0_DF[3]),this.memD0_DF[4].setState(e.memD0_DF[4]),this.memE0_FF[0].setState(e.memE0_FF[0]),this.memE0_FF[1].setState(e.memE0_FF[1]),this.memE0_FF[2].setState(e.memE0_FF[2]),this._updateBanks()}}const Et={49152:"KEYBOARD",49153:"80STOREON",49154:"RAMRDOFF",49155:"RAMRDON",49156:"RAMWROFF",49157:"RAMWRON",49158:"INTCXOFF",49159:"INTCXON",49160:"ALTZPOFF",49161:"ALTZPON",49162:"SLOT3OFF",49163:"SLOT3ON",49164:"CLR80VID",49165:"SET80VID",49166:"CLRALTCH",49167:"SETALTCH",49168:"STROBE",49169:"BSRBANK2",49170:"BSRREAD",49171:"RAMRD",49172:"RAMWRT",49173:"INTCXROM",49174:"ALTZP",49175:"SLOT3ROM",49176:"80STRORE",49177:"VERTBLANK",49178:"RDTEXT",49179:"RDMIXED",49180:"RDPAGE2",49181:"RDHIRES",49182:"RDALTCH",49183:"RD80VID",49184:"TAPEOUT",49200:"SPEAKER",49232:"CLRTEXT",49233:"SETTEXT",49234:"CLRMIXED",49235:"SETMIXED",49236:"PAGE1",49237:"PAGE2",49238:"CLRHIRS",49239:"SETHIRES",49240:"CLRAN0",49241:"SETAN0",49242:"CLRAN1",49243:"SETAN1",49244:"CLRAN2",49245:"SETAN2",49246:"CLRAN3",49247:"SETAN3",49248:"TAPEIN",49249:"PB0",49250:"PB1",49251:"PB2",49252:"PADDLE0",49253:"PADDLE1",49254:"PADDLE2",49255:"PADDLE3",49264:"PDLTRIG",49278:"SETIOUDIS",49279:"CLRIOUDIS",49280:"RDBSR2",49281:"WRBSR2",49282:"OFFBSR2",49283:"RWBSR2",49284:"RDBSR2",49285:"WRBSR2",49286:"OFFBSR2",49287:"RWBSR2",49288:"RDBSR1",49289:"WRBSR1",49290:"OFFBSR1",49291:"RWBSR1",49292:"RDBSR1",49293:"WRBSR1",49294:"OFFBSR1",49295:"RWBSR1",53248:"TOKEN.ADDRESS.TABLE",53376:"UNFNC",53426:"MATHTBL",53447:"M.NEG",53450:"M.EQU",53453:"M.REL",53456:"TOKEN.NAME.TABLE",53856:"ERROR.MESSAGES",54096:"QT.ERROR",54104:"QT.IN",54109:"QT.BREAK",54117:"GTFORPNT",54163:"BLTU",54170:"BLTU2",54230:"CHKMEM",54243:"REASON",54288:"MEMERR",54290:"ERROR",54321:"PRINT.ERROR.LINNUM",54332:"RESTART",54364:"NUMBERED.LINE",54453:"PUT.NEW.LINE",54514:"FIX.LINKS",54572:"INLIN",54574:"INLIN2",54611:"INCHR",54617:"PARSE.INPUT.LINE",54636:"PARSE",54810:"FNDLIN",54814:"FL1",54856:"RTS.1",54857:"NEW",54859:"SCRTCH",54885:"SETPTRS",54890:"CLEAR",54892:"CLEARC",54915:"STKINI",54934:"RTS.2",54935:"STXTPT",54949:"LIST",55002:"LIST.0",55038:"LIST.1",55042:"LIST.2",55076:"LIST.3",55084:"GETCHR",55092:"LIST.4",55142:"FOR",55215:"STEP",55250:"NEWSTT",55301:"TRACE.",55334:"GOEND",55336:"EXECUTE.STATEMENT",55338:"EXECUTE.STATEMENT.1",55362:"COLON.",55366:"SYNERR.1",55369:"RESTORE",55379:"SETDA",55383:"RTS.3",55384:"ISCNTC",55395:"CONTROL.C.TYPED",55406:"STOP",55408:"END",55409:"END2",55434:"END4",55446:"CONT",55471:"RTS.4",55472:"SAVE",55497:"LOAD",55536:"VARTIO",55553:"PROGIO",55570:"RUN",55585:"GOSUB",55605:"GO.TO.LINE",55614:"GOTO",55658:"RTS.5",55659:"POP",55676:"UNDERR",55681:"SYNERR.2",55684:"RETURN",55701:"DATA",55704:"ADDON",55714:"RTS.6",55715:"DATAN",55718:"REMN",55749:"PULL3",55753:"IF",55772:"REM",55777:"IF.TRUE",55788:"ONGOTO",55796:"ON.1",55800:"ON.2",55819:"RTS.7",55820:"LINGET",55878:"LET",55907:"LET2",55930:"LET.STRING",55931:"PUTSTR",56015:"PR.STRING",56021:"PRINT",56023:"PRINT2",56059:"CRDO",56064:"NEGATE",56066:"RTS.8",56067:"PR.COMMA",56086:"PR.TAB.OR.SPC",56108:"NXSPC",56111:"PR.NEXT.CHAR",56117:"DOSPC",56122:"STROUT",56125:"STRPRT",56151:"OUTSP",56154:"OUTQUES",56156:"OUTDO",56177:"INPUTERR",56187:"READERR",56191:"ERLIN",56198:"INPERR",56199:"RESPERR",56224:"GET",56242:"INPUT",56284:"NXIN",56290:"READ",56297:"INPUT.FLAG.ZERO",56299:"PROCESS.INPUT.LIST",56305:"PROCESS.INPUT.ITEM",56363:"INSTART",56425:"INPUT.DATA",56434:"INPUT.MORE",56473:"INPFIN",56480:"FINDATA",56518:"INPDONE",56543:"ERR.EXTRA",56559:"ERR.REENTRY",56569:"NEXT",56575:"NEXT.1",56578:"NEXT.2",56589:"GERR",56591:"NEXT.3",56679:"FRMNUM",56682:"CHKNUM",56684:"CHKSTR",56685:"CHKVAL",56696:"JERROR",56699:"FRMEVL",56710:"FRMEVL.1",56725:"FRMEVL.2",56781:"FRM.PRECEDENCE.TEST",56790:"NXOP",56791:"SAVOP",56804:"FRM.RELATIONAL",56822:"PREFNC",56829:"FRM.RECURSE",56845:"SNTXERR",56848:"FRM.STACK.1",56853:"FRM.STACK.2",56864:"FRM.STACK.3",56885:"NOTMATH",56888:"GOEX",56890:"FRM.PERFORM.1",56899:"FRM.PERFORM.2",56925:"EXIT",56928:"FRM.ELEMENT",56961:"STRTXT",56976:"NOT.",56984:"EQUOP",56996:"FN.",57003:"SGN.",57010:"PARCHK",57016:"CHKCLS",57019:"CHKOPN",57022:"CHKCOM",57024:"SYNCHR",57033:"SYNERR",57038:"MIN",57040:"EQUL",57045:"FRM.VARIABLE",57047:"FRM.VARIABLE.CALL",57081:"SCREEN",57100:"UNARY",57167:"OR",57173:"AND",57181:"FALSE",57184:"TRUE",57189:"RELOPS",57213:"STRCMP",57258:"STRCMP.1",57264:"NUMCMP",57269:"STRCMP.2",57281:"CMPDONE",57293:"PDL",57302:"NXDIM",57305:"DIM",57315:"PTRGET",57320:"PTRGET2",57322:"PTRGET3",57332:"BADNAM",57335:"NAMOK",57351:"PTRGET4",57469:"ISLETC",57479:"NAME.NOT.FOUND",57498:"C.ZERO",57500:"MAKE.NEW.VARIABLE",57566:"SET.VARPNT.AND.YA",57581:"GETARY",57583:"GETARY2",57598:"NEG32768",57602:"MAKINT",57608:"MKINT",57612:"AYINT",57625:"MI1",57627:"MI2",57630:"ARRAY",57750:"SUBERR",57753:"IQERR",57755:"JER",57758:"USE.OLD.ARRAY",57784:"MAKE.NEW.ARRAY",57931:"FIND.ARRAY.ELEMENT",57939:"FAE.1",57961:"GSE",57964:"GME",57967:"FAE.2",57968:"FAE.3",58028:"RTS.9",58029:"MULTIPLY.SUBSCRIPT",58038:"MULTIPLY.SUBS.1",58078:"FRE",58098:"GIVAYF",58111:"POS",58113:"SNGFLT",58118:"ERRDIR",58126:"UNDFNC",58131:"DEF",58177:"FNC.",58196:"FUNCT",58287:"FNCDATA",58309:"STR",58325:"STRINI",58333:"STRSPA",58343:"STRLIT",58349:"STRLT2",58410:"PUTNEW",58418:"JERR",58421:"PUTEMP",58450:"GETSPA",58500:"GARBAG",58504:"FIND.HIGHEST.STRING",58649:"CHECK.SIMPLE.VARIABLE",58659:"CHECK.VARIABLE",58706:"CHECK.BUMP",58717:"CHECK.EXIT",58722:"MOVE.HIGHEST.STRING.TO.TOP",58775:"CAT",58836:"MOVINS",58850:"MOVSTR",58854:"MOVSTR.1",58877:"FRESTR",58880:"FREFAC",58884:"FRETMP",58933:"FRETMS",58950:"CHRSTR",58970:"LEFTSTR",58976:"SUBSTRING.1",58983:"SUBSTRING.2",58984:"SUBSTRING.3",59014:"RIGHTSTR",59025:"MIDSTR",59065:"SUBSTRING.SETUP",59094:"LEN",59100:"GETSTR",59109:"ASC",59122:"GOIQ",59125:"GTBYTC",59128:"GETBYT",59131:"CONINT",59143:"VAL",59197:"POINT",59206:"GTNUM",59212:"COMBYTE",59218:"GETADR",59236:"PEEK",59259:"POKE",59268:"WAIT",59295:"RTS.10",59296:"FADDH",59303:"FSUB",59306:"FSUBT",59321:"FADD.1",59326:"FADD",59329:"FADDT",59342:"FADD.2",59386:"FADD.3",59433:"NORMALIZE.FAC.1",59438:"NORMALIZE.FAC.2",59470:"ZERO.FAC",59472:"STA.IN.FAC.SIGN.AND.EXP",59474:"STA.IN.FAC.SIGN",59477:"FADD.4",59508:"NORMALIZE.FAC.3",59520:"NORMALIZE.FAC.4",59533:"NORMALIZE.FAC.5",59535:"NORMALIZE.FAC.6",59549:"RTS.11",59550:"COMPLEMENT.FAC",59556:"COMPLEMENT.FAC.MANTISSA",59590:"INCREMENT.FAC.MANTISSA",59604:"RTS.12",59605:"OVERFLOW",59610:"SHIFT.RIGHT.1",59612:"SHIFT.RIGHT.2",59632:"SHIFT.RIGHT",59645:"L",59655:"SHIFT.RIGHT.4",59665:"SHIFT.RIGHT.5",59667:"CON.ONE",59672:"POLY.LOG",59693:"CON.SQR.HALF",59698:"CON.SQR.TWO",59703:"CON.NEG.HALF",59708:"CON.LOG.TWO",59713:"LOG",59720:"GIQ",59723:"LOG.2",59775:"FMULT",59778:"FMULTT",59824:"MULTIPLY.1",59829:"MULTIPLY.2",59874:"RTS.13",59875:"LOAD.ARG.FROM.YA",59918:"ADD.EXPONENTS",59920:"ADD.EXPONENTS.1",59947:"OUTOFRNG",59953:"ZERO",59958:"JOV",59961:"MUL10",59984:"CON.TEN",59989:"DIV10",59998:"DIV",60006:"FDIV",60009:"FDIVT",60134:"COPY.RESULT.INTO.FAC",60153:"LOAD.FAC.FROM.YA",60190:"STORE.FAC.IN.TEMP2.ROUNDED",60193:"STORE.FAC.IN.TEMP1.ROUNDED",60199:"SETFOR",60203:"STORE.FAC.AT.YX.ROUNDED",60243:"COPY.ARG.TO.FAC",60245:"MFA",60259:"COPY.FAC.TO.ARG.ROUNDED",60262:"MAF",60273:"RTS.14",60274:"ROUND.FAC",60282:"INCREMENT.MANTISSA",60290:"SIGN",60294:"SIGN1",60296:"SIGN2",60303:"RTS.15",60304:"SGN",60307:"FLOAT",60315:"FLOAT.1",60320:"FLOAT.2",60335:"ABS",60338:"FCOMP",60340:"FCOMP2",60402:"QINT",60433:"RTS.16",60434:"QINT.2",60451:"INT",60480:"QINT.3",60489:"RTS.17",60490:"FIN",60513:"FIN.1",60516:"FIN.2",60518:"FIN.3",60551:"FIN.4",60554:"FIN.5",60556:"FIN.6",60568:"FIN.10",60574:"FIN.7",60576:"FIN.8",60609:"FIN.9",60629:"ADDACC",60648:"GETEXP",60682:"CON.99999999.9",60687:"CON.999999999",60692:"CON.BILLION",60697:"INPRT",60708:"LINPRT",60718:"PRINT.FAC",60721:"GO.STROUT",60724:"FOUT",60726:"FOUT.1",60812:"FOUT.2",60951:"FOUT.3",61015:"FOUT.4",61018:"FOUT.5",61023:"FOUT.6",61028:"CON.HALF",61033:"DECTBL",61069:"SQR",61079:"FPWRT",61136:"NEGOP",61146:"RTS.18",61147:"CON.LOG.E",61152:"POLY.EXP",61193:"EXP",61276:"POLYNOMIAL.ODD",61298:"POLYNOMIAL",61302:"SERMAIN",61349:"RTS.19",61350:"CON.RND.1",61354:"CON.RND.2",61358:"RND",61415:"GO.MOVMF",61418:"COS",61425:"SIN",61475:"SIN.1",61478:"SIN.2",61498:"TAN",61538:"TAN.1",61542:"CON.PI.HALF",61547:"CON.PI.DOUB",61552:"QUARTER",61557:"POLY.SIN",61598:"ATN",61645:"RTS.20",61646:"POLY.ATN",61707:"GENERIC.CHRGET",61736:"COLD.START",61909:"CALL",61918:"IN.NUMBER",61925:"PR.NUMBER",61932:"PLOTFNS",61958:"GOERR",61961:"LINCOOR",61989:"PLOT",62002:"HLIN",62017:"VLIN",62031:"COLOR",62038:"VTAB",62050:"SPEED",62061:"TRACE",62063:"NOTRACE",62067:"NORMAL",62071:"INVERSE",62073:"N.I.",62075:"N.I.F.",62080:"FLASH",62086:"HIMEM",62102:"JMM",62105:"SETHI",62118:"LOMEM",62155:"ONERR",62185:"HANDLERR",62232:"RESUME",62254:"JSYN",62257:"DEL",62352:"GR",62361:"TEXT",62367:"STORE",62396:"RECALL",62424:"HGR2",62434:"HGR",62442:"SETHPG",62450:"HCLR",62454:"BKGND",62481:"HPOSN",62551:"HPLOT0",62565:"MOVE.LEFT.OR.RIGHT",62574:"LR.1",62577:"LR.2",62582:"LR.3",62584:"LR.4",62590:"COLOR.SHIFT",62602:"MOVE.RIGHT",62620:"LRUDX1",62621:"LRUDX2",62643:"LRUD1",62644:"LRUD2",62660:"LRUD3",62664:"LRUD4",62669:"CON.03",62675:"MOVE.UP.OR.DOWN",62721:"UD.1",62725:"MOVE.DOWN",62728:"CON.04",62768:"HLINRL",62778:"HGLIN",62844:"MOVEX",62849:"MOVEX2",62898:"MSKTBL",62905:"CON.1C",62906:"COSINE.TABLE",62923:"HFIND",62976:"RTS.22",62977:"DRAW0",62981:"DRAW1",63069:"XDRAW0",63073:"XDRAW1",63161:"HFNS",63206:"GGERR",63209:"HCOLOR",63221:"RTS.23",63222:"COLORTBL",63230:"HPLOT",63265:"ROT",63271:"SCALE",63277:"DRWPNT",63337:"DRAW",63343:"XDRAW",63349:"SHLOAD",63420:"TAPEPNT",63449:"GETARYPT",63463:"HTAB",63488:"MON.PLOT",63513:"MON.HLINE",63528:"MON.VLINE",63588:"MON.SETCOL",63601:"MON.SCRN",64286:"MON.PREAD",64313:"MON.SETTXT",64320:"MON.SETGR",64347:"MON.TABV",64600:"MON.HOME",64680:"MON.WAIT",64762:"MON.RD2BIT",64780:"MON.RDKEY",64874:"MON.GETLN",65005:"MON.COUT",65163:"MON.INPORT",65173:"MON.OUTPORT",65229:"MON.WRITE",65277:"MON.READ",65282:"MON.READ2"},St=e=>!0,Pt=e=>[e&ft?"N":"-",e&_t?"V":"-",32&e?"X":"-",e&bt?"B":"-",8&e?"D":"-",4&e?"I":"-",2&e?"Z":"-",1&e?"C":"-"].join("");class Rt{constructor(e,t){this.cpu=e,this.container=t,this.verbose=!1,this.maxTrace=256,this.trace=[],this.breakpoints=new Map,this.symbols={},this.break=()=>{this.container.stop()},this.step=()=>{this.cpu.step((()=>{const e=this.cpu.getDebugInfo();je(this.printDebugInfo(e)),this.updateTrace(e)}))},this.continue=()=>{this.container.run()},this.runAt=e=>{this.cpu.reset(),this.cpu.setPC(e)},this.isRunning=()=>this.container.isRunning(),this.setVerbose=e=>{this.verbose=e},this.setMaxTrace=e=>{this.maxTrace=e},this.getTrace=e=>this.trace.slice(e?-e:void 0).map(this.printDebugInfo).join("\n"),this.printTrace=e=>{je(this.getTrace(e))},this.getStack=e=>{const{sp:t}=this.cpu.getDebugInfo(),s=[];let i=255,n=0;e&&(t-3>=255-e?n=Math.max(255-e+1,0):(i=Math.min(t+e-4,255),n=Math.max(t-3,0)));for(let r=i;r>=n;r--){const i=r===t?"*":" ",n=`$${ze(256+r)}`,o=ze(this.cpu.read(1,r));(!e||t+e>r&&r>t-e)&&s.push(`${i} ${n} ${o}`)}return s.join("\n")},this.setBreakpoint=(e,t)=>{this.breakpoints.set(e,t||St)},this.clearBreakpoint=e=>{this.breakpoints.delete(e)},this.listBreakpoints=()=>{for(const[e,t]of this.breakpoints.entries())je(ze(e,4),t)},this.addSymbols=e=>{this.symbols=Object.assign(Object.assign({},this.symbols),e)},this.printDebugInfo=e=>{const{pc:t,cmd:s}=e,i=this.padWithSymbol(t);return[ze(t,4),"- ",i,this.dumpRegisters(e)," ",this.dumpRawOp(s)," ",this.dumpOp(t,s)].join("")},this.dumpPC=e=>{const t=this.cpu.read(e),s=this.cpu.getOpInfo(t),i=gt[s.mode];let n=ze(e,4)+"- ";n+=this.padWithSymbol(e);const r=new Array(i);for(let t=0,s=e;t<i;t++,s++)r[t]=this.cpu.read(s);return n+=this.dumpRawOp(r)+" "+this.dumpOp(e,r),n},this.dumpRegisters=e=>{void 0===e&&(e=this.cpu.getDebugInfo());const{ar:t,xr:s,yr:i,sr:n,sp:r}=e;return["A="+ze(t)," X="+ze(s)," Y="+ze(i)," P="+ze(n)," S="+ze(r)," ",Pt(n)].join("")},this.dumpPage=(e,t)=>{let s="";void 0===t&&(t=e);for(let i=e;i<=t;i++)for(let e=0;e<16;e++){s+=ze(i)+ze(e<<4)+": ";for(let t=0;t<16;t++)s+=ze(this.cpu.read(i,16*e+t))+" ";s+="        ";for(let t=0;t<16;t++){const n=127&this.cpu.read(i,16*e+t);s+=n>=32&&n<127?String.fromCharCode(n):"."}s+="\n"}return s},this.list=e=>{const t=[];for(let s=0;s<20;s++){const s=this.cpu.read(e),i=this.cpu.getOpInfo(s);t.push(this.dumpPC(e)),e+=gt[i.mode]}return t}}stepCycles(e){this.cpu.stepCyclesDebug(this.verbose?1:e,(()=>{var e;const t=this.cpu.getDebugInfo();if(null===(e=this.breakpoints.get(t.pc))||void 0===e?void 0:e(t))return je("breakpoint",this.printDebugInfo(t)),this.container.stop(),!0;this.verbose?je(this.printDebugInfo(t)):this.updateTrace(t)}))}getMemory(e,t){const s=new Uint8Array(t);for(let i=0;i<t;i++)e&=65535,s[i]=this.cpu.read(e++);return s}setMemory(e,t){for(const s of t)e&=65535,this.cpu.write(e++,s)}updateTrace(e){this.trace.push(e),this.trace.length>this.maxTrace&&this.trace.shift()}padWithSymbol(e){const t="          ",s=this.symbols[e];let i=t;return s&&(i=`${s}${t.substring(s.length)}`),i}dumpRawOp(e){const t=new Array(4);for(let s=0;s<4;s++)s<e.length?t[s]=ze(e[s]):t[s]="  ";return t.join(" ")}dumpOp(e,t){const s=this.cpu.getOpInfo(t[0]),i=t[1],n=t[2],r=n<<8|i;let o,a;const l=(e,t)=>this.symbols[e]||"$"+ze(e,t);let h=s.name+" ";switch(s.mode){case"implied":default:break;case"immediate":h+=`#${l(i)}`;break;case"absolute":h+=`${l(r,4)}`;break;case"zeroPage":h+=`${l(i)}`;break;case"relative":a=i,a>127&&(a-=256),h+=`${l(e+=a+2,4)} (${a})`;break;case"absoluteX":h+=`${l(r,4)},X`;break;case"absoluteY":h+=`${l(r,4)},Y`;break;case"zeroPageX":h+=`${l(i)},X`;break;case"zeroPageY":h+=`${l(i)},Y`;break;case"absoluteIndirect":h+=`(${l(r,4)})`;break;case"zeroPageXIndirect":h+=`(${l(i)},X)`;break;case"zeroPageIndirectY":h+=`(${l(i)},),Y`;break;case"accumulator":h+="A";break;case"zeroPageIndirect":h+=`(${l(i)})`;break;case"absoluteXIndirect":h+=`(${l(r,4)},X)`;break;case"zeroPage_relative":o=i,a=n,a>127&&(a-=256),e+=a+2,h+=`${l(o)},${l(e,4)} (${a})`}return h}}const Tt={A:0,B:1,X:2,Y:3,L1:4,R1:5,L3:6,R3:7,START:8,SELECT:9,LOGO:10,UP:11,DOWN:12,LEFT:13,RIGHT:14};let It=null;const Dt={A:0,B:1,L1:0,R1:1,START:""},Bt=[],Mt=[];function Ot(e){for(let e=0;e<16;e++)Bt[e]=void 0;const t=e||Dt;for(const e of Object.entries(t)){const t=e[0],s=e[1];let i;i="string"==typeof s?s.charCodeAt(0):-s,t in Tt?Bt[Tt[t]]=i:Bt[parseInt(t,10)]=i}}window.addEventListener("gamepadconnected",(function(e){It=e.gamepad}));class Nt{constructor(e){this.paused=!1,this.runTimer=null,this.runAnimationFrame=null,this.stats={cycles:0,frames:0,renderedFrames:0},this.ready=this.init(e)}init(e){return function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(this,void 0,void 0,(function*(){const t=n(6190)(`./${e.rom}`),s=n(2800)(`./${e.characterRom}`),i=e.gl?at:et,r=e.gl?ct:tt,o=e.gl?dt:st;this.cpu=new yt({flavor:e.enhanced?At:ut}),this.vm=new o(e.canvas,e.e);const[{default:a},{default:l}]=yield Promise.all([t,s,this.vm.ready]);this.rom=new a,this.characterRom=l,this.gr=new i(this.vm,1,this.characterRom,e.e),this.gr2=new i(this.vm,2,this.characterRom,e.e),this.hgr=new r(this.vm,1),this.hgr2=new r(this.vm,2),this.io=new Xe(this.cpu,this.vm),this.tick=e.tick,e.e?(this.mmu=new xt(this.cpu,this.vm,this.gr,this.gr2,this.hgr,this.hgr2,this.io,this.rom),this.cpu.addPageHandler(this.mmu)):(this.ram=[new wt(0,3),new wt(12,31),new wt(96,191)],this.cpu.addPageHandler(this.ram[0]),this.cpu.addPageHandler(this.gr),this.cpu.addPageHandler(this.gr2),this.cpu.addPageHandler(this.ram[1]),this.cpu.addPageHandler(this.hgr),this.cpu.addPageHandler(this.hgr2),this.cpu.addPageHandler(this.ram[2]),this.cpu.addPageHandler(this.io),this.cpu.addPageHandler(this.rom))}))}run(){if(this.paused=!1,this.runTimer||this.runAnimationFrame)return;this.theDebugger=new Rt(this.cpu,this),this.theDebugger.addSymbols(Et);let e,t=Date.now();const s=()=>{const i=this.io.getKHz();e=Date.now();const n=30*i;let r=(e-t)*i;if(t=e,r>n&&(r=n),this.theDebugger?this.theDebugger.stepCycles(r):this.cpu.stepCycles(r),this.mmu&&this.mmu.resetVB(),this.io.annunciator(0)){const e=this.io.blit();e&&(this.vm.blit(e),this.stats.renderedFrames++)}else this.vm.blit()&&this.stats.renderedFrames++;this.stats.cycles=this.cpu.getCycles(),this.stats.frames++,this.io.tick(),this.tick(),function(e){if(It=navigator.getGamepads()[0],!It)return;const t=(1.414*It.axes[0]+1)/2,s=(1.414*It.axes[1]+1)/2;e.paddle(0,t),e.paddle(1,s);for(let t=0;t<It.buttons.length;t++){const s=Bt[t];if(void 0!==s){const i=Mt[t],n=It.buttons[t];let r;r="object"==typeof n?n.pressed:1===n,r&&!i?s<=0?e.buttonDown(-s):e.keyDown(s):!r&&i&&(s<=0?e.buttonUp(-s):e.keyUp()),Mt[t]=r}}}(this.io),!this.paused&&requestAnimationFrame&&(this.runAnimationFrame=requestAnimationFrame(s))};requestAnimationFrame?this.runAnimationFrame=requestAnimationFrame(s):this.runTimer=window.setInterval(s,30)}stop(){this.paused=!0,this.runTimer&&clearInterval(this.runTimer),this.runAnimationFrame&&cancelAnimationFrame(this.runAnimationFrame),this.runTimer=null,this.runAnimationFrame=null}isRunning(){return!this.paused}getState(){var e,t;return{cpu:this.cpu.getState(),vm:this.vm.getState(),io:this.io.getState(),mmu:null===(e=this.mmu)||void 0===e?void 0:e.getState(),ram:null===(t=this.ram)||void 0===t?void 0:t.map((e=>e.getState()))}}setState(e){this.cpu.setState(e.cpu),this.vm.setState(e.vm),this.io.setState(e.io),this.mmu&&e.mmu&&this.mmu.setState(e.mmu),this.ram&&this.ram.forEach(((t,s)=>{e.ram&&t.setState(e.ram[s])}))}reset(){this.cpu.reset()}getStats(){return this.stats}getCPU(){return this.cpu}getIO(){return this.io}getMMU(){return this.mmu}getROM(){return this.rom}getVideoModes(){return this.vm}getDebugger(){return this.theDebugger}}var Lt=n(2577),Ut={};Ut.styleTagTransform=ae(),Ut.setAttributes=ie(),Ut.insert=te().bind(null,"head"),Ut.domAPI=Q(),Ut.insertStyleElement=re(),q()(Lt.Z,Ut);const Ft=Lt.Z&&Lt.Z.locals?Lt.Z.locals:void 0,jt=({apple2:e})=>{const t=xe({frames:0,renderedFrames:0,cycles:0}),s=xe(Date.now()),[i,n]=ve(0),[r,o]=ve(0),[a,l]=ve(0),[h,c]=ve(0);ke((()=>{const i=setInterval((()=>{const{cycles:i,frames:r,renderedFrames:a}=t.current,h=null==e?void 0:e.getStats(),c=Date.now(),d=c-s.current;h&&(n(Math.floor((h.cycles-i)/d)),o(Math.floor((h.frames-r)/d*1e3)),l(Math.floor((h.renderedFrames-a)/d*1e3)),t.current=Object.assign({},h),s.current=c)}),1e3);return()=>clearInterval(i)}),[e]);const d=Se((()=>{c((e=>(e+1)%3))}),[]);return A("div",{className:Ft.khz,onClick:d},0===h&&`${i} Khz`,1===h&&`${r} fps`,2===h&&`${a} rps`)};var zt=n(7922),Xt={};Xt.styleTagTransform=ae(),Xt.setAttributes=ie(),Xt.insert=te().bind(null,"head"),Xt.domAPI=Q(),Xt.insertStyleElement=re(),q()(zt.Z,Xt);const Zt=zt.Z&&zt.Z.locals?zt.Z.locals:void 0;const Gt=e=>{var{children:t,className:s}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(e,["children","className"]);return A("div",Object.assign({className:J()(s,Zt.inset)},i),t)},Ht=(e,t)=>{ke((()=>{const s=s=>{s.key===e&&(s.preventDefault(),s.stopPropagation(),t(s))};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}}),[e,t])};var Wt=n(9549),Yt={};Yt.styleTagTransform=ae(),Yt.setAttributes=ie(),Yt.insert=te().bind(null,"head"),Yt.domAPI=Q(),Yt.insertStyleElement=re(),q()(Wt.Z,Yt);const Kt=Wt.Z&&Wt.Z.locals?Wt.Z.locals:void 0;const Jt=e=>{var{active:t,icon:s,title:i,onClick:n}=e,r=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(e,["active","icon","title","onClick"]);return A("button",Object.assign({className:Kt.iconButton,onClick:n,title:i},r),A("i",{className:J()("fas",`fa-${s}`,{[Kt.active]:t})}))},Vt=void 0!==window.localStorage;class qt{constructor(){this.url=new URL(window.location.href),this.title=window.document.title}havePrefs(){return Vt}readPref(e,t=null){var s;return this.url.searchParams.has(e)?this.url.searchParams.get(e):Vt&&null!==(s=window.localStorage.getItem(e))&&void 0!==s?s:t}writePref(e,t){this.url.searchParams.has(e)&&(this.url.searchParams.set(e,t),history.replaceState(null,this.title,this.url.toString())),Vt&&window.localStorage.setItem(e,t)}}const $t="BOOLEAN_OPTION",Qt="SELECT_OPTION",es=function(e,t){var s={__c:t="__cC"+a++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var s,i;return this.getChildContext||(s=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&s.some(b)},this.sub=function(e){s.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){s.splice(s.indexOf(e),1),t&&t.call(e)}}),e.children}};return s.Provider.__=s.Consumer.contextType=s}(new class{constructor(){this.prefs=new qt,this.options={},this.handlers={},this.sections=[]}addOptions(e){const t=e.getOptions();for(const s of t){const{options:t}=s;for(const s of t){const{name:t}=s;this.handlers[t]=e,this.options[t]=s;const i=this.getOption(t);null!=i&&e.setOption(t,i)}this.sections.push(s)}}getOption(e){const t=this.options[e];if(t){const{name:e,defaultVal:s,type:i}=t,n=String(s),r=this.prefs.readPref(e,n);return i===$t?"true"===r:r}}setOption(e,t){if(e in this.options){const s=this.handlers[e],i=this.options[e];this.prefs.writePref(e,String(t)),i.type===$t?s.setOption(e,Boolean(t)):s.setOption(e,String(t))}}getOptions(){return this.options}getSections(){return this.sections}}),ts="enable_sound",ss=window.AudioContext||window.webkitAudioContext;class is{constructor(e){if(this.sound=!0,this.samples=[],this.started=!1,this.autoStart=()=>{this.audioContext&&!this.started&&(this.samples=[],this.audioContext.resume().then((()=>{this.started=!0})).catch((e=>{console.warn("audio not started",e)})))},this.start=()=>{this.audioContext&&(this.samples=[],this.audioContext.resume().catch((e=>{console.warn("audio not resumed",e)})))},this.isEnabled=()=>this.sound,this.setOption=(e,t)=>{e===ts&&(this.sound=t)},this.audioContext=new ss({sampleRate:44e3}),window.AudioWorklet){const t=this.audioContext.audioWorklet.addModule("./dist/audio_worker.bundle.js");this.ready=t.then((()=>{this.workletNode=new AudioWorkletNode(this.audioContext,"audio_worker"),e.sampleRate(this.audioContext.sampleRate,128),e.addSampleListener((e=>{this.sound&&"running"===this.audioContext.state&&this.workletNode.port.postMessage(e)})),this.workletNode.connect(this.audioContext.destination)})).catch(console.error)}else this.audioNode=this.audioContext.createScriptProcessor(1024,1,1),this.audioNode.onaudioprocess=e=>{const t=e.outputBuffer.getChannelData(0),s=this.samples.shift();let i=0,n=t.length;if(s)for(n=Math.min(s.length,n);i<n;i++)t[i]=s[i];for(;i<t.length;i++)t[i]=0},this.audioNode.connect(this.audioContext.destination),e.sampleRate(this.audioContext.sampleRate,1024),e.addSampleListener((e=>{this.sound&&"running"===this.audioContext.state&&this.samples.length<5&&this.samples.push(e)})),this.ready=Promise.resolve();window.addEventListener("keydown",this.autoStart),void 0!==window.ontouchstart&&window.addEventListener("touchstart",this.autoStart),window.addEventListener("mousedown",this.autoStart),je("Sound initialized")}getOptions(){return[{name:"Audio",options:[{name:ts,label:"Enabled",type:$t,defaultVal:!0}]}]}}const ns=({apple2:e})=>{const[t,s]=ve(!1),[i,n]=ve(),r=Pe(es);ke((()=>{if(e){const t=e.getIO(),i=new is(t);r.addOptions(i),n(i),s(i.isEnabled())}}),[e,r]);const o=Se((()=>{const e=!(null==i?void 0:i.isEnabled());r.setOption(ts,e),s(e)}),[i,r]);return A(Jt,{onClick:o,title:"Toggle Sound",disabled:!i,icon:t?"volume-up":"volume-off"})};function rs(e,t){for(var s in e)if("__source"!==s&&!(s in t))return!0;for(var i in t)if("__source"!==i&&e[i]!==t[i])return!0;return!1}function os(e){this.props=e}(os.prototype=new g).isPureReactComponent=!0,os.prototype.shouldComponentUpdate=function(e,t){return rs(this.props,e)||rs(this.state,t)};var as=t.__b;t.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),as&&as(e)},"undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref");var ls=t.__e;t.__e=function(e,t,s,i){if(e.then)for(var n,r=t;r=r.__;)if((n=r.__c)&&n.__c)return null==t.__e&&(t.__e=s.__e,t.__k=s.__k),n.__c(e,t);ls(e,t,s,i)};var hs=t.unmount;function cs(){this.__u=0,this.t=null,this.__b=null}function ds(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function us(){this.u=null,this.o=null}t.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),hs&&hs(e)},(cs.prototype=new g).__c=function(e,t){var s=t.__c,i=this;null==i.t&&(i.t=[]),i.t.push(s);var n=ds(i.__v),r=!1,o=function(){r||(r=!0,s.__R=null,n?n(a):a())};s.__R=o;var a=function(){if(!--i.__u){if(i.state.__e){var e=i.state.__e;i.__v.__k[0]=function e(t,s,i){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return e(t,s,i)})),t.__c&&t.__c.__P===s&&(t.__e&&i.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=i)),t}(e,e.__c.__P,e.__c.__O)}var t;for(i.setState({__e:i.__b=null});t=i.t.pop();)t.forceUpdate()}},l=!0===t.__h;i.__u++||l||i.setState({__e:i.__b=i.__v.__k[0]}),e.then(o,o)},cs.prototype.componentWillUnmount=function(){this.t=[]},cs.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var s=document.createElement("div"),i=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,s,i){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),t.__c.__H=null),null!=(t=function(e,t){for(var s in t)e[s]=t[s];return e}({},t)).__c&&(t.__c.__P===i&&(t.__c.__P=s),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return e(t,s,i)}))),t}(this.__b,s,i.__O=i.__P)}this.__b=null}var n=t.__e&&A(p,null,e.fallback);return n&&(n.__h=null),[A(p,null,t.__e?null:e.children),n]};var As=function(e,t,s){if(++s[1]===s[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(s=e.u;s;){for(;s.length>3;)s.pop()();if(s[1]<s[0])break;e.u=s=s[2]}};function ms(e){return this.getChildContext=function(){return e.context},e.children}function ps(e){var t=this,s=e.i;t.componentWillUnmount=function(){O(null,t.l),t.l=null,t.i=null},t.i&&t.i!==s&&t.componentWillUnmount(),e.__v?(t.l||(t.i=s,t.l={nodeType:1,parentNode:s,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,s){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),O(A(ms,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}(us.prototype=new g).__e=function(e){var t=this,s=ds(t.__v),i=t.o.get(e);return i[0]++,function(n){var r=function(){t.props.revealOrder?(i.push(n),As(t,e,i)):n()};s?s(r):r()}},us.prototype.render=function(e){this.u=null,this.o=new Map;var t=v(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var s=t.length;s--;)this.o.set(t[s],this.u=[1,0,this.u]);return e.children},us.prototype.componentDidUpdate=us.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,s){As(e,s,t)}))};var gs="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,fs=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,_s="undefined"!=typeof document,bs=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};g.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(g.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var Cs=t.event;function ys(){}function ws(){return this.cancelBubble}function vs(){return this.defaultPrevented}t.event=function(e){return Cs&&(e=Cs(e)),e.persist=ys,e.isPropagationStopped=ws,e.isDefaultPrevented=vs,e.nativeEvent=e};var ks={configurable:!0,get:function(){return this.class}},xs=t.vnode;t.vnode=function(e){var t=e.type,s=e.props,i=s;if("string"==typeof t){var n=-1===t.indexOf("-");for(var r in i={},s){var o=s[r];_s&&"children"===r&&"noscript"===t||"value"===r&&"defaultValue"in s&&null==o||("defaultValue"===r&&"value"in s&&null==s.value?r="value":"download"===r&&!0===o?o="":/ondoubleclick/i.test(r)?r="ondblclick":/^onchange(textarea|input)/i.test(r+t)&&!bs(s.type)?r="oninput":/^onfocus$/i.test(r)?r="onfocusin":/^onblur$/i.test(r)?r="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(r)?r=r.toLowerCase():n&&fs.test(r)?r=r.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===o&&(o=void 0),i[r]=o)}"select"==t&&i.multiple&&Array.isArray(i.value)&&(i.value=v(s.children).forEach((function(e){e.props.selected=-1!=i.value.indexOf(e.props.value)}))),"select"==t&&null!=i.defaultValue&&(i.value=v(s.children).forEach((function(e){e.props.selected=i.multiple?-1!=i.defaultValue.indexOf(e.props.value):i.defaultValue==e.props.value}))),e.props=i,s.class!=s.className&&(ks.enumerable="className"in s,null!=s.className&&(i.class=s.className),Object.defineProperty(i,"className",ks))}e.$$typeof=gs,xs&&xs(e)};var Es=t.__r;t.__r=function(e){Es&&Es(e),e.__c};var Ss=n(3455),Ps={};Ps.styleTagTransform=ae(),Ps.setAttributes=ie(),Ps.insert=te().bind(null,"head"),Ps.domAPI=Q(),Ps.insertStyleElement=re(),q()(Ss.Z,Ps);const Rs=Ss.Z&&Ss.Z.locals?Ss.Z.locals:void 0;var Ts=n(2177),Is={};Is.styleTagTransform=ae(),Is.setAttributes=ie(),Is.insert=te().bind(null,"head"),Is.domAPI=Q(),Is.insertStyleElement=re(),q()(Ts.Z,Is);const Ds=Ts.Z&&Ts.Z.locals?Ts.Z.locals:void 0;const Bs=({children:e})=>A("div",{className:Rs.modalOverlay},e),Ms=({children:e})=>A("div",{className:Rs.modalContent},e),Os=({children:e})=>A("div",{role:"contentinfo",className:Rs.modalFooter},e),Ns=({onClose:e})=>{const t=Se((()=>e(!0)),[e]);return Ht("Escape",t),A(Jt,{onClick:t,title:"Close",icon:"xmark"})},Ls=({onClose:e,title:t,icon:s})=>A("div",{role:"banner",className:Rs.modalHeader},A("span",{className:Rs.modalTitle},s&&A("i",{className:`fa-solid fa-${s}`,role:"img"})," ",t),e&&A(Ns,{onClose:e})),Us=e=>{var{isOpen:t,children:s,title:i}=e,n=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(e,["isOpen","children","title"]);return t?function(e,t){return A(ps,{__v:e,i:t})}(A(Bs,null,A("div",{className:J()(Rs.modal,Ds.components),role:"dialog"},i&&A(Ls,Object.assign({title:i},n)),s)),document.body):null};var Fs=n(8086),js={};js.styleTagTransform=ae(),js.setAttributes=ie(),js.insert=te().bind(null,"head"),js.domAPI=Q(),js.insertStyleElement=re(),q()(Fs.Z,js);const zs=Fs.Z&&Fs.Z.locals?Fs.Z.locals:void 0,Xs=({option:e,value:t,setValue:s})=>{const{label:i,name:n}=e;return A("li",null,A("input",{type:"checkbox",checked:t,onChange:Se((e=>s(n,e.currentTarget.checked)),[n,s])}),A("label",null,i))},Zs=({option:e,value:t,setValue:s})=>{const{label:i,name:n}=e;return A("li",null,A("select",{onChange:Se((e=>{s(n,e.currentTarget.value)}),[n,s])},e.values.map((e=>A("option",{selected:e.value===t,value:e.value},e.name)))),A("label",null,i))},Gs=({isOpen:e,onClose:t})=>{const s=Pe(es),i=s.getSections(),n=Se(((e,t)=>{s.setOption(e,t)}),[s]),r=e=>{const{name:t,type:i}=e,r=s.getOption(t);switch(i){case $t:return A(Xs,{option:e,value:r,setValue:n});case Qt:return A(Zs,{option:e,value:r,setValue:n})}},o=Se((()=>t()),[t]);return A(Us,{title:"Options",isOpen:e,onClose:t},A(Ms,null,A("div",{className:zs.optionsModal},i.map((e=>A(p,null,A("h3",null,e.name),A("ul",null,e.options.map(r)))))),A("i",null,"* Reload page to take effect")),A(Os,null,A("button",{onClick:o},"Close")))},Hs=new Uint8Array([24,176,56,72,138,72,152,72,8,120,32,88,255,186,104,104,104,104,168,202,154,104,40,170,144,56,189,184,5,16,25,152,41,127,73,48,201,10,144,59,201,120,176,41,73,61,240,33,152,41,159,157,56,6,144,126,189,184,6,48,20,165,36,221,56,7,176,13,201,17,176,9,9,240,61,56,7,101,36,133,36,74,56,176,109,24,106,61,184,6,144,2,73,129,157,184,6,208,83,160,10,125,56,5,136,208,250,157,184,4,157,56,5,56,176,67,197,36,144,58,104,168,104,170,104,76,240,253,144,254,176,254,153,128,192,144,55,73,7,168,73,10,10,208,6,184,133,36,157,56,7,189,184,6,74,112,2,176,35,10,10,169,39,176,207,189,56,7,253,184,4,201,248,144,3,105,39,172,169,0,133,36,24,126,184,5,104,168,104,170,104,96,144,39,176,0,16,17,169,137,157,56,6,157,184,6,169,40,157,184,4,169,2,133,54,152,93,56,6,10,240,144,94,184,5,152,72,138,10,10,10,10,168,189,56,7,197,36,104,176,5,72,41,128,9,32,44,88,255,240,3,254,56,7,112,132]);class Ws{constructor(e){this.cbs=e,je("Parallel card")}access(e,t){return 128==(143&e)?this.cbs.putChar&&t&&this.cbs.putChar(t):je("Parallel card unknown softswitch",e),0}ioSwitch(e,t){return this.access(e,t)}read(e,t){return Hs[t]}write(){}getState(){return{}}setState(e){}}var Ys=n(7017),Ks={};Ks.styleTagTransform=ae(),Ks.setAttributes=ie(),Ks.insert=te().bind(null,"head"),Ks.domAPI=Q(),Ks.insertStyleElement=re(),q()(Ys.Z,Ks);const Js=Ys.Z&&Ys.Z.locals?Ys.Z.locals:void 0,Vs=({io:e,slot:t})=>{const[s,i]=ve(!1),[n,r]=ve(""),o=xe(new Uint8Array(1024)),a=xe(0),[l,h]=ve(""),c=Ee((()=>({putChar:e=>{const t=127&e,s=e>=32,i=String.fromCharCode(t);if("\r"===i);else if("\t"===i)r((e=>e+"        "));else{if(4===t)return void r((e=>e.slice(0,-1)));s&&r((e=>e+i))}if(o.current[a.current++]=e,a.current>o.current.length){const e=new Uint8Array(2*o.current.length);e.set(o.current),o.current=e}}})),[a]);ke((()=>{if(e){const s=new Ws(c);e.setSlot(t,s)}}),[c,e,t]),ke((()=>{if(s){const e=new Blob([o.current.slice(0,a.current)],{type:"application/octet-stream"}),t=window.URL.createObjectURL(e);h(t)}}),[s]);const d=Se((()=>{r(""),a.current=0}),[]),u=Se((()=>{i(!1)}),[]),m=Se((()=>{i(!0)}),[]);return A(p,null,A(Us,{isOpen:s,onClose:u,title:"Printer"},A(Ms,null,A("pre",{className:Js.printer,tabIndex:-1},n)),A(Os,null,A("a",{download:"raw_printer_output.bin",href:l,role:"button"},"Download Raw"),A("button",{onClick:d},"Clear"),A("button",{onClick:u},"OK"))),A(Jt,{icon:"print",title:"Printer",onClick:m,active:n.length>0}))},qs="disable_mouse";let $s=!1;class Qs{constructor(e){this.io=e,this.disableMouseJoystick=!1,this.flipX=!1,this.flipY=!1,this.swapXY=!1,this.gamepad=!1,this.mousemove=e=>{if(this.gamepad||this.disableMouseJoystick||$s)return;const t=document.querySelector("canvas"),s=t.getBoundingClientRect();let i=(e.pageX-s.left)/t.clientWidth,n=(e.pageY-s.top)/t.clientHeight;const r=i;this.swapXY&&(i=n,n=r),this.io.paddle(0,this.flipX?1-i:i),this.io.paddle(1,this.flipY?1-n:n)},document.addEventListener("mousemove",this.mousemove),document.querySelectorAll("canvas").forEach((t=>{t.addEventListener("mousedown",(t=>{this.gamepad||$s||e.buttonDown(1===t.which?0:1),t.preventDefault()})),t.addEventListener("mouseup",(t=>{this.gamepad||$s||e.buttonUp(1===t.which?0:1)})),t.addEventListener("contextmenu",(e=>{e.preventDefault()}))})),window.addEventListener("gamepadconnected",(e=>{this.gamepad=!!e.gamepad}))}getOptions(){return[{name:"Joystick",options:[{name:qs,label:"Disable Mouse Joystick",type:$t,defaultVal:!1},{name:"flip_x",label:"Flip X-Axis",type:$t,defaultVal:!1},{name:"flip_y",label:"Flip Y-Axis",type:$t,defaultVal:!1},{name:"swap_x_y",label:"Swap Axis",type:$t,defaultVal:!1}]}]}setOption(e,t){e===qs&&(this.io.paddle(0,.5),this.io.paddle(1,.5),this.disableMouseJoystick=t)}}const ei="mono_screen",ti="full_page",si="show_scanlines",ii="gl_canvas";class ni{constructor(e){this.vm=e,this.enterFullScreen=()=>{const e=document.getElementById("screen");document.fullscreenEnabled?document.fullscreenElement?document.exitFullscreen():e.requestFullscreen():e.webkitRequestFullScreen&&(document.webkitIsFullScreen?document.webkitCancelFullScreen():e.webkitRequestFullScreen())}}getOptions(){return[{name:"Screen",options:[{name:ei,label:"Mono Screen",type:$t,defaultVal:!1},{name:si,label:"Show Scanlines",type:$t,defaultVal:!1},{name:ti,label:"Full Page",type:$t,defaultVal:!1},{name:ii,label:"GL Renderer *",type:$t,defaultVal:!0}]}]}setOption(e,t){switch(e){case ei:this.vm.mono(t);break;case ti:this.setFullPage(t);break;case si:this.vm.scanlines(t)}}setFullPage(e){e?document.body.classList.add("full-page"):document.body.classList.remove("full-page")}}const ri="computer_type2e",oi="accelerator_toggle";class ai{constructor(e,t){this.io=e,this.e=t}getOptions(){return[{name:"Type",options:this.e?[{name:ri,label:" *",type:Qt,defaultVal:"apple2enh",values:[{value:"apple2enh",name:"Enhanced Apple //e"},{value:"apple2e",name:"Apple //e"},{value:"apple2rm",name:"Enhanced Apple //e (Reactive Micro)"},{value:"apple2ex",name:"Apple //e Extended Debugging"}]}]:[{name:"computer_type2",label:" *",type:Qt,defaultVal:"apple2plus",values:[{value:"apple2plus",name:"Apple ][+"},{value:"apple2",name:"Autostart Apple ]["},{value:"apple213",name:"13 Sector Apple ]["},{value:"original",name:"Apple ]["},{value:"apple2j",name:"Apple ][j+"},{value:"apple2lc",name:"Apple ][+ (lowercase font)"},{value:"apple2pig",name:"Apple ][+ (pig font)"},{value:"pravetz82",name:"Pravetz 82"}]}]},{name:"CPU",options:[{name:oi,label:"Accelerated",type:$t,defaultVal:!1}]}]}setOption(e,t){if(e===oi){const e=t?4092:1023;this.io.updateKHz(e)}}}var li=n(8046),hi={};hi.styleTagTransform=ae(),hi.setAttributes=ie(),hi.insert=te().bind(null,"head"),hi.domAPI=Q(),hi.insertStyleElement=re(),q()(li.Z,hi);const ci=li.Z&&li.Z.locals?li.Z.locals:void 0,di=({apple2:e,e:t,toggleDebugger:s})=>{const[i,n]=ve(!1),[r,o]=ve(),a=Pe(es);ke((()=>{if(e){const s=e.getIO(),i=e.getVideoModes();o(s);const n=new ai(s,t);a.addOptions(n);const r=new Qs(s);a.addOptions(r);const l=new ni(i);a.addOptions(l)}}),[e,t,a]);const l=Se((()=>null==e?void 0:e.reset()),[e]),h=Se((()=>window.open("https://github.com/whscullin/apple2js#readme","_blank")),[]),c=Se((()=>n(!0)),[]),d=Se((()=>n(!1)),[]),u=Se((()=>a.setOption(ti,!a.getOption(ti))),[a]);return Ht("F2",u),Ht("F4",c),Ht("F12",l),A("div",{className:ci.resetRow},A(Gs,{isOpen:i,onClose:d}),A(Gt,null,A(jt,{apple2:e}),A(Jt,{onClick:s,title:"Toggle Debugger",icon:"bug"}),A(ns,{apple2:e}),A(Vs,{io:r,slot:1}),A("div",{style:{flexGrow:1}}),A(Jt,{onClick:h,title:"About",icon:"info"}),A(Jt,{onClick:c,title:"Options (F4)",icon:"cog"})),t&&A("div",{className:ci.reset,onClick:l},"Reset"))};var ui=n(101),Ai={};Ai.styleTagTransform=ae(),Ai.setAttributes=ie(),Ai.insert=te().bind(null,"head"),Ai.domAPI=Q(),Ai.insertStyleElement=re(),q()(ui.Z,Ai);const mi=ui.Z&&ui.Z.locals?ui.Z.locals:void 0,pi=({children:e})=>A("div",null,e),gi=({children:e,onClick:t,selected:s})=>A("div",{onClick:t,className:J()(mi.tab,{[mi.selected]:s})},e),fi=({children:e,setSelected:t})=>{const[s,i]=ve(0),n=Se((e=>{t(e),i(e)}),[t]);return Array.isArray(e)?A("div",{className:mi.tabs},e.map(((e,t)=>A(gi,{key:t,onClick:()=>n(t),selected:t===s},e)))):null},_i={128:"END",129:"FOR",130:"NEXT",131:"DATA",132:"INPUT",133:"DEL",134:"DIM",135:"READ",136:"GR",137:"TEXT",138:"PR#",139:"IN#",140:"CALL",141:"PLOT",142:"HLIN",143:"VLIN",144:"HGR2",145:"HGR",146:"HCOLOR=",147:"HPLOT",148:"DRAW",149:"XDRAW",150:"HTAB",151:"HOME",152:"ROT=",153:"SCALE=",154:"SHLOAD",155:"TRACE",156:"NOTRACE",157:"NORMAL",158:"INVERSE",159:"FLASH",160:"COLOR=",161:"POP=",162:"VTAB",163:"HIMEM:",164:"LOMEM:",165:"ONERR",166:"RESUME",167:"RECALL",168:"STORE",169:"SPEED=",170:"LET",171:"GOTO",172:"RUN",173:"IF",174:"RESTORE",175:"&",176:"GOSUB",177:"RETURN",178:"REM",179:"STOP",180:"ON",181:"WAIT",182:"LOAD",183:"SAVE",184:"DEF",185:"POKE",186:"PRINT",187:"CONT",188:"LIST",189:"CLEAR",190:"GET",191:"NEW",192:"TAB(",193:"TO",194:"FN",195:"SPC(",196:"THEN",197:"AT",198:"NOT",199:"STEP",200:"+",201:"-",202:"*",203:"/",204:"^",205:"AND",206:"OR",207:">",208:"=",209:"<",210:"SGN",211:"INT",212:"ABS",213:"USR",214:"FRE",215:"SCRN(",216:"PDL",217:"POS",218:"SQR",219:"RND",220:"LOG",221:"EXP",222:"COS",223:"SIN",224:"TAN",225:"ATN",226:"PEEK",227:"LEN",228:"STR$",229:"VAL",230:"ASC",231:"CHR$",232:"LEFT$",233:"RIGHT$",234:"MID$"},bi="                                 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ ",Ci=e=>{let t;return t=e>=128&&e<=234?_i[e]:void 0!==bi[e]?bi[e]:`[${ze(e)}]`,t},yi={apple2:"e",columns:40},wi={style:"pretty"};class vi{static decompilerFromMemory(e){const t=[],s=e.read(0,103)+(e.read(0,104)<<8),i=e.read(0,175)+(e.read(0,176)<<8);if(s>=49152||i>=49152)throw new Error(`Program memory ${ze(s,4)}-${ze(i,4)} out of range`);for(let n=s;n<=i;n++)t.push(e.read(n>>8,255&n));return new vi(new Uint8Array(t),s)}constructor(e,t=2049){if(this.program=e,this.base=t,0===this.base){const t=this.wordAt(0);let s=4;for(;e[s];)s++;s++,this.base=t-s}}wordAt(e){return this.program[e]+(this.program[e+1]<<8)}forEachLine(e,t,s){let i=0,n=0,r=this.wordAt(n),o=this.wordAt(n+2);for(;0!==r&&o<e;){if(++i>32768)throw new Error("Loop detected in listing");n=r,r=this.wordAt(n),o=this.wordAt(n+2)}for(;0!==r&&o<=t;){if(++i>32768)throw new Error("Loop detected in listing");s(n+2),n=r-this.base,r=this.wordAt(n),o=this.wordAt(n+2)}}listLine(e,t){const s=[];let i="";const n=this.wordAt(e);for("e"===t.apple2&&(i+=" "),i+=`${n} `,e+=2;0!==this.program[e];){if(e>=this.program.length){s.unshift("Unterminated line: ");break}const n=this.program[e];n>=128&&n<=234?(i+=" ",i+=Ci(n),i+=" "):i+=Ci(n),e++,i.length>=t.columns-7&&(i+="\n",s.push(i),i="     ")}return s.push(i+"\n"),s.join("")}list(e={},t=0,s=65536){const i=Object.assign(Object.assign({},yi),e);let n="";return this.forEachLine(t,s,(e=>{n+=this.listLine(e,i)})),n}compactLine(e){let t="",s=()=>!1;for(t+=this.wordAt(e),s=e=>/^\d/.test(e),e+=2;0!==this.program[e];){if(e>=this.program.length)return"Unterminated line: "+t;const i=this.program[e];let n=Ci(i);"PRINT"===n&&(n="?"),s(n)&&(t+=" "),t+=n,s=()=>!1,197===i&&(s=e=>e.toUpperCase().startsWith("N")),e++}return t}prettyLine(e){let t="",s=!1,i=()=>!1;for(t+=`${this.wordAt(e)} `,e+=2;0!==this.program[e];){if(e>=this.program.length)return"Unterminated line: "+t;const n=this.program[e],r=Ci(n);'"'===r&&(s=!s),(i(n)||!s&&":"===r)&&(t+=" "),t+=r,i=!s&&":"===r||!s&&","===r?()=>!0:n>=207&&n<=209?e=>e<207||e>209:n>128&&n<234?e=>40!==e:e=>e>=128&&e<=234,e++}return t}decompile(e={},t=0,s=65536){const i=Object.assign(Object.assign({},wi),e),n=[];return this.forEachLine(t,s,(e=>{n.push("compact"===i.style?this.compactLine(e):this.prettyLine(e))})),n.join("\n")}}var ki;!function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Function=2]="Function",e[e.Integer=3]="Integer"}(ki||(ki={}));class xi{constructor(e){this.mem=e}readByte(e){const t=e>>8,s=255&e;if(t>=192)throw new Error(`Address ${ze(t)} out of range`);return this.mem.read(t,s)}readWord(e){const t=this.readByte(e);return this.readByte(e+1)<<8|t}readInt(e){return this.readByte(e)<<8|this.readByte(e+1)}readFloat(e,{unpacked:t}={unpacked:!1}){let s=this.readByte(e);if(0===s)return 0;s=(128&s?1:-1)*((127&s)-1);let i=this.readByte(e+1);const n=this.readByte(e+2),r=this.readByte(e+3),o=this.readByte(e+4);let a;return a=t?128&this.readByte(e+5)?-1:1:128&i?-1:1,i&=127,a*(1+(i<<24|n<<16|r<<8|o)/2147483648)*Math.pow(2,s)}readString(e,t){let s="";for(let i=0;i<e;i++)s+=String.fromCharCode(127&this.readByte(t+i));return s}readVar(e){const t=this.readByte(e),s=this.readByte(e+1),i=127&t,n=127&s;return{name:String.fromCharCode(i)+(n?String.fromCharCode(n):""),type:(128&s)>>7|(128&t)>>6}}readArray(e,t,s){let i,n,r;const o=[],a=s[0];for(let l=0;l<a;l++){if(s.length>1)r=this.readArray(e,t,s.slice(1));else switch(t){case 0:r=this.readFloat(e),e+=5;break;case 1:i=this.readByte(e),n=this.readWord(e+1),r=this.readString(i,n),e+=3;break;default:r=this.readInt(e),e+=2}o[l]=r}return o}dumpInternals(){return{txttab:this.readWord(103),fac:this.readFloat(157,{unpacked:!0}),arg:this.readFloat(165,{unpacked:!0}),curline:this.readWord(117)}}dumpVariables(){const e=this.readWord(105),t=this.readWord(107),s=this.readWord(109);let i;const n=[];let r,o,a;for(i=e;i<t;i+=7){const{name:e,type:t}=this.readVar(i);switch(t){case ki.Float:r=this.readFloat(i+2);break;case ki.String:o=this.readByte(i+2),a=this.readWord(i+3),r=this.readString(o,a);break;case ki.Function:r=ze(this.readWord(i+2)),r+=","+ze(this.readWord(i+4));break;case ki.Integer:r=this.readInt(i+2)}n.push({name:e,type:t,value:r})}for(;i<s;){const{name:e,type:t}=this.readVar(i),s=this.readWord(i+2),o=this.readByte(i+4),a=[];for(let e=0;e<o;e++)a[e]=this.readInt(i+5+2*e);if(r=this.readArray(i+5+2*o,t,a),n.push({name:e,sizes:a,type:t,value:r}),s<1)break;i+=s}return n}}var Ei=n(7458),Si={};Si.styleTagTransform=ae(),Si.setAttributes=ie(),Si.insert=te().bind(null,"head"),Si.domAPI=Q(),Si.insertStyleElement=re(),q()(Ei.Z,Si);const Pi=Ei.Z&&Ei.Z.locals?Ei.Z.locals:void 0;var Ri=n(2391),Ti={};Ti.styleTagTransform=ae(),Ti.setAttributes=ie(),Ti.insert=te().bind(null,"head"),Ti.domAPI=Q(),Ti.insertStyleElement=re(),q()(Ri.Z,Ti);const Ii=Ri.Z&&Ri.Z.locals?Ri.Z.locals:void 0,Di=["","$","()","%"],Bi=["Float","String","Function","Integer"],Mi=e=>Array.isArray(e)?Array.isArray(e[0])?`[${e.map((e=>Mi(e))).join(",\n ")}]`:`[${e.map((e=>Mi(e))).join(", ")}]`:`${JSON.stringify(e)}`,Oi=({variable:e})=>{const{name:t,type:s,sizes:i,value:n}=e,r=!!i,o=r?`(${i.map((e=>e-1)).join(",")})`:"";return A("tr",null,A("td",null,t,Di[s],o),A("td",null,Bi[s],r?" Array":""),A("td",null,A("pre",{tabIndex:-1},r?Mi(n):n)))},Ni=({apple2:e})=>{var t;const s=xe(0),[i,n]=ve({listing:"",variables:[],internals:{}}),[r,o]=ve(),a=null==e?void 0:e.getCPU();ke((()=>{a&&o(new xi(a))}),[a]);const l=Se((()=>{if(a&&r)try{const e=vi.decompilerFromMemory(a);n({variables:r.dumpVariables(),internals:r.dumpInternals(),listing:e.decompile()})}catch(e){if(!(e instanceof Error))throw e;n({variables:[],internals:{},listing:e.message})}s.current=requestAnimationFrame(l)}),[a,r]);ke((()=>(s.current=requestAnimationFrame(l),()=>cancelAnimationFrame(s.current))),[l]);const{listing:h,internals:c,variables:d}=i;return A("div",{className:Pi.column},A("span",{className:Ii.subHeading},"Listing"),A("pre",{className:Pi.listing,tabIndex:-1},h),A("span",{className:Ii.subHeading},"Variables"),A("div",{className:Pi.variables},A("table",null,A("tr",null,A("th",null,"Name"),A("th",null,"Type"),A("th",null,"Value")),d.map(((e,t)=>A(Oi,{key:t,variable:e}))))),A("span",{className:Ii.subHeading},"Internals"),A("div",{className:Pi.internals},A("table",null,A("tr",null,A("th",null,"TXTTAB"),A("td",null,ze(null!==(t=c.txttab)&&void 0!==t?t:0)),A("th",null,"FAC"),A("td",null,c.fac)),A("tr",null,A("th",null,"ARG"),A("td",null,c.arg),A("th",null,"CURLINE"),A("td",null,c.curline)))))};function Li(e){const t=new AbortController;return e(t.signal),t}class Ui{constructor(e=console.error){this.errorHandler=e,this.ready=new Promise(((e,t)=>{this.onReady=e,this.onError=t})).catch(this.errorHandler)}}const Fi={description:"Any file",accept:{"*/*":[]}},ji=window.showOpenFilePicker?"picker":"input",zi=({disabled:e=!1,onChange:t=(()=>{}),accept:s=[]})=>{const i=xe(null),n=xe(),r=Se((()=>{var e,s;if(null===(e=i.current)||void 0===e?void 0:e.files){const e=null===(s=i.current)||void 0===s?void 0:s.files;n.current!==e&&(n.current=e,t(e))}}),[t]),o=Ee((()=>{const e=[];for(const t of s)for(let[,s]of Object.entries(t.accept)){Array.isArray(s)||(s=[s]);for(const t of s)e.includes(t)||e.push(t)}const t={};return e.length>0&&(t.accept=e.join(",")),t}),[s]);return A("input",Object.assign({type:"file",role:"button","aria-label":"Open file",ref:i,onChange:r,disabled:e},o))},Xi=({disabled:e=!1,onChange:t=(()=>{}),accept:s=[Fi]})=>{const[i,n]=ve(!1),[r,o]=ve(),[a,l]=ve(),h=Se((()=>function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){if(!i){n(!0);try{const e=yield window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:s});a!==e&&(l(e),t(e))}catch(e){console.error(e)}finally{n(!1)}}}))),[s,i,a,t]);return ke((()=>{o((null==a?void 0:a.length)?a[0].name:"No file selected")}),[a]),A(p,null,A("button",{onClick:h,disabled:e||i},"Choose File")," ",A("span",{role:"label"},r))},Zi=e=>{var{onChange:t,control:s=ji}=e,i=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(e,["onChange","control"]);const n=Se((e=>{const s=[];for(let t=0;t<e.length;t++){const i=e.item(t);null!==i&&s.push({kind:"file",name:i.name,getFile:()=>Promise.resolve(i),createWritable:e=>Promise.reject("File not writable."),queryPermission:e=>Promise.resolve("read"===(null==e?void 0:e.mode)?"granted":"denied"),requestPermission:e=>Promise.resolve("read"===(null==e?void 0:e.mode)?"granted":"denied"),isSameEntry:e=>Promise.resolve(!1),isDirectory:!1,isFile:!0})}t(s)}),[t]),r=Se((e=>{t(e)}),[t]);return"picker"===s?A(Xi,Object.assign({onChange:r},i)):A(zi,Object.assign({onChange:n},i))},Gi=[1,2],Hi="empty",Wi="nibble",Yi="bitstream",Ki="block",Ji=["2mg","d13","do","dsk","po","nib"],Vi=[...Ji,"woz"],qi=["2mg","hdv","po"],$i=[...Vi,...qi];function Qi(e){return(null==e?void 0:e.encoding)===Hi}function en(e){return(null==e?void 0:e.encoding)===Wi}function tn(e){return(null==e?void 0:e.encoding)===Yi}function sn(e,t){return e.includes(t)}var nn=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const rn=e=>{const t=e.match(/^#([^|]*)\|?(.*)$/)||["","",""];return["",t[1],t[2]]},on=e=>{window.location.hash=`#${e[1]}`+(e[2]?`|${e[2]}`:"")},an=e=>{var t;const s=(e.split("/").pop()||e).split("."),i=(null===(t=s.pop())||void 0===t?void 0:t.toLowerCase())||"[none]";return{name:decodeURIComponent(s.join(".")),ext:i}},ln=(e,t,s,i)=>new Promise(((n,r)=>{const o=new FileReader;o.onload=function(){const o=this.result,{name:a,ext:l}=an(i.name);sn(t,l)?(Ot(),e.setBinary(s,a,l,o)?n(!0):r(`Unable to load ${a}`)):r(`Extension "${l}" not recognized.`)},o.readAsArrayBuffer(i)})),hn=(e,t,s)=>nn(void 0,void 0,void 0,(function*(){const i=yield fetch(s);if(!i.ok)throw new Error(`Error loading: ${i.statusText}`);const n=yield i.json();if(!sn(Vi,n.type))throw new Error(`Type "${n.type}" not recognized.`);e.setDisk(t,n),Ot(n.gamepad)})),cn=(e,t,s,i,n)=>nn(void 0,void 0,void 0,(function*(){const r=yield((e,t,s)=>nn(void 0,void 0,void 0,(function*(){const i=yield fetch(e,t?{signal:t}:{});if(!i.ok)throw new Error(`Error loading: ${i.statusText}`);if(!i.body)throw new Error("Error loading: no body");const n=i.body.getReader(),r=parseInt(i.headers.get("content-length")||"0",10);let o=0;const a=[];let l=yield n.read();for(null==s||s(1,r);!l.done;)a.push(l.value),o+=l.value.length,null==s||s(o,r),l=yield n.read();const h=new Uint8Array(o);let c=0;for(const e of a)h.set(e,c),c+=e.length;return h.buffer})))(s,i,n),{name:o,ext:a}=an(s);e.setBinary(t,o,a,r)}));class dn{constructor(e,t){this.disk2=e,this.smartPort=t}setBinary(e,t,s,i){if(!sn($i,s))throw new Error(`Extension "${s}" not recognized.`);if(i.byteLength>=819200){if(!sn(qi,s))throw new Error(`Unable to load "${t}"`);this.smartPort.setBinary(e,t,s,i)}else{if(!sn(Vi,s))throw new Error(`Unable to load "${t}"`);this.disk2.setBinary(e,t,s,i)}return!0}getBinary(e){return null}}const un=(e,t,s)=>new Promise(((i,n)=>{const r=new FileReader;r.onload=function(){const e=this.result,n=new Uint8Array(e);s.setMemory(t,n),i(!0)},r.readAsArrayBuffer(e)}));var An=n(1971),mn={};mn.styleTagTransform=ae(),mn.setAttributes=ie(),mn.insert=te().bind(null,"head"),mn.domAPI=Q(),mn.insertStyleElement=re(),q()(An.Z,mn);const pn=An.Z&&An.Z.locals?An.Z.locals:void 0;const gn=/#([0-9a-f]{2})([0-9a-f]{4})$/i,fn=/^[0-9A-F]{1,2}$/i,_n=/^[0-9A-F]{1,4}$/i,bn=A("div",{className:pn.errorIcon},A("i",{className:"fa-solid fa-triangle-exclamation",title:"Invalid hex address"})),Cn=({apple2:e})=>{const t=null==e?void 0:e.getDebugger(),[s,i]=ve({running:!0,registers:"",stack:"",trace:"",zeroPage:"",memory:""}),[n,r]=ve("08"),[o,a]=ve("0800"),[l,h]=ve(!0),c=xe(0),d=Se((()=>{t&&i({registers:t.dumpRegisters(),running:t.isRunning(),stack:t.getStack(38),trace:t.getTrace(16),zeroPage:t.dumpPage(0),memory:t.dumpPage(parseInt(n,16)||0)}),c.current=requestAnimationFrame(d)}),[t,n]);ke((()=>(c.current=requestAnimationFrame(d),()=>cancelAnimationFrame(c.current))),[d]);const u=Se((()=>{null==e||e.stop()}),[e]),m=Se((()=>{null==e||e.run()}),[e]),p=Se((()=>{null==t||t.step()}),[t]),g=Se((e=>{a(e.currentTarget.value)}),[]),f=Se((e=>{h(e.currentTarget.checked)}),[]),_=Se((e=>{r(e.currentTarget.value)}),[]),b=Se((e=>{t&&1===e.length&&Li((()=>function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){const s=yield e[0].getFile();let i=parseInt(o,16)||2048;const n=s.name.match(gn);if(n&&3===n.length){const[,,e]=n;i=parseInt(e,16)}yield un(s,i,t),a(ze(i,4)),l&&(null==t||t.runAt(i))}))))}),[t,o,l]),{memory:C,registers:y,running:w,stack:v,trace:k,zeroPage:x}=s,E=fn.test(n),S=_n.test(o);return A("div",{className:Ii.column},A("span",{className:Ii.subHeading},"Controls"),A("div",{className:pn.controls},A(Jt,w?{onClick:u,disabled:!e,title:"Pause",icon:"pause"}:{onClick:m,disabled:!e,title:"Run",icon:"play"}),A(Jt,{onClick:p,disabled:!e||w,title:"Step",icon:"forward-step"})),A("div",{className:Ii.row},A("div",{className:Ii.column},A("span",{className:Ii.subHeading},"Registers"),A("pre",{tabIndex:-1},y),A("span",{className:Ii.subHeading},"Trace"),A("pre",{className:pn.trace,tabIndex:-1},k),A("span",{className:Ii.subHeading},"ZP"),A("pre",{className:pn.zeroPage,tabIndex:-1},x)),A("div",{className:Ii.column},A("span",{className:Ii.subHeading},"Stack"),A("pre",{className:pn.stack,tabIndex:-1},v))),A("div",null,A("hr",null),A("span",{className:Ii.subHeading},"Memory Page: $ "),A("input",{value:n,onChange:_,maxLength:2,className:J()({[pn.invalid]:!E})}),E?null:bn,A("pre",{className:pn.zp,tabIndex:-1},C)),A("div",null,A("hr",null),A("span",{className:Ii.subHeading},"Load File: $ "),A("input",{type:"text",value:o,maxLength:4,onChange:g,className:J()({[pn.invalid]:!S})}),S?null:bn," ",A("input",{type:"checkbox",checked:l,onChange:f}),"Run",A("div",{className:pn.fileChooser},A(Zi,{onChange:b}))))},yn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function wn(e){let t,s,i,n,r,o,a,l,h=0,c=0,d="";const u=[];if(e){do{t=e[h++],s=e[h++],i=e[h++],l=t<<16|s<<8|i,n=l>>18&63,r=l>>12&63,o=l>>6&63,a=63&l,u[c++]=yn.charAt(n)+yn.charAt(r)+yn.charAt(o)+yn.charAt(a)}while(h<e.length);switch(d=u.join(""),e.length%3){case 1:d=d.slice(0,-2)+"==";break;case 2:d=d.slice(0,-1)+"="}return d}}function vn(e){let t,s,i,n,r,o,a,l,h=0,c=0;const d=[];if(e){do{n=yn.indexOf(e.charAt(h++)),r=yn.indexOf(e.charAt(h++)),o=yn.indexOf(e.charAt(h++)),a=yn.indexOf(e.charAt(h++)),l=n<<18|r<<12|o<<6|a,t=l>>16&255,s=l>>8&255,i=255&l,d[c++]=t,64!==o&&(d[c++]=s),64!==a&&(d[c++]=i)}while(h<e.length);return new Uint8Array(d)}}const kn=[0,7,14,6,13,5,12,4,11,3,10,2,9,1,8,15],xn=[0,13,11,9,7,5,3,1,14,12,10,8,6,4,2,15],En=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],Sn=[0,2,4,6,8,10,12,14,1,3,5,7,9,11,13,15],Pn=[0,10,7,4,1,11,8,5,2,12,9,6,3],Rn=[0,1,2,3,4,5,6,7,8,9,10,11,12],Tn=[171,173,174,175,181,182,183,186,187,189,190,191,214,215,218,219,221,222,223,234,235,237,238,239,245,246,247,250,251,253,254,255],In=[0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,0,0,0,0,0,4,5,6,0,0,7,8,0,9,10,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,13,0,0,14,15,0,16,17,18,0,0,0,0,0,0,0,0,0,0,19,20,0,21,22,23,0,0,0,0,0,24,25,26,0,0,27,28,0,29,30,31],Dn=[150,151,154,155,157,158,159,166,167,171,172,173,174,175,178,179,180,181,182,183,185,186,187,188,189,190,191,203,205,206,207,211,214,215,217,218,219,220,221,222,223,229,230,231,233,234,235,236,237,238,239,242,243,244,245,246,247,249,250,251,252,253,254,255],Bn=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,2,3,0,4,5,6,0,0,0,0,0,0,7,8,0,0,0,9,10,11,12,13,0,0,14,15,16,17,18,19,0,20,21,22,23,24,25,26,0,0,0,0,0,0,0,0,0,0,0,27,0,28,29,30,0,0,0,31,0,0,32,33,0,34,35,36,37,38,39,40,0,0,0,0,0,41,42,43,0,44,45,46,47,48,49,50,0,0,51,52,53,54,55,56,0,57,58,59,60,61,62,63];function Mn(e){let t=170&e,s=85&e;return t>>=1,t|=170,s|=170,[t,s]}function On(e,t){return(e<<1|1)&t}function Nn(e,t,s,i){let n,r=[];n=0===s?128:0===t?40:38;for(let e=0;e<n;e++)r.push(255);const o=e^t^s;r=r.concat([213,170,150]),r=r.concat(Mn(e)),r=r.concat(Mn(t)),r=r.concat(Mn(s)),r=r.concat(Mn(o)),r=r.concat([222,170,235]);for(let e=0;e<5;e++)r.push(255);r=r.concat([213,170,173]);const a=[];for(let e=0;e<342;e++)a[e]=0;let l=85;for(let e=257;e>=0;e--){let t=i[e%256],s=a[0+l];s=s<<1|1&t,t>>=1,s=s<<1|1&t,t>>=1,a[86+e]=t,a[0+l]=s,--l<0&&(l=85)}let h=0;for(let e=0;e<342;e++){const t=a[e];r.push(Dn[h^t]),h=t}return r.push(Dn[h]),r=r.concat([222,170,235]),r.push(255),r}function Ln(e,t,s,i){let n,r=[];n=0===s?128:0===t?40:38;for(let e=0;e<n;e++)r.push(255);const o=e^t^s;r=r.concat([213,170,181]),r=r.concat(Mn(e)),r=r.concat(Mn(t)),r=r.concat(Mn(s)),r=r.concat(Mn(o)),r=r.concat([222,170,235]);for(let e=0;e<5;e++)r.push(255);r=r.concat([213,170,173]);const a=[];let l=0;for(let e=50;e>=0;e--){const t=i[l]>>3,s=7&i[l];l++;const n=i[l]>>3,r=7&i[l];l++;const o=i[l]>>3,h=7&i[l];l++;const c=i[l]>>3,d=7&i[l];l++;const u=i[l]>>3,A=7&i[l];l++,a[e+0]=t,a[e+51]=n,a[e+102]=o,a[e+153]=c,a[e+204]=u,a[e+256]=s<<2|(4&d)>>1|(4&A)>>2,a[e+307]=r<<2|2&d|(2&A)>>1,a[e+358]=h<<2|(1&d)<<1|1&A}a[255]=i[l]>>3,a[409]=7&i[l];let h=0;for(let e=409;e>=256;e--){const t=a[e];r.push(Tn[h^t]),h=t}for(let e=0;e<256;e++){const t=a[e];r.push(Tn[h^t]),h=t}return r.push(Tn[h]),r=r.concat([222,170,235]),r.push(255),r}var Un;!function(e){e[e.START_OF_FIELD_MARKER_FIRST_NIBBLE=0]="START_OF_FIELD_MARKER_FIRST_NIBBLE",e[e.START_OF_FIELD_MARKER_SECOND_NIBBLE=1]="START_OF_FIELD_MARKER_SECOND_NIBBLE",e[e.FIELD_TYPE_MARKER=2]="FIELD_TYPE_MARKER",e[e.ADDRESS_FIELD=3]="ADDRESS_FIELD",e[e.ADDRESS_FIELD_13=4]="ADDRESS_FIELD_13",e[e.DATA_FIELD_6AND2=5]="DATA_FIELD_6AND2",e[e.DATA_FIELD_5AND3=6]="DATA_FIELD_5AND3"}(Un||(Un={}));class Fn extends Error{constructor(e,t,s){super(`Error finding track ${e} (${ze(e)}), sector ${t} (${ze(t)}): `+(s instanceof Error?`${s.message}`:`${String(s)}`))}}function jn(e,t,s){const i=e.tracks[t];let n=16,r=Un.START_OF_FIELD_MARKER_FIRST_NIBBLE,o=0,a=0;function l(){const e=i[o++];return o>=i.length&&(o=0,a++),e}function h(e){o+=e,o>=i.length&&(o%=i.length,a++)}let c,d=0,u=0,A=0;for(;a<4;){let e;switch(r){case Un.START_OF_FIELD_MARKER_FIRST_NIBBLE:e=l(),r=213===e?Un.START_OF_FIELD_MARKER_SECOND_NIBBLE:Un.START_OF_FIELD_MARKER_FIRST_NIBBLE;break;case Un.START_OF_FIELD_MARKER_SECOND_NIBBLE:e=l(),r=170===e?Un.FIELD_TYPE_MARKER:Un.START_OF_FIELD_MARKER_FIRST_NIBBLE;break;case Un.FIELD_TYPE_MARKER:switch(e=l(),e){case 150:r=Un.ADDRESS_FIELD,n=16;break;case 181:r=Un.ADDRESS_FIELD,n=13;break;case 173:r=16===n?Un.DATA_FIELD_6AND2:Un.DATA_FIELD_5AND3;break;default:r=Un.START_OF_FIELD_MARKER_FIRST_NIBBLE}break;case Un.ADDRESS_FIELD:A=On(l(),l()),d=On(l(),l()),u=On(l(),l()),c=On(l(),l()),c!==(A^d^u)&&je("Invalid header checksum:",ze(A),ze(d),ze(u),ze(c)),h(3),r=0;break;case Un.DATA_FIELD_6AND2:if(u===s&&d===t){const e=o;let i=0;for(let e=0;e<342;e++)i=Bn[l()-128]^i;const r=Bn[l()-128]^i;if(!r)return{track:t,sector:s,nibble:e,sectors:n};je("Invalid data checksum:",ze(i),ze(t),ze(s),ze(r)),h(3)}else h(345);r=Un.START_OF_FIELD_MARKER_FIRST_NIBBLE;break;case Un.DATA_FIELD_5AND3:if(u===s&&d===t){const e=o;let i=0;for(let e=0;e<410;e++)i=In[l()-160]^i;const r=In[l()-160]^i;if(!r)return{track:t,sector:s,nibble:e,sectors:n};je("Invalid data checksum:",ze(i),ze(t),ze(s),ze(r)),h(3)}else h(410);r=Un.START_OF_FIELD_MARKER_FIRST_NIBBLE;break;default:r=Un.START_OF_FIELD_MARKER_FIRST_NIBBLE}}throw new Fn(t,s,`too many retries (${a})`)}class zn extends Error{constructor(e,t){super(`Expected: ${ze(e)}, received: ${ze(t)}`)}}class Xn extends Error{constructor(e,t,s){super(`Error reading track ${e} (${ze(e)}), sector ${t} (${ze(t)}): `+(s instanceof Error?`${s.message}`:`${String(s)}`))}}function Zn(e,t,s){const i=jn(e,t,s),{nibble:n,sectors:r}=i,o=e.tracks[t];let a=n;const l=()=>{const e=o[a++];return a>=o.length&&(a=0),e};try{return 13===r?function(e){const t=new Uint8Array(256);let s,i=0;s=In[e()-160]^i,i=s,t[255]=7&s;for(let n=152;n>=0;n--){s=In[e()-160]^i,i=s;const r=Math.floor(n/51)+5*(50-n%51),o=3+5*(50-n%51),a=4+5*(50-n%51),l=2-Math.floor(n/51);t[r]=(28&s)>>2,t[o]^=(2&s)>>1<<l,t[a]^=(1&s)<<l}for(let n=0;n<255;n++)s=In[e()-160]^i,i=s,t[Math.floor(n/51)+5*(50-n%51)]^=s<<3;s=In[e()-160]^i,i=s,t[255]^=s<<3;const n=In[e()-160]^i;if(n)throw new zn(i,n^i);return t}(l):function(e){const t=new Uint8Array(256),s=[];let i,n=0;for(let t=85;t>=0;t--)i=Bn[e()-128]^n,s[t]=i,n=i;for(let s=0;s<256;s++)i=Bn[e()-128]^n,t[s]=i,n=i;const r=Bn[e()-128]^n;if(r)throw new zn(n,r^n);for(let e=0,i=85;e<256;e++)t[e]<<=1,0!=(1&s[i])&&(t[e]|=1),s[i]>>=1,t[e]<<=1,0!=(1&s[i])&&(t[e]|=1),s[i]>>=1,--i<0&&(i=85);return t}(l)}catch(e){throw new Xn(t,s,e)}}function Gn(e,t){let s=0,i=!0;for(;t<e.length&&(e[t]?(s=s<<1|1,i=!1):i||(s<<=1),!(128&s));)t+=1;return{nibble:s,offset:t}}function Hn(e){const{data:t,name:s,side:i,rawData:n,volume:r,readOnly:o}=e,a={format:"dsk",encoding:Wi,metadata:{name:s,side:i},volume:r,readOnly:o,tracks:[]};for(let e=0;e<35;e++){let s=[];for(let i=0;i<16;i++){const o=kn[i];let a;if(n){const t=256*(16*e+o);a=new Uint8Array(n.slice(t,t+256))}else{if(!t)throw new Error("Requires data or rawData");a=new Uint8Array(t[e][o])}s=s.concat(Nn(r,e,i,a))}a.tracks[e]=Fe(s)}return a}function Wn(e){const{data:t,name:s,side:i,rawData:n,volume:r,readOnly:o}=e,a={format:"nib",encoding:Wi,metadata:{name:s,side:i},volume:r||254,readOnly:o||!1,tracks:[]};for(let e=0;e<35;e++){let s;if(n){const t=6656*e;s=new Uint8Array(n.slice(t,t+6656))}else{if(!t)throw new Error("Requires data or rawData");s=t[e][0]}a.tracks[e]=s}return a}function Yn(e){const{data:t,name:s,side:i,rawData:n,volume:r,readOnly:o}=e,a={format:"po",encoding:Wi,metadata:{name:s,side:i},volume:r||254,tracks:[],readOnly:o||!1};for(let e=0;e<35;e++){let s=[];for(let i=0;i<16;i++){const o=En[i];let a;if(n){const t=256*(16*e+o);a=new Uint8Array(n.slice(t,t+256))}else{if(!t)throw new Error("Requires data or rawData");a=t[e][o]}s=s.concat(Nn(r,e,i,a))}a.tracks[e]=Fe(s)}return a}const Kn={SIGNATURE:0,CREATOR:4,HEADER_LENGTH:8,VERSION:10,FORMAT:12,FLAGS:16,BLOCKS:20,DATA_OFFSET:24,DATA_LENGTH:28,COMMENT:32,COMMENT_LENGTH:36,CREATOR_DATA:40,CREATOR_DATA_LENGTH:44,PADDING:48},Jn={READ_ONLY:2147483648,VOLUME_VALID:256,VOLUME_MASK:255};var Vn;function qn(e){const t=new DataView(e),s=new TextDecoder("ascii"),i=s.decode(e.slice(Kn.SIGNATURE,Kn.SIGNATURE+4));if("2IMG"!==i)throw new Error(`Unrecognized 2mg signature: ${i}`);const n=s.decode(e.slice(Kn.CREATOR,Kn.CREATOR+4)),r=t.getInt16(Kn.HEADER_LENGTH,!0);if(64!==r)throw new Error(`2mg header length is incorrect ${r} !== 64`);const o=t.getInt32(Kn.FORMAT,!0),a=t.getInt32(Kn.FLAGS,!0),l=t.getInt32(Kn.BLOCKS,!0),h=t.getInt32(Kn.DATA_OFFSET,!0),c=t.getInt32(Kn.DATA_LENGTH,!0),d=t.getInt32(Kn.COMMENT,!0),u=t.getInt32(Kn.COMMENT_LENGTH,!0),A=t.getInt32(Kn.CREATOR_DATA,!0),m=t.getInt32(Kn.CREATOR_DATA_LENGTH,!0);if(o===Vn.ProDOS&&512*l!==c)throw new Error(`2mg blocks does not match disk data length: ${l} * 512 !== ${c}`);if(h<r)throw new Error(`2mg data offset is less than header length: ${h} < ${r}`);if(h+c>t.byteLength)throw new Error(`2mg data extends beyond disk image: ${h} + ${c} > ${t.byteLength}`);const p=h+c;if(d&&d<p)throw new Error(`2mg comment is before the end of the disk data: ${d} < ${h} + ${c}`);const g=d?d+u:p;if(g>t.byteLength)throw new Error(`2mg comment extends beyond disk image: ${g} > ${t.byteLength}`);if(A&&A<g)throw new Error(`2mg creator data is before the end of the comment: ${A} < ${g}`);const f=A?A+m:g;if(f>t.byteLength)throw new Error(`2mg creator data extends beyond disk image: ${f} > ${t.byteLength}`);const _={};d&&(_.comment=new TextDecoder("utf-8").decode(new Uint8Array(e,d,u))),A&&(_.creatorData=new Uint8Array(e,A,m));const b=0!=(a&Jn.READ_ONLY);let C=o===Vn.DOS?254:0;return a&Jn.VOLUME_VALID&&(C=a&Jn.VOLUME_MASK),Object.assign({bytes:c,creator:n,format:o,offset:h,readOnly:b,volume:C},_)}!function(e){e[e.DOS=0]="DOS",e[e.ProDOS=1]="ProDOS",e[e.NIB=2]="NIB"}(Vn||(Vn={}));function $n(e){let t,{rawData:s}=e;if(!s)throw new Error("Requires rawData");const{bytes:i,format:n,offset:r,readOnly:o,volume:a}=qn(s);switch(s=s.slice(r,r+i),e=Object.assign(Object.assign({},e),{rawData:s,readOnly:o,volume:a}),n){case Vn.ProDOS:t=Yn(e);break;case Vn.NIB:t=Wn(e);break;case Vn.DOS:default:t=Hn(e)}return t}const Qn=0,er=12,tr=828002135,sr=844779351,ir=168626943;function nr(e,t,s){const i=new Uint8Array(e.buffer.slice(e.byteOffset+t,e.byteOffset+s));return String.fromCharCode(...i)}class rr{constructor(e){this.sides=0,this.bootSector=0,this.bitTiming=0,this.compatibleHardware=0,this.requiredRAM=0,this.largestTrack=0,this.version=e.getUint8(0),this.diskType=e.getUint8(1),this.writeProtected=e.getUint8(2),this.synchronized=e.getUint8(3),this.cleaned=e.getUint8(4),this.creator=nr(e,5,37),this.version>1&&(this.sides=e.getUint8(37),this.bootSector=e.getUint8(38),this.bitTiming=e.getUint8(39),this.compatibleHardware=e.getUint16(40,!0),this.requiredRAM=e.getUint16(42,!0),this.largestTrack=e.getUint16(44,!0))}}class or{constructor(e){this.trackMap=[];for(let t=0;t<160;t++)this.trackMap.push(e.getUint8(t))}}class ar{}class lr extends ar{constructor(e){super(),this.rawTracks=[],this.tracks=[];for(let t=0,s=0;s<e.byteLength;s+=6656,t++){let i=[];const n=[],r=e.buffer.slice(e.byteOffset+s,e.byteOffset+s+6656),o=new Uint8Array(r),a=new DataView(r).getUint16(6648,!0);for(let e=0;e<a;e++){const t=e>>3,s=7-(7&e);n[e]=o[t]>>s&1?1:0}i=[];let l=0;for(;l<n.length;){const e=Gn(n,l);if(!e.nibble)break;i.push(e.nibble),l=e.offset+1}this.tracks[t]=new Uint8Array(i),this.rawTracks[t]=new Uint8Array(n)}}}class hr extends ar{constructor(e){let t;for(super(),this.trks=[],t=0;t<160;t++){const s=e.getUint16(8*t,!0),i=e.getUint16(8*t+2,!0),n=e.getUint32(8*t+4,!0);if(0===n)break;this.trks.push({startBlock:s,blockCount:i,bitCount:n})}this.tracks=[],this.rawTracks=[];const s=e.buffer;for(t=0;t<this.trks.length;t++){const e=this.trks[t];let i=[];const n=[],r=512*e.startBlock,o=r+512*e.blockCount,a=s.slice(r,o),l=new Uint8Array(a);for(let t=0;t<e.bitCount;t++){const e=t>>3,s=7-(7&t);n[t]=l[e]>>s&1?1:0}i=[];let h=0;for(;h<n.length;){const e=Gn(n,h);if(!e.nibble)break;i.push(e.nibble),h=e.offset+1}this.tracks[t]=new Uint8Array(i),this.rawTracks[t]=new Uint8Array(n)}}}class cr{constructor(e){const t=nr(e,0,e.byteLength).split("\n");this.values=t.reduce((function(e,t){const s=t.split("\t");return e[s[0]]=s[1],e}),{})}}function dr(e,t){let s=null;switch(e){case"2mg":s=$n(t);break;case"d13":s=function(e){const{data:t,name:s,side:i,rawData:n,volume:r,readOnly:o}=e,a={format:"d13",encoding:Wi,metadata:{name:s,side:i},volume:r,readOnly:o,tracks:[]};if(!t&&!n)throw new Error("data or rawData required");for(let e=0;e<35;e++){let s=[];for(let i=0;i<13;i++){const o=Pn[i];let a;if(n){const t=256*(13*e+o);a=new Uint8Array(n.slice(t,t+256))}else{if(!t)throw new Error("Requires data or rawData");a=t[e][o]}s=s.concat(Ln(r,e,o,a))}a.tracks.push(new Uint8Array(s))}return a}(t);break;case"do":case"dsk":s=Hn(t);break;case"nib":s=Wn(t);break;case"po":s=Yn(t);break;case"woz":s=function(e){const{rawData:t}=e;if(!t)throw new Error("Requires rawData");const s=new DataView(t,0);let i,n=0;const r={};function o(){if(n>=s.byteLength)return null;const e=s.getUint32(n,!0),t=s.getUint32(n+4,!0),i=new DataView(s.buffer,n+8,t);return n+=t+8,{type:e,size:t,data:i}}if(function(){switch(s.getUint32(Qn+0,!0)){case tr:i=1;break;case sr:i=2;break;default:return!1}return s.getUint32(Qn+4,!0)===ir}()){n=er;let e=o();for(;e;){switch(e.type){case 1330007625:r.info=new rr(e.data);break;case 1346456916:r.tmap=new or(e.data);break;case 1397445204:r.trks=1===i?new lr(e.data):new hr(e.data);break;case 1096041805:r.meta=new cr(e.data);break;case 1414091351:break;default:je("Unsupported chunk",ze(e.type,8))}e=o()}}else je("Invalid woz header");const{meta:a,tmap:l,trks:h,info:c}=r;return{encoding:Yi,format:"woz",trackMap:(null==l?void 0:l.trackMap)||[],rawTracks:(null==h?void 0:h.rawTracks)||[],readOnly:!0,metadata:{name:(null==a?void 0:a.values.title)||e.name,side:(null==a?void 0:a.values.side_name)||(null==a?void 0:a.values.side)},info:c}}(t)}return s}const ur=new Uint8Array([162,32,160,0,162,3,134,60,138,10,36,60,240,16,5,60,73,255,41,126,176,8,74,208,251,152,157,86,3,200,232,16,229,32,88,255,186,189,0,1,10,10,10,10,133,43,170,189,142,192,189,140,192,189,138,192,189,137,192,160,80,189,128,192,152,41,3,10,5,43,170,189,129,192,169,86,32,168,252,136,16,235,133,38,133,61,133,65,169,8,133,39,24,8,189,140,192,16,251,73,213,208,247,189,140,192,16,251,201,170,208,243,234,189,140,192,16,251,201,150,240,9,40,144,223,73,173,240,37,208,217,160,3,133,64,189,140,192,16,251,42,133,60,189,140,192,16,251,37,60,136,208,236,40,197,61,208,190,165,64,197,65,208,184,176,183,160,86,132,60,188,140,192,16,251,89,214,2,164,60,136,153,0,3,208,238,132,60,188,140,192,16,251,89,214,2,164,60,145,38,200,208,239,188,140,192,16,251,89,214,2,208,135,160,0,162,86,202,48,251,177,38,94,0,3,42,94,0,3,42,145,38,200,208,238,230,39,230,61,165,61,205,0,8,166,43,144,219,76,1,8,0,0,0,0,0]),Ar=new Uint8Array([162,32,160,0,169,3,133,60,24,136,152,36,60,240,245,38,60,144,248,192,213,240,237,202,138,153,0,8,208,230,32,88,255,186,189,0,1,72,10,10,10,10,133,43,170,169,208,72,189,142,192,189,140,192,189,138,192,189,137,192,160,80,189,128,192,152,41,3,10,5,43,170,189,129,192,169,86,32,168,252,136,16,235,169,3,133,39,169,0,133,38,133,61,24,8,189,140,192,16,251,73,213,208,247,189,140,192,16,251,201,170,208,243,234,189,140,192,16,251,201,181,240,9,40,144,223,73,173,240,31,208,217,160,3,132,42,189,140,192,16,251,42,133,60,189,140,192,16,251,37,60,136,208,238,40,197,61,208,190,176,189,160,154,132,60,188,140,192,16,251,89,0,8,164,60,136,153,0,8,208,238,132,60,188,140,192,16,251,89,0,8,164,60,145,38,200,208,239,188,140,192,16,251,89,0,8,208,141,96,168,162,0,185,0,8,74,62,204,3,74,62,153,3,133,60,177,38,10,10,10,5,60,145,38,200,232,224,51,208,228,198,42,208,222,204,0,3,208,3,76,1,3,76,45,255,255]);class mr{constructor(e){this.drive=e}tick(){}onQ6Low(){}onQ6High(e){}onDriveOn(){}onDriveOff(){}clampTrack(){this.drive.track<0&&(this.drive.track=0),this.drive.track>34&&(this.drive.track=34)}getState(){return{}}setState(e){}}class pr{constructor(e,t,s,i){this.driveNo=e,this.drive=t,this.disk=s,this.controller=i}debug(...e){}isOn(){return this.controller.on&&this.controller.driveNo===this.driveNo}isWriteProtected(){return this.drive.readOnly}}class gr extends pr{constructor(e,t,s,i,n){super(e,t,s,i),this.disk=s,this.onDirty=n,this.skip=0,this.nibbleCount=0}tick(){}onQ6Low(){const e=this.drive,t=this.disk;if(this.isOn()&&(this.skip||this.controller.q7)){const s=t.tracks[e.track>>2];s&&s.length&&(e.head>=s.length&&(e.head=0),this.controller.q7?t.readOnly||(s[e.head]=this.controller.bus,e.dirty=!0,this.onDirty()):(this.controller.latch=s[e.head],this.nibbleCount++),++e.head)}else this.controller.latch=0;this.skip=++this.skip%2}onQ6High(e){const t=this.drive;e&&!this.controller.q7&&(t.readOnly?(this.controller.latch=255,this.debug("Setting readOnly")):(this.controller.latch>>=1,this.debug("Clearing readOnly")))}onDriveOn(){this.nibbleCount=0}onDriveOff(){this.debug("nibbles read",this.nibbleCount)}clampTrack(){this.drive.track<0&&(this.drive.track=0),this.drive.track>139&&(this.drive.track=139)}getState(){const{skip:e,nibbleCount:t}=this;return{skip:e,nibbleCount:t}}setState(e){this.skip=e.skip,this.nibbleCount=e.nibbleCount}}class fr extends pr{constructor(e,t,s,i,n,r){super(e,t,s,i),this.disk=s,this.onDirty=n,this.io=r,this.lastCycles=0,this.zeros=0,this.state=2,this.clock=0}onDriveOn(){this.lastCycles=this.io.cycles()}onDriveOff(){}moveHead(){const e=this.io.cycles();let t=2*(e-this.lastCycles);this.lastCycles=e;const s=this.drive,i=this.disk,n=this.controller,r=i.rawTracks[i.trackMap[s.track]]||[0];for(;t-- >0;){let e=0;4===this.clock&&(e=r[s.head],e?this.zeros=0:++this.zeros>2&&(e=Math.random()>=.5?1:0));let t=0;t|=e?0:1,t|=128&n.latch?2:0,t|=n.q6?4:0,t|=n.q7?8:0,t|=this.state<<4;const i=_r[n.sectors][t];switch(this.debug(`clock: ${this.clock} state: ${ze(this.state)} pulse: ${e} command: ${ze(i)} q6: ${n.q6} latch: ${ze(n.latch)}`),15&i){case 0:n.latch=0;break;case 8:break;case 9:n.latch=n.latch<<1&255;break;case 10:n.latch>>=1,this.isWriteProtected()&&(n.latch|=128);break;case 11:n.latch=n.bus,this.debug("Loading",ze(n.latch),"from bus");break;case 13:n.latch=255&(n.latch<<1|1);break;default:this.debug(`unknown command: ${ze(15&i)}`)}this.state=i>>4&15,4===this.clock&&this.isOn()&&(n.q7&&(r[s.head]=8&this.state?1:0,this.debug("Wrote",8&this.state?1:0),s.dirty=!0,this.onDirty()),++s.head>=r.length&&(s.head=0)),++this.clock>7&&(this.clock=0)}}tick(){this.moveHead()}onQ6High(e){}onQ6Low(){}clampTrack(){this.drive.track<0&&(this.drive.track=0);const e=this.disk.trackMap.length-1;this.drive.track>e&&(this.drive.track=e)}getState(){const{clock:e,state:t,lastCycles:s,zeros:i}=this;return{clock:e,state:t,lastCycles:s,zeros:i}}setState(e){this.clock=e.clock,this.state=e.state,this.lastCycles=e.lastCycles,this.zeros=e.zeros}}const _r={13:[216,24,24,8,10,10,10,10,24,24,24,24,24,24,24,24,216,45,40,40,10,10,10,10,40,40,40,40,40,40,40,40,216,56,56,56,10,10,10,10,57,57,57,57,59,59,59,59,216,72,216,72,10,10,10,10,72,72,72,72,72,72,72,72,216,88,216,88,10,10,10,10,88,88,88,88,88,88,88,88,216,104,216,104,10,10,10,10,104,104,104,104,104,104,104,104,216,120,216,120,10,10,10,10,120,120,120,120,120,120,120,120,216,136,216,136,10,10,10,10,8,8,136,136,8,8,136,136,216,152,216,152,10,10,10,10,152,152,152,152,152,152,152,152,216,9,216,168,10,10,10,10,168,168,168,168,168,168,168,168,205,189,216,184,10,10,10,10,185,185,185,185,187,187,187,187,217,57,216,200,10,10,10,10,200,200,200,200,200,200,200,200,217,217,216,160,10,10,10,10,216,216,216,216,216,216,216,216,29,13,232,232,10,10,10,10,232,232,232,232,232,232,232,232,253,253,248,248,10,10,10,10,248,248,248,248,248,248,248,248,221,77,224,224,10,10,10,10,136,136,8,8,136,136,8,8],16:[24,24,24,24,10,10,10,10,24,24,24,24,24,24,24,24,45,45,56,56,10,10,10,10,40,40,40,40,40,40,40,40,216,56,8,40,10,10,10,10,57,57,57,57,59,59,59,59,216,72,72,72,10,10,10,10,72,72,72,72,72,72,72,72,216,88,216,88,10,10,10,10,88,88,88,88,88,88,88,88,216,104,216,104,10,10,10,10,104,104,104,104,104,104,104,104,216,120,216,120,10,10,10,10,120,120,120,120,120,120,120,120,216,136,216,136,10,10,10,10,8,8,136,136,8,8,136,136,216,152,216,152,10,10,10,10,152,152,152,152,152,152,152,152,216,41,216,168,10,10,10,10,168,168,168,168,168,168,168,168,205,189,216,184,10,10,10,10,185,185,185,185,187,187,187,187,217,89,216,200,10,10,10,10,200,200,200,200,200,200,200,200,217,217,216,160,10,10,10,10,216,216,216,216,216,216,216,216,216,8,232,232,10,10,10,10,232,232,232,232,232,232,232,232,253,253,248,248,10,10,10,10,248,248,248,248,248,248,248,248,221,77,224,224,10,10,10,10,136,136,8,8,136,136,8,8]},br={13:Ar,16:ur},Cr=[[0,1,2,-1],[-1,0,1,2],[-2,-1,0,1],[1,-2,-1,0]];function yr(e){if(Qi(e)){const{encoding:t,metadata:s,readOnly:i}=e;return{encoding:t,metadata:Object.assign({},s),readOnly:i}}if(en(e)){const{format:t,encoding:s,metadata:i,readOnly:n,volume:r,tracks:o}=e,a={format:t,encoding:s,volume:r,tracks:[],readOnly:n,metadata:Object.assign({},i)};for(let e=0;e<o.length;e++)a.tracks.push(new Uint8Array(o[e]));return a}if(tn(e)){const{format:t,encoding:s,metadata:i,readOnly:n,trackMap:r,rawTracks:o}=e,a={format:t,encoding:s,readOnly:n,trackMap:[],rawTracks:[],metadata:Object.assign({},i),info:e.info};a.trackMap=[...r];for(let e=0;e<o.length;e++)a.rawTracks.push(new Uint8Array(o[e]));return a}throw new Error("Unknown drive state")}class wr{constructor(e,t,s=16){this.io=e,this.callbacks=t,this.sectors=s,this.drives={1:{track:0,head:0,phase:0,readOnly:!1,dirty:!1},2:{track:0,head:0,phase:0,readOnly:!1,dirty:!1}},this.disks={1:{encoding:Hi,readOnly:!1,metadata:{name:"Disk 1"}},2:{encoding:Hi,readOnly:!1,metadata:{name:"Disk 2"}}},this.driver={1:new mr(this.drives[1]),2:new mr(this.drives[2])},this.offTimeout=null,this.debug("Disk ]["),this.state={sectors:s,bus:0,latch:0,driveNo:1,on:!1,q6:!1,q7:!1,clock:0,state:2},this.updateActiveDrive(),this.initWorker()}updateActiveDrive(){this.curDrive=this.drives[this.state.driveNo],this.curDriver=this.driver[this.state.driveNo]}debug(...e){}head(){return this.curDrive.head}setPhase(e,t){this.state.on?(this.debug(`phase ${e}${t?" on":" off"}`),t&&(this.curDrive.track+=2*Cr[this.curDrive.phase][e],this.curDrive.phase=e),this.curDriver.clampTrack()):this.debug(`ignoring phase ${e}${t?" on":" off"}`)}access(e,t){const s=this.state;let i=0;const n=void 0===t;switch(143&e){case 128:this.setPhase(0,!1);break;case 129:this.setPhase(0,!0);break;case 130:this.setPhase(1,!1);break;case 131:this.setPhase(1,!0);break;case 132:this.setPhase(2,!1);break;case 133:this.setPhase(2,!0);break;case 134:this.setPhase(3,!1);break;case 135:this.setPhase(3,!0);break;case 136:this.offTimeout||s.on&&(this.offTimeout=window.setTimeout((()=>{this.debug("Drive Off"),s.on=!1,this.callbacks.driveLight(s.driveNo,!1),this.curDriver.onDriveOff()}),1e3));break;case 137:this.offTimeout&&(window.clearTimeout(this.offTimeout),this.offTimeout=null),s.on||(this.debug("Drive On"),s.on=!0,this.callbacks.driveLight(s.driveNo,!0),this.curDriver.onDriveOn());break;case 138:this.debug("Disk 1"),s.driveNo=1,this.updateActiveDrive(),s.on&&(this.callbacks.driveLight(2,!1),this.callbacks.driveLight(1,!0));break;case 139:this.debug("Disk 2"),s.driveNo=2,this.updateActiveDrive(),s.on&&(this.callbacks.driveLight(1,!1),this.callbacks.driveLight(2,!0));break;case 140:s.q6=!1,this.curDriver.onQ6Low();break;case 141:s.q6=!0,this.curDriver.onQ6High(n);break;case 142:this.debug("Read Mode"),s.q7=!1;break;case 143:this.debug("Write Mode"),s.q7=!0}return this.tick(),n?i=0==(1&e)?s.latch:0:s.bus=t,i}updateDirty(e,t){this.drives[e].dirty=t,this.callbacks.dirty&&this.callbacks.dirty(e,t)}ioSwitch(e,t){return this.access(e,t)}read(e,t){return br[this.sectors][t]}write(){}reset(){const e=this.state;e.on&&(this.callbacks.driveLight(e.driveNo,!1),e.q7=!1,e.on=!1,e.driveNo=1),this.updateActiveDrive()}tick(){this.curDriver.tick()}getDriveState(e){const t=this.drives[e],s=this.disks[e],i=this.driver[e],{readOnly:n,track:r,head:o,phase:a,dirty:l}=t;return{disk:yr(s),driver:i.getState(),readOnly:n,track:r,head:o,phase:a,dirty:l}}getState(){const e={drives:[],controllerState:Object.assign({},this.state)};return e.drives[1]=this.getDriveState(1),e.drives[2]=this.getDriveState(2),e}setDriveState(e,t){const{track:s,head:i,phase:n,readOnly:r,dirty:o}=t;this.drives[e]={track:s,head:i,phase:n,readOnly:r,dirty:o};const a=yr(t.disk);this.setDiskInternal(e,a),this.driver[e].setState(t.driver)}setState(e){this.state=Object.assign({},e.controllerState);for(const t of Gi){this.setDriveState(t,e.drives[t]);const{name:s,side:i}=e.drives[t].disk.metadata,{dirty:n}=e.drives[t];this.callbacks.label(t,s,i),this.callbacks.driveLight(t,this.state.on),this.callbacks.dirty(t,n)}this.updateActiveDrive()}getMetadata(e){const{track:t,head:s,phase:i,readOnly:n,dirty:r}=this.drives[e];return{track:t,head:s,phase:i,readOnly:n,dirty:r}}rwts(e,t,s){const i=this.disks[e];if(!en(i))throw new Error("Can't read WOZ disks");return Zn(i,t,s)}setDisk(e,t){if(this.worker){const s={type:"PROCESS_JSON_DISK",payload:{driveNo:e,jsonDisk:t}};return this.worker.postMessage(s),!0}{const s=function(e){const t=e.type,s=e.readOnly,i=e.name,n=e.disk;if(sn(Ji,t)){let r;if("base64"===e.encoding){r=[];for(let t=0;t<e.data.length;t++)if(r[t]=[],"nib"===e.type)r[t][0]=vn(e.data[t]);else for(let s=0;s<e.data[t].length;s++)r[t][s]=vn(e.data[t][s])}else r=e.data;return dr(t,{volume:e.volume||254,readOnly:s,name:i,side:n,data:r})}return null}(t);if(s)return this.insertDisk(e,s),!0}return!1}getJSON(e,t=!1){const s=this.disks[e];if(!en(s))throw new Error("Can't save WOZ disks to JSON");return function(e,t){const s=[];let i="dsk";for(let t=0;t<e.tracks.length;t++)if(s[t]=[],"nib"===e.format)i="nib",s[t]=wn(e.tracks[t]);else for(let i=0;i<16;i++){const n="po"===e.format?Sn[i]:xn[i];s[t][i]=wn(Zn(e,t,n))}return JSON.stringify({type:i,encoding:"base64",volume:e.volume,data:s,readOnly:e.readOnly},void 0,t?"    ":void 0)}(s,t)}setJSON(e,t){if(this.worker){const s={type:"PROCESS_JSON",payload:{driveNo:e,json:t}};this.worker.postMessage(s)}else{const s=function(e){const t=[],s=JSON.parse(e),i=s.volume||254,n=s.readOnly||!1;for(let e=0;e<s.data.length;e++){let n=[];for(let t=0;t<s.data[e].length;t++){const r="po"===s.type?En[t]:kn[t],o=vn(s.data[e][r]);n=n.concat(Nn(i,e,t,o))}t[e]=Fe(n)}if(!function(e){return Ji.includes(e)}(s.type))throw new Error(`JSON disks of type ${s.type} are not supported`);return{volume:i,format:s.type,encoding:Wi,metadata:{name:s.name},tracks:t,readOnly:n}}(t);this.insertDisk(e,s)}return!0}setBinary(e,t,s,i){const n={name:t,rawData:i,readOnly:!1,volume:254};if(this.worker){const t={type:"PROCESS_BINARY",payload:{driveNo:e,fmt:s,options:n}};return this.worker.postMessage(t),!0}{const t=dr(s,n);if(t)return this.insertDisk(e,t),!0}return!1}initWorker(){if(window.Worker)try{this.worker=new Worker("dist/format_worker.bundle.js"),this.worker.addEventListener("message",(e=>{const{data:t}=e;if("DISK_PROCESSED"===t.type){const{driveNo:e,disk:s}=t.payload;s&&this.insertDisk(e,s)}}))}catch(e){console.error(e)}}setDiskInternal(e,t){if(this.disks[e]=t,Qi(t))this.driver[e]=new mr(this.drives[e]);else if(en(t))this.driver[e]=new gr(e,this.drives[e],t,this.state,(()=>this.updateDirty(e,!0)));else{if(!tn(t))throw new Error(`Unknown disk format ${t.encoding}`);this.driver[e]=new fr(e,this.drives[e],t,this.state,(()=>this.updateDirty(e,!0)),this.io)}this.updateActiveDrive()}insertDisk(e,t){this.setDiskInternal(e,t),this.drives[e].head=0;const{name:s,side:i}=t.metadata;this.updateDirty(e,this.drives[e].dirty),this.callbacks.label(e,s,i)}getBinary(e,t){const s=this.disks[e];if(!en(s))return null;const{format:i,readOnly:n,tracks:r,volume:o}=s,{name:a}=s.metadata,l="nib"===i?r.reduce(((e,t)=>e+t.length),0):this.sectors*r.length*256,h=new Uint8Array(l);t=null!=t?t:i;let c=0;for(let e=0;e<r.length;e++)if("nib"===t)h.set(r[e],c),c+=r[e].length;else{let n,r;"d13"===t?(n=13,r=Rn):(n=16,r="po"===i?Sn:xn);for(let i=0;i<n;i++){const n=r[i],o=Zn(Object.assign(Object.assign({},s),{format:t}),e,n);h.set(o,c),c+=o.length}}return{ext:t,metadata:{name:a},data:h.buffer,readOnly:n,volume:o}}getBase64(e){const t=this.disks[e];if(!en(t))return null;const s=[];for(let e=0;e<t.tracks.length;e++)if(en(t))s[e]=wn(t.tracks[e]);else{const i=[];for(let s=0;s<16;s++)i[s]=wn(Zn(t,e,s));s[e]=i}return s}}const vr=new Uint8Array([162,32,162,0,162,3,162,0,32,88,255,186,189,0,1,141,248,7,10,10,10,10,168,185,128,192,74,176,17,165,0,208,10,165,1,205,248,7,208,3,76,186,250,76,0,224,162,1,134,66,202,134,70,134,71,134,68,162,8,134,69,173,248,7,72,72,169,71,72,184,80,11,104,10,10,10,10,170,76,1,8,0,0,96,0,0,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,215,83]);function kr(e,t){const{rawData:s,readOnly:i,name:n}=t;if(!s)throw new Error("Requires rawData");const r=[];let o=0;for(;o<s.byteLength;)r.push(new Uint8Array(s.slice(o,o+512))),o+=512;return{encoding:Ki,format:e,blocks:r,metadata:{name:n},readOnly:i}}const xr="SMARTPORT.J.S";class Er{constructor(e,t,s){this.cpu=e,void 0===s?(this.lo=255&t,this.hi=t>>8):(this.lo=t,this.hi=s)}loByte(){return this.lo}hiByte(){return this.hi}inc(e){return new Er(this.cpu,(this.hi<<8|this.lo)+e&65535)}readByte(){return this.cpu.read(this.hi,this.lo)}readWord(){const e=this.readByte();return this.inc(1).readByte()<<8|e}readAddress(){const e=this.readByte(),t=this.inc(1).readByte();return new Er(this.cpu,e,t)}writeByte(e){this.cpu.write(this.hi,this.lo,e)}writeWord(e){this.writeByte(255&e),this.inc(1).writeByte(e>>8)}writeAddress(e){this.writeByte(e.loByte()),this.inc(1).writeByte(e.hiByte())}toString(){return"$"+ze(this.hi)+ze(this.lo)}}class Sr{constructor(e,t,s){if(this.cpu=e,this.callbacks=t,this.disks=[],this.busy=[],this.busyTimeout=[],this.ext=[],this.metadata=[],null==s?void 0:s.block){const e=new Uint8Array(vr);e[7]=60,this.rom=e,je("DumbPort card")}else je("SmartPort card"),this.rom=vr}debug(...e){}driveLight(e){var t;this.busy[e]||(this.busy[e]=!0,null===(t=this.callbacks)||void 0===t||t.driveLight(e,!0)),clearTimeout(this.busyTimeout[e]),this.busyTimeout[e]=setTimeout((()=>{var t;this.busy[e]=!1,null===(t=this.callbacks)||void 0===t||t.driveLight(e,!1)}),100)}dumpBlock(e,t){let s,i,n="";for(let r=0;r<32;r++){for(n+=ze(r<<4,4)+": ",i=0;i<16;i++)s=this.disks[e].blocks[t][16*r+i],8===i&&(n+=" "),n+=ze(s)+" ";for(n+="        ",i=0;i<16;i++)s=127&this.disks[e].blocks[t][16*r+i],8===i&&(n+=" "),n+=s>=32&&s<127?String.fromCharCode(s):".";n+="\n"}return n}getDeviceInfo(e,t){if(this.disks[t]){const s=this.disks[t].blocks.length;e.x=255&s,e.y=s>>8,e.a=0,e.s&=-2}else e.a=40,e.s|=1}readBlock(e,t,s,i){var n;if(this.debug(`read drive=${t}`),this.debug(`read buffer=${i.toString()}`),this.debug(`read block=$${ze(s)}`),!(null===(n=this.disks[t])||void 0===n?void 0:n.blocks.length))return je("Drive",t,"is empty"),e.a=47,void(e.s|=1);this.driveLight(t);for(let e=0;e<512;e++)i.writeByte(this.disks[t].blocks[s][e]),i=i.inc(1);e.a=0,e.s&=-2}writeBlock(e,t,s,i){var n;if(this.debug(`write drive=${t}`),this.debug(`write buffer=${i.toString()}`),this.debug(`write block=$${ze(s)}`),!(null===(n=this.disks[t])||void 0===n?void 0:n.blocks.length))return je("Drive",t,"is empty"),e.a=47,void(e.s|=1);if(this.disks[t].readOnly)return je("Drive",t,"is write protected"),e.a=43,void(e.s|=1);this.driveLight(t);for(let e=0;e<512;e++)this.disks[t].blocks[s][e]=i.readByte(),i=i.inc(1);e.a=0,e.s&=-2}formatDevice(e,t){var s;if(!(null===(s=this.disks[t])||void 0===s?void 0:s.blocks.length))return je("Drive",t,"is empty"),e.a=47,void(e.s|=1);if(this.disks[t].readOnly)return je("Drive",t,"is write protected"),e.a=43,void(e.s|=1);for(let e=0;e<this.disks[t].blocks.length;e++){this.disks[t].blocks[e]=new Uint8Array;for(let s=0;s<512;s++)this.disks[t].blocks[e][s]=0}e.a=0,e.s&=1}access(e,t){let s;if(128==(143&e)&&void 0===t){s=0;for(let e=0;e<this.disks.length;e++)s<<=1,this.disks[e]&&(s|=1)}return s}ioSwitch(e,t){return this.access(e,t)}read(e,t){var s,i,n,r;const o=this.cpu.getState();let a,l,h,c;const d=this.rom[255],u=d+3;if(t===d&&this.cpu.getSync()){this.debug("block device entry"),a=this.cpu.read(0,66),l=this.cpu.read(0,67);const e=new Er(this.cpu,68),t=new Er(this.cpu,70),s=128&l?2:1,i=(112&l)>>4;switch(h=e.readAddress(),c=t.readWord(),this.debug(`cmd=${a}`),this.debug("unit=$"+ze(l)),this.debug(`slot=${i} drive=${s}`),this.debug(`buffer=${h.toString()} block=$${ze(c)}`),a){case 0:this.getDeviceInfo(o,s);break;case 1:this.readBlock(o,s,c,h);break;case 2:this.writeBlock(o,s,c,h);break;case 3:this.formatDevice(o,s)}}else if(t===u&&this.cpu.getSync()){this.debug("smartport entry");const e=new Er(this.cpu,o.sp+1,1);let t;const d=e.readAddress();this.debug(`return=${d.toString()}`);const u=d.inc(1);a=u.readByte();const A=u.inc(1).readAddress();this.debug(`cmd=${a}`),this.debug(`cmdListAddr=${A.toString()}`),e.writeAddress(d.inc(3));const m=A.readByte();l=A.inc(1).readByte();const p=l?2:1;let g;switch(h=A.inc(2).readAddress(),this.debug(`parameterCount=${m}`),a){case 0:if(g=A.inc(4).readByte(),this.debug(`info unit=${l}`),this.debug(`info buffer=${h.toString()}`),this.debug(`info status=${g}`),0===l)0===g&&(h.writeByte(2),h.inc(1).writeByte(64),h.inc(2).writeByte(2),h.inc(3).writeByte(0),h.inc(4).writeByte(0),h.inc(5).writeByte(0),h.inc(6).writeByte(0),h.inc(7).writeByte(0),o.x=8,o.y=0,o.a=0,o.s&=-2);else switch(g){case 0:t=null!==(i=null===(s=this.disks[l])||void 0===s?void 0:s.blocks.length)&&void 0!==i?i:0,h.writeByte(240),h.inc(1).writeByte(255&t),h.inc(2).writeByte((65280&t)>>8),h.inc(3).writeByte((16711680&t)>>16),o.x=4,o.y=0,o.a=0,o.s&=-2;break;case 3:t=null!==(r=null===(n=this.disks[l])||void 0===n?void 0:n.blocks.length)&&void 0!==r?r:0,h.writeByte(240),h.inc(1).writeByte(255&t),h.inc(2).writeByte((65280&t)>>8),h.inc(3).writeByte((16711680&t)>>16),h.inc(4).writeByte(xr.length);for(let e=0;e<xr.length;e++)h.inc(5+e).writeByte(xr.charCodeAt(e));h.inc(21).writeByte(7),h.inc(22).writeByte(0),h.inc(23).writeWord(257),o.x=24,o.y=0,o.a=0,o.s&=-2}o.a=0,o.s&=-2;break;case 1:c=A.inc(4).readWord(),this.readBlock(o,p,c,h);break;case 2:c=A.inc(4).readWord(),this.writeBlock(o,p,c,h);break;case 3:this.formatDevice(o,p)}}return this.cpu.setState(o),this.rom[t]}write(){}getState(){return{disks:this.disks.map((e=>({blocks:e.blocks.map((e=>new Uint8Array(e))),encoding:Ki,format:e.format,readOnly:e.readOnly,metadata:Object.assign({},e.metadata)})))}}setState(e){this.disks=e.disks.map((e=>({blocks:e.blocks.map((e=>new Uint8Array(e))),encoding:Ki,format:e.format,readOnly:e.readOnly,metadata:Object.assign({},e.metadata)})))}setBinary(e,t,s,i){var n;let r=254,o=!1;if("2mg"===s){const t=qn(i);this.metadata[e]=t;const{bytes:s,offset:n}=t;r=t.volume,o=t.readOnly,i=i.slice(n,n+s)}else this.metadata[e]=null;const a={rawData:i,name:t,readOnly:o,volume:r};return this.ext[e]=s,this.disks[e]=kr(s,a),null===(n=this.callbacks)||void 0===n||n.label(e,t),!0}getBinary(e){if(!this.disks[e])return null;const t=this.disks[e],s=this.ext[e],{readOnly:i}=t,{name:n}=t.metadata;let r;if("2mg"===s)r=((e,{blocks:t})=>{const{prefix:s,suffix:i}=((e,{blocks:t})=>{if(e||(e={bytes:512*t,creator:"A2JS",format:Vn.ProDOS,offset:64,readOnly:!1,volume:0}),e.format!==Vn.ProDOS)throw new Error("Nibble formats not supported yet");if(e.bytes!==512*t)throw new Error("Byte count does not match block count");const s=new Uint8Array(64),i=new DataView(s.buffer),n=(e.volume?e.volume|Jn.VOLUME_VALID:0)|(e.readOnly?Jn.READ_ONLY:0),r=s.length,o=512*t;let a=0,l=0,h=new Uint8Array(0);e.comment&&(h=(new TextEncoder).encode(e.comment),a=r+o,l=h.length);let c=0,d=0,u=new Uint8Array(0);e.creatorData&&(u=new Uint8Array(e.creatorData),c=r+o+l,d=e.creatorData.length);const A=new TextEncoder;s.set(A.encode("2IMG"),Kn.SIGNATURE),s.set(A.encode(e.creator.slice(0,4)),Kn.CREATOR),i.setInt32(Kn.HEADER_LENGTH,64,!0),i.setInt16(Kn.VERSION,1,!0),i.setInt32(Kn.FORMAT,e.format,!0),i.setInt32(Kn.FLAGS,n,!0),i.setInt32(Kn.BLOCKS,t,!0),i.setInt32(Kn.DATA_OFFSET,r,!0),i.setInt32(Kn.DATA_LENGTH,o,!0),i.setInt32(Kn.COMMENT,a,!0),i.setInt32(Kn.COMMENT_LENGTH,l,!0),i.setInt32(Kn.CREATOR_DATA,c,!0),i.setInt32(Kn.CREATOR_DATA_LENGTH,d,!0);const m=new Uint8Array(l+d);return m.set(h),m.set(u,l),{prefix:s,suffix:m}})(e,{blocks:t.length}),n=s.length+512*t.length+i.length,r=new Uint8Array(n);r.set(s);for(let e=0;e<t.length;e++)r.set(t[e],s.length+512*e);return r.set(i,s.length+512*t.length),r.buffer})(this.metadata[e],t);else{const{blocks:e}=t,s=new Uint8Array(512*e.length);for(let t=0;t<e.length;t++)s.set(e[t],512*t);r=s.buffer}return{metadata:{name:n},ext:s,data:r,readOnly:i}}}const Pr=512,Rr={DELETED:0,SEEDLING:1,SAPLING:2,TREE:3,PASCAL:4,EXTENDED:5,DIRECTORY:13,SUBDIRECTORY_HEADER:14,VDH_HEADER:15},Tr={0:"UNK",1:"BAD",2:"PDC",3:"PTX",4:"TXT",5:"PDA",6:"BIN",7:"FNT",8:"FOT",9:"BA3",10:"DA3",11:"WPF",12:"SOS",15:"DIR",16:"RPD",17:"RPI",18:"AFD",19:"AFM",20:"ARF",21:"SCL",25:"ADB",26:"AWP",27:"ASP",239:"PAR",240:"CMD",250:"INT",251:"IVR",252:"BAS",253:"VAR",254:"REL",255:"SYS"};class Ir{constructor(e){this.volume=e}}class Dr extends Ir{constructor(e,t){super(e),this.fileEntry=t,this.blocks=this.volume.blocks(),this.bitMap=this.volume.bitMap()}getBlockPointers(){const e=this.blocks[this.fileEntry.keyPointer],t=new DataView(e),s=[this.fileEntry.keyPointer];for(let e=0;e<256;e++){const i=t.getUint8(e)|t.getUint8(256+e)<<8;i&&s.push(i)}return s}read(){const e=this.blocks[this.fileEntry.keyPointer],t=new DataView(e.buffer);let s=this.fileEntry.eof;const i=new Uint8Array(s);let n=0,r=0;for(;s>0;){const e=t.getUint8(r)|t.getUint8(256+r)<<8;if(e){const t=this.blocks[e].slice(0,Math.min(Pr,s));i.set(t,n)}r++,n+=Pr,s-=Pr}return i}write(e){this.fileEntry.storageType=Rr.SAPLING,this.fileEntry.keyPointer=this.bitMap.allocBlock(),this.fileEntry.eof=e.byteLength;const t=this.blocks[this.fileEntry.keyPointer],s=new DataView(t);let i=e.byteLength,n=0,r=0;for(;i>0;){const t=this.bitMap.allocBlock();s.setUint8(r,255&t),s.setUint8(256+r,t>>8),this.blocks[t].set(e.slice(n,Math.min(Pr,i))),r++,n+=Pr,i-=Pr}this.fileEntry.write()}delete(){const e=this.getBlockPointers();for(let t=0;t<e.length;t++)this.bitMap.freeBlock(e[t])}}class Br extends Ir{constructor(e,t){super(e),this.fileEntry=t,this.blocks=e.blocks(),this.bitMap=e.bitMap()}getBlockPointers(){return[this.fileEntry.keyPointer]}read(){const e=this.blocks[this.fileEntry.keyPointer],t=new Uint8Array(this.fileEntry.eof);return t.set(e.slice(0,this.fileEntry.eof)),t}write(e){this.fileEntry.keyPointer&&this.delete(),this.fileEntry.storageType=Rr.SEEDLING,this.fileEntry.keyPointer=this.bitMap.allocBlock(),this.fileEntry.eof=e.byteLength,this.blocks[this.fileEntry.keyPointer].set(e),this.fileEntry.write()}delete(){const e=this.getBlockPointers();for(let t=0;t<e.length;t++)this.bitMap.freeBlock(e[t])}}class Mr extends Ir{constructor(e,t){super(e),this.fileEntry=t,this.blocks=e.blocks(),this.bitMap=e.bitMap()}getBlockPointers(){const e=this.blocks[this.fileEntry.keyPointer],t=new DataView(e),s=[];for(let e=0;e<256;e++){const i=t.getUint8(e)|t.getUint8(256+e)<<8;if(i){s.push(i);const t=new DataView(this.blocks[i]);for(let i=0;i<256;i++){const i=t.getUint8(e)|t.getUint8(256+e)<<8;i&&s.push(i)}}}return s}read(){const e=this.blocks[this.fileEntry.keyPointer],t=new DataView(e);let s=this.fileEntry.eof;const i=new Uint8Array(s);let n=0,r=0;for(;s>0;){const e=t.getUint8(r)|t.getUint8(256+r)<<8;let o=0;if(e){const t=this.blocks[e],a=new DataView(t);for(;o<256&&s>0;){const e=a.getUint8(r)|a.getUint8(256+r)<<8;if(e){const t=this.blocks[e].slice(Math.min(Pr,s));i.set(t,n)}o++,n+=Pr,s-=Pr}}else n+=131072,s-=131072;r++}return i}write(e){this.fileEntry.storageType=Rr.TREE,this.fileEntry.keyPointer=this.bitMap.allocBlock(),this.fileEntry.eof=e.byteLength;const t=this.blocks[this.fileEntry.keyPointer],s=new DataView(t);let i=this.fileEntry.eof,n=0,r=0;for(;i>0;){const t=this.bitMap.allocBlock(),o=this.blocks[t];s.setUint8(r,255&t),s.setUint8(256+r,t>>8);const a=new DataView(o);let l=0;for(;l<256&&i>0;){const t=this.bitMap.allocBlock();a.setUint8(r,255&t),a.setUint8(256+r,t>>8),this.blocks[t].set(e.slice(n,Math.min(Pr,i))),l++,n+=Pr,i-=Pr}r++}this.fileEntry.write()}delete(){const e=this.getBlockPointers();for(let t=0;t<e.length;t++)this.bitMap.freeBlock(e[t])}}const Or=21;class Nr{constructor(e){this.volume=e,this.storageType=Rr.SEEDLING,this.name="Untitled",this.fileType=0,this.auxType=0,this.blocksUsed=0,this.eof=0,this.access=227,this.creation=new Date,this.lastMod=new Date,this.keyPointer=0,this.headerPointer=0}read(e,t){this.block=e,this.offset=t,this.storageType=e.getUint8(t+0)>>4;const s=15&e.getUint8(t+0),i=e.getUint16(t+28,!0);this.name=Xr(e,t+1,s,i),this.fileType=e.getUint8(t+16),this.keyPointer=e.getUint16(t+17,!0),this.blocksUsed=e.getUint16(t+19,!0),this.eof=e.getUint8(t+Or)|e.getUint8(t+Or+1)<<8|e.getUint8(t+Or+2)<<16,this.creation=jr(e.getUint32(t+24,!0)),this.access=e.getUint8(t+30),this.auxType=e.getUint16(t+31,!0),this.lastMod=jr(e.getUint32(t+33,!0)),this.headerPointer=e.getUint16(t+37,!0)}write(e,t){this.block=null!=e?e:this.block,this.offset=null!=t?t:this.offset;const s=15&this.name.length;this.block.setUint8(this.offset+0,this.storageType<<4&s);const i=Zr(this.block,this.offset+1,this.name);this.block.setUint16(this.offset+28,i),this.block.setUint8(this.offset+16,this.fileType),this.block.setUint16(this.offset+17,this.keyPointer,!0),this.block.setUint16(this.offset+19,this.blocksUsed,!0),this.block.setUint8(this.offset+Or,255&this.eof),this.block.setUint8(this.offset+Or+1,(this.eof&&65280)>>8),this.block.setUint8(this.offset+Or+2,this.eof>>16),this.block.setUint32(this.offset+24,zr(this.creation),!0),this.block.setUint8(this.offset+30,this.access),this.block.setUint16(this.offset+31,this.auxType,!0),this.block.setUint32(this.offset+33,zr(this.lastMod),!0),this.block.setUint16(this.offset+37,this.headerPointer,!0)}getFileData(){let e=null;switch(this.storageType){case Rr.SEEDLING:e=new Br(this.volume,this);break;case Rr.SAPLING:e=new Dr(this.volume,this);break;case Rr.TREE:e=new Mr(this.volume,this)}if(e)return e.read()}getFileText(){const e=this.getFileData();let t=null,s=0;if(e)if(252===this.fileType)t=new vi(e,0).decompile();else{6===this.fileType&&(s=this.auxType),t="";let i="",n="";for(let r=0;r<e.length;r++){const o=e[r];r%16==0&&(0!==r&&(t+=`${i}    ${n}\n`),i="",n="",t+=`${ze(s+r,4)}:`),i+=` ${ze(o)}`,n+=(127&o)>=32?String.fromCharCode(127&o):"."}t+="\n"}return t}}function Lr(e,t,s){const i=e.blocks(),n=[];let r=s.entryLength+4,o=2,a=s.next;for(let l=0;l<s.fileCount;){const h=new Nr(e);h.read(t,r),n.push(h),h.storageType!==Rr.DELETED&&l++,r+=s.entryLength,o++,o>s.entriesPerBlock&&(a=(t=new DataView(i[a].buffer)).getUint16(2,!0),r=4,o=1)}return n}function Ur(e,t,s){const i=e.blocks(),n=e.bitMap();let r=s.entryLength+4,o=2,a=s.next;for(let e=0;e<s.fileCount;e++)if(s.entries[e].write(t,r),r+=s.entryLength,o++,o>=s.entriesPerBlock){const e=a;a||(a=n.allocBlock()),(t=new DataView(i[a].buffer)).setUint16(0,e,!0),a=t.getUint16(2,!0),r=4,o=0}for(a=t.getUint16(2,!0),t.setUint16(2,0,!0);a;)t=new DataView(i[a].buffer),n.freeBlock(a),a=t.getUint16(2,!0)}class Fr{constructor(e,t){this.volume=e,this.fileEntry=t,this.prev=0,this.next=0,this.storageType=Rr.DIRECTORY,this.name="Untitled",this.creation=new Date,this.access=227,this.entryLength=39,this.entriesPerBlock=23,this.fileCount=0,this.parent=0,this.parentEntryLength=0,this.parentEntryNumber=0,this.entries=[],this.blocks=this.volume.blocks(),this.vdh=this.volume.vdh(),this.read()}read(e){this.fileEntry=null!=e?e:this.fileEntry;const t=new DataView(this.blocks[this.fileEntry.keyPointer].buffer);this.prev=t.getUint16(0,!0),this.next=t.getUint16(2,!0),this.storageType=t.getUint8(4)>>4;const s=15&t.getUint8(4),i=t.getUint8(32);this.name=Xr(t,5,s,i),this.creation=jr(t.getUint32(28,!0)),this.access=t.getUint8(34),this.entryLength=t.getUint8(35),this.entriesPerBlock=t.getUint8(36),this.fileCount=t.getUint16(37,!0),this.parent=t.getUint16(39,!0),this.parentEntryNumber=t.getUint8(41),this.parentEntryLength=t.getUint8(42),this.entries=Lr(this.volume,t,this)}write(){const e=new DataView(this.blocks[this.fileEntry.keyPointer].buffer),t=15&this.name.length;e.setUint8(4,this.storageType<<4&t);const s=Zr(e,5,this.name);e.setUint32(28,zr(this.creation),!0),e.setUint16(32,s),e.setUint8(34,this.access),e.setUint8(35,this.entryLength),e.setUint8(36,this.entriesPerBlock),e.setUint16(37,this.fileCount,!0),e.setUint16(39,this.parent,!0),e.setUint8(41,this.parentEntryNumber),e.setUint8(42,this.parentEntryLength),Ur(this.volume,e,this.vdh)}}function jr(e){if(e){const t=65535&e,s=e>>16,i=t>>9;return new Date(i<70?2e3+i:1900+i,((480&t)>>5)-1,31&t,s>>8,255&s)}return new Date(0)}function zr(e){let t=0;if(e){const s=e.getFullYear()-1900,i=e.getMonth()+1,n=e.getDate();t=(e.getHours()<<8|e.getMinutes())<<16|s<<9|i<<5|n}return t}function Xr(e,t,s,i){let n="";32768&i||(i=0),0===s&&(s=15);for(let r=0;r<s;r++){i<<=1;const s=String.fromCharCode(127&e.getUint8(t+r));n+=32768&i?s.toLowerCase():s}return n}function Zr(e,t,s){let i=0;for(let n=0;n<s.length;n++){i<<=1;let r=s.charCodeAt(n);r>96&&r<123&&(i|=1,r-=32),e.setUint8(t+n,r)}return i}class Gr{constructor(e){this.volume=e,this.prev=0,this.next=0,this.storageType=Rr.VDH_HEADER,this.name="",this.creation=new Date,this.access=227,this.entryLength=39,this.entriesPerBlock=23,this.fileCount=0,this.bitMapPointer=0,this.totalBlocks=0,this.entries=[],this.blocks=this.volume.blocks()}read(){const e=new DataView(this.blocks[2].buffer);this.next=e.getUint16(2,!0),this.storageType=e.getUint8(4)>>4;const t=15&e.getUint8(4),s=e.getUint8(26);this.name=Xr(e,5,t,s),this.creation=jr(e.getUint32(28,!0)),this.access=e.getUint8(34),this.entryLength=e.getUint8(35),this.entriesPerBlock=e.getUint8(36),this.fileCount=e.getUint16(37,!0),this.bitMapPointer=e.getUint16(39,!0),this.totalBlocks=e.getUint16(41,!0),this.entries=Lr(this.volume,e,this)}write(){const e=new DataView(this.blocks[2].buffer),t=15&this.name.length;e.setUint8(4,this.storageType<<4&t);const s=Zr(e,5,this.name);e.setUint32(28,zr(this.creation),!0),e.setUint16(26,s),e.setUint8(34,this.access),e.setUint8(35,this.entryLength),e.setUint8(36,this.entriesPerBlock),e.setUint16(37,this.fileCount,!0),e.setUint16(39,this.bitMapPointer,!0),e.setUint16(41,this.totalBlocks,!0),Ur(this.volume,e,this)}}const Hr=4096;class Wr{constructor(e){this.vdh=e.vdh(),this.blocks=e.blocks()}freeBlocks(){const e=[];let t=0,s=0,i=0,n=this.blocks[this.vdh.bitMapPointer+t];for(let r=0;r<this.vdh.totalBlocks;r++)n[s]&1<<i&&e.push(r),i+=1,i>7&&(i=0,s+=1,s>512&&(s=0,t+=1,n=this.blocks[this.vdh.bitMapPointer+t]));return e}allocBlock(){for(let e=0;e<this.vdh.totalBlocks;e++){const t=Math.floor(e/Hr),s=this.blocks[this.vdh.bitMapPointer+t],i=e-t*Hr>>8,n=s[i];if(255!==n){let t=1;for(let r=0;r<8;r++){if(!(n&t))return s[i]|=t,e;t<<=1}}}throw new Error("Disk full")}freeBlock(e){if(e>=this.vdh.totalBlocks)throw new Error("Block out of range");const t=Math.floor(e/Hr),s=e-t*Hr>>8,i=7&e;this.blocks[this.vdh.bitMapPointer+t][s]&=255^1<<i}}class Yr{constructor(e){this._disk=e}disk(){return this._disk}blocks(){return this._disk.blocks}vdh(){return this._vdh||(this._vdh=new Gr(this),this._vdh.read()),this._vdh}bitMap(){return this._bitMap||(this._bitMap=new Wr(this)),this._bitMap}}var Kr=n(3313),Jr={};Jr.styleTagTransform=ae(),Jr.setAttributes=ie(),Jr.insert=te().bind(null,"head"),Jr.domAPI=Q(),Jr.insertStyleElement=re(),q()(Kr.Z,Jr);const Vr=Kr.Z&&Kr.Z.locals?Kr.Z.locals:void 0,qr={0:"HIMEM:",1:"$01",2:"_",3:":",4:"LOAD",5:"SAVE",6:"CON",7:"RUN",8:"RUN",9:"DEL",10:",",11:"NEW",12:"CLR",13:"AUTO",14:",",15:"MAN",16:"HIMEM:",17:"LOMEM:",18:"+",19:"-",20:"*",21:"/",22:"=",23:"#",24:">=",25:">",26:"<=",27:"<>",28:"<",29:"AND",30:"OR",31:"MOD",32:"^",33:"+",34:"(",35:",",36:"THEN",37:"THEN",38:",",39:",",40:'"',41:'"',42:"(",43:"!",44:"!",45:"(",46:"PEEK",47:"RND",48:"SGN",49:"ABS",50:"PDL",51:"RNDX",52:"(",53:"+",54:"-",55:"NOT",56:"(",57:"=",58:"#",59:"LEN(",60:"ASC(",61:"SCRN(",62:",",63:"(",64:"$",65:"$",66:"(",67:",",68:",",69:";",70:";",71:";",72:",",73:",",74:",",75:"TEXT",76:"GR",77:"CALL",78:"DIM",79:"DIM",80:"TAB",81:"END",82:"INPUT",83:"INPUT",84:"INPUT",85:"FOR",86:"=",87:"TO",88:"STEP",89:"NEXT",90:",",91:"RETURN",92:"GOSUB",93:"REM",94:"LET",95:"GOTO",96:"IF",97:"PRINT",98:"PRINT",99:"PRINT",100:"POKE",101:",",102:"COLOR=",103:"PLOT",104:",",105:"HLIN",106:",",107:"AT",108:"VLIN",109:",",110:"AT",111:"VTAB",112:"=",113:"=",114:")",115:")",116:"LIST",117:",",118:"LIST",119:"POP",120:"NODSP",121:"NODSP",122:"NOTRACE",123:"DSP",124:"DSP",125:"TRACE",126:"PR#",127:"IN#"};class $r{constructor(e){this.data=e}readByte(e){return this.data[e]}readWord(e){const t=this.readByte(e);return this.readByte(e+1)<<8|t}toString(){let e="",t=0;const s=this.data.length;do{let s=!1,i=!1,n=!1;this.readByte(t++);const r=this.readWord(t);t+=2,e+=r,e+=" ";let o=0;do{if(o=this.readByte(t++),!s&&!i&&!n&&o>=176&&o<=185)e+=this.readWord(t),t+=2;else if(o<128&&o>1){const t=qr[o];t.length>1&&(e+=" "),e+=t,t.length>1&&(e+=" "),40===o&&(i=!0),41===o&&(i=!1),93===o&&(s=!0),n=!1}else if(o>128){const t="                                 !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~ "[o-128];e+=t,n=/[A-Z0-9]/.test(t)}}while(1!==o);e+="\n"}while(t<s);return e}}const Qr={track:17,sector:0},eo=1,to=2,so=3,io=6,no=39,ro=48,oo=49,ao=52,lo=53,ho=54,co=55;function uo(e){return!!e.encoding}class Ao{constructor(e){this.disk=e,this.vtoc=this.readVolumeTOC()}rwts(e,t,s){if(s)if(uo(this.disk))!function(e,t,s,i){jn(e,t,s)}(this.disk,e,xn[t]);else{const i=4096*e+256*t;new Uint8Array(this.disk.data).set(s,i)}else if(uo(this.disk))s=Zn(this.disk,e,xn[t]);else{const i=4096*e+256*t;s=new Uint8Array(this.disk.data.slice(i,i+256))}return s}dumpSector(e,t){let s="";const i=this.rwts(e,t);let n;for(let e=0;e<16;e++){s+=ze(e<<4)+": ";for(let t=0;t<16;t++)n=i[16*e+t],s+=ze(n)+" ";s+="        ";for(let t=0;t<16;t++)n=127&i[16*e+t],s+=n>=32&&n<127?String.fromCharCode(n):".";s+="\n"}return s}readFileTrackSectorList(e,t){const s=[];let{track:i,sector:n}=e.trackSectorList;for(;i||n;){t&&s.push({track:i,sector:n});let e=0;const r=this.rwts(i,n);i=r[1],n=r[2];let o=12;for(;(r[o]||r[o+1])&&e<121;)s.push({track:r[o],sector:r[o+1]}),o+=2,e++}return s}readFile(e){let t,s=[];const i=this.readFileTrackSectorList(e);for(t=0;t<i.length;t++){const{track:e,sector:n}=i[t];s=s.concat([...this.rwts(e,n)])}let n=0,r=0,o=0;switch(e.type){case"I":case"A":n=2,r=s[0]|s[1]<<8;break;case"T":for(r=0;s[r];)r++;break;case"B":n=4,o=s[0]|s[1]<<8,r=s[2]|s[3]<<8}return s=s.slice(n,n+r),{data:new Uint8Array(s),address:o}}allocateSector(){const{vtoc:e}=this,t=t=>e.trackSectorMap[t].findIndex((e=>e));let s=e.lastAllocationTrack,i=t(s);for(;-1===i;){if(1===e.allocationDirection)s-=1,s<0&&(s=e.catalog.track,e.allocationDirection=255);else if(s+=1,s>=e.trackCount)throw new Error("Insufficient free space");i=t(s)}return e.lastAllocationTrack=s,e.trackSectorMap[s][i]=!1,{track:s,sector:i}}freeSectorCount(){return this.vtoc.trackSectorMap.reduce(((e,t)=>e+t.reduce(((e,t)=>e+(t?1:0)),0)),0)}usedSectorCount(){return this.vtoc.trackSectorMap.reduce(((e,t)=>e+t.reduce(((e,t)=>e+(t?0:1)),0)),0)}writeFile(e,t){let s=[],{data:i}=t;switch(e.type){case"A":case"I":s=[i.length%256,i.length>>8];break;case"B":s=[t.address%256,t.address>>8,i.length%256,i.length>>8]}i=new Uint8Array(s.length+i.length),i.set(s),i.set(i,s.length);const{sectorByteCount:n,trackSectorListSize:r}=this.vtoc,o=Math.ceil(i.length/n),a=o+Math.ceil(o/r);let l,h=[];if(e.trackSectorList&&(h=this.readFileTrackSectorList(e,!0)),h.length>a){for(l=a;l<h.length;l++){const{track:e,sector:t}=h[l];this.vtoc.trackSectorMap[e][t]=!0}h=h.slice(0,a)}if(h.length<a)for(l=h.length;l<a;l++)h.push(this.allocateSector());e.trackSectorList=Object.assign({},h[0]),e.size=a;let c=0,d=null;for(l=0;l<o;l++){let e,t;const{trackSectorListSize:s}=this.vtoc;if(l%s==0){for(e=h.shift(),t=new Uint8Array,d&&(d[1]=e.track,d[2]=e.sector),t[5]=255&l,t[6]=l>>8,c=0;c<s&&c<h.length;c++){const e=12+2*c;t[e]=h[c].track,t[e+1]=h[c].sector}d=t,this.rwts(e.track,e.sector,new Uint8Array(t))}e=h.shift(),t=new Uint8Array(256),t.set(i.slice(0,256)),i=i.slice(256),this.rwts(e.track,e.sector,t)}this.writeVolumeTOC(),this.writeCatalog()}dumpFile(e){let t=null;const s=this.readFile(e);switch(e.type){case"A":t=new vi(s.data,0).decompile();break;case"I":t=new $r(s.data).toString();break;case"T":t="";for(let e=0;e<s.data.length;e++){const i=127&s.data[e];t+=i<32?13===i?"\n":`$${ze(i)}`:String.fromCharCode(i)}break;default:{t="";let e="",i="";for(let n=0;n<s.data.length;n++){const r=s.data[n];n%16==0&&(0!==n&&(t+=`${e}    ${i}\n`),e="",i="",t+=`${ze(s.address+n,4)}:`),e+=` ${ze(r)}`,i+=(127&r)>=32?String.fromCharCode(127&r):"."}t+="\n"}}return t}readVolumeTOC(e=Qr){const t=this.rwts(e.track,e.sector);this.vtoc={catalog:{track:t[eo],sector:t[to]},version:t[so],volume:t[io],trackSectorListSize:t[no],lastAllocationTrack:t[ro],allocationDirection:t[oo],trackCount:t[ao],sectorCount:t[lo],sectorByteCount:t[ho]|t[co]<<8,trackSectorMap:[]};for(let e=0;e<this.vtoc.trackCount;e++){const s=[],i=56+4*e;let n=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3];for(let e=0;e<this.vtoc.sectorCount;e++)s.unshift(!!(2147483648&n)),n<<=1;this.vtoc.trackSectorMap.push(s)}return je(`DISK VOLUME ${this.vtoc.volume}`),this.vtoc}writeVolumeTOC(e=Qr){const{vtoc:t}=this,s=new Uint8Array(256).fill(0);s[eo]=t.catalog.track,s[to]=t.catalog.sector,s[so]=t.version||3,s[io]=t.volume||254,s[no]=t.trackSectorListSize||122,s[ro]=t.lastAllocationTrack,s[oo]=t.allocationDirection,s[ao]=t.trackCount,s[lo]=t.sectorCount,s[ho]=255&t.sectorByteCount,s[co]=t.sectorByteCount>>8;for(let e=0;e<t.trackSectorMap.length;e++){const i=56+4*e,n=t.trackSectorMap[e];let r=0;for(let e=0;e<n.length;e++)r>>=1,n[e]&&(r|=2147483648);s[i]=r>>24&255,s[i+1]=r>>16&255,s[i+2]=r>>8&255,s[i+3]=255&r}this.rwts(e.track,e.sector,s)}readCatalog(){const{catalog:e}=this.vtoc;this.files=[];let t=e.track,s=e.sector;for(;s||t;){const e=this.rwts(t,s);t=e[1],s=e[2];for(let t=11;t<256;t+=35){const s={locked:!1,deleted:!1,type:"A",size:0,name:"",trackSectorList:{track:0,sector:0}};let i="";const n=e.slice(t,t+35);if(n[0]){switch(s.trackSectorList={track:n[0],sector:n[1]},255===s.trackSectorList.track&&(s.deleted=!0,s.trackSectorList.track=n[32]),128&n[2]&&(s.locked=!0),i+=s.locked?"*":" ",127&n[2]){case 0:s.type="T";break;case 1:s.type="I";break;case 2:case 32:s.type="A";break;case 4:case 64:s.type="B";break;case 8:s.type="S";break;case 16:s.type="R"}i+=s.type,i+=" ",s.size=n[33]|n[34]<<8,i+=Math.floor(s.size/100),i+=Math.floor(s.size/10)%10,i+=s.size%10,i+=" ";for(let e=3;e<33;e++)s.name+=String.fromCharCode(127&n[e]);i+=s.name,je(i),this.files.push(s)}}}return this.files}writeCatalog(){const{catalog:e}=this.vtoc;let t=e.track,s=e.sector;for(;s||t;){const e=this.rwts(t,s);for(let t=11;t<256;t+=0){const s=this.files.shift();if(null==s?void 0:s.trackSectorList){switch(e[t+0]=s.trackSectorList.track,e[t+1]=s.trackSectorList.sector,e[t+2]=s.locked?128:0,s.type){case"T":break;case"I":e[t+2]|=1;break;case"A":e[t+2]|=2;break;case"B":e[t+2]|=4;break;case"S":e[t+2]|=8;break;case"R":e[t+2]|=16}e[t+33]=255&s.size,e[t+34]=s.size>>8;for(let i=0;i<30;i++)e[t+3+i]=128|s.name.charCodeAt(i)}}this.rwts(t,s,e),t=e[1],s=e[2]}}getVolumeNumber(){return this.vtoc.volume}}var mo=n(6500),po={};po.styleTagTransform=ae(),po.setAttributes=ie(),po.insert=te().bind(null,"head"),po.domAPI=Q(),po.insertStyleElement=re(),q()(mo.Z,po);const go=mo.Z&&mo.Z.locals?mo.Z.locals:void 0,fo=({binary:e})=>{const t=xe(null);if(e.byteLength<8184||e.byteLength>8192)return null;if(t.current){const s=new st(t.current,!0),i=new et(s,1,new Uint8Array,!1),n=new tt(s,1);s.setLoresPage(1,i),s.setHiresPage(1,n),s.text(!1),s.hires(!0),s.doubleHires(!1),s.page(1);for(let t=0;t<32;t++)for(let s=0;s<256;s++)n.write(t+32,s,e[256*t+s]);s.blit()}return A("canvas",{ref:t,width:560,height:384,className:go.hiresPreview})},_o=({binary:e})=>{const t=xe(null);if(e.byteLength<16376||e.byteLength>16384)return null;if(t.current){const s=new st(t.current,!0),i=new et(s,1,new Uint8Array,!1),n=new tt(s,1);s.setLoresPage(1,i),s.setHiresPage(1,n),s.text(!1),s.hires(!0),s._80col(!0),s.doubleHires(!0),s.page(1);for(let t=0;t<32;t++)for(let s=0;s<256;s++)n.bank1().write(t+32,s,e[256*t+s]);for(let t=32;t<64;t++)for(let s=0;s<256;s++)n.bank0().write(t,s,e[256*t+s]);s.blit()}return A("canvas",{ref:t,width:560,height:384,className:go.hiresPreview})},bo=({fileData:e,onClose:t})=>{const[s,i]=ve(""),[n,r]=ve("");if(ke((()=>{if(e){const{binary:t,text:s}=e,n=new Blob([t],{type:"application/octet-stream"}),o=window.URL.createObjectURL(n);i(o);const a=new Blob([s],{type:"application/octet-stream"}),l=window.URL.createObjectURL(a);r(l)}}),[e]),!e)return null;const{fileName:o,text:a,binary:l}=e;return A(p,null,A(Us,{isOpen:!0,onClose:t,title:o},A(Ms,null,A("div",{className:go.fileViewer},A(fo,{binary:l}),A(_o,{binary:l}),A("pre",{className:go.textViewer,tabIndex:-1},a))),A(Os,null,A("a",{download:`${o}.bin`,href:s,role:"button"},"Download Raw"),A("a",{download:`${o}.txt`,href:n,role:"button"},"Download Text"),A("button",{onClick:t},"Close"))))},Co=e=>e.toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}),yo=({depth:e,fileEntry:t,setFileData:s})=>{var i;const n=t.storageType===Rr.DELETED,r=Se((()=>{const e=t.getFileData(),i=t.getFileText();e&&i&&s({binary:e,text:i,fileName:t.name})}),[t,s]);return A("tr",null,A("td",{className:J()(Vr.filename,{[Vr.deleted]:n}),title:t.name,onClick:r},"| ".repeat(e),A("i",n?{className:"fas fa-file-circle-xmark"}:{className:"fas fa-file"})," ",t.name),A("td",null,null!==(i=Tr[t.fileType])&&void 0!==i?i:`$${ze(t.fileType)}`),A("td",null,`$${ze(t.auxType,4)}`),A("td",null,t.blocksUsed),A("td",null,Co(t.creation)),A("td",null,Co(t.lastMod)))},wo=({volume:e,depth:t,dirEntry:s,setFileData:i})=>{const[n,r]=ve(0===t);return A(p,null,A("tr",null,A("td",{className:Vr.filename,onClick:()=>r((e=>!e)),title:s.name},"| ".repeat(t),A("i",{className:J()("fas",{"fa-folder-open":n,"fa-folder-closed":!n})})," ",s.name),A("td",null),A("td",null),A("td",null),A("td",null,Co(s.creation)),A("td",null)),n&&s.entries.map(((s,n)=>{if(s.storageType===Rr.DIRECTORY){const r=new Fr(e,s);return A(wo,{key:n,depth:t+1,volume:e,dirEntry:r,setFileData:i})}return A(yo,{key:n,depth:t+1,volume:e,fileEntry:s,setFileData:i})})))},vo=({dos:e,fileEntry:t,setFileData:s})=>A("tr",{onClick:Se((()=>{const{data:i}=e.readFile(t);s({binary:i,text:e.dumpFile(t),fileName:t.name})}),[e,t,s])},A("td",{className:J()(Vr.filename,{[Vr.deleted]:t.deleted})},t.locked&&A("i",{className:"fas fa-lock"})," ",t.name),A("td",null,t.type),A("td",null,t.size),A("td",null)),ko=({dos:e,setFileData:t})=>A(p,null,Ee((()=>e.readCatalog()),[e]).map(((s,i)=>A(vo,{key:i,dos:e,fileEntry:s,setFileData:t})))),xo=({massStorage:e,driveNo:t,setFileData:s})=>{const i=Ee((()=>{const s=e.getBinary(t,"po");if(s){const{data:i,readOnly:n,ext:r}=s,{name:o}=s.metadata;let a=null;if("2mg"===r)a=$n({name:o,rawData:i,readOnly:n,volume:254});else if(i.byteLength<819200){const s=e.getBinary(t,"do");s&&function(e){let t;if(uo(e))t=Zn(e,17,xn[0]);else{if(!(e.data.byteLength>0))return!1;t=new Uint8Array(e.data,69632,256)}return 3===t[so]}(s)&&(a=Hn({name:o,rawData:s.data,readOnly:n,volume:254}))}return!a&&function(e){return qi.includes(e)}(r)&&(a=kr(r,{name:o,rawData:i,readOnly:n,volume:254})),a}return null}),[e,t]);if(i)try{if(function(e){return!!e.blocks}(i)){if(i.blocks.length){const e=new Yr(i),{totalBlocks:t}=e.vdh(),n=e.bitMap().freeBlocks().length,r=t-n;return A("div",{className:Vr.volume},A("table",null,A("thead",null,A("tr",null,A("th",{className:Vr.filename},"Filename"),A("th",{className:Vr.type},"Type"),A("th",{className:Vr.aux},"Aux"),A("th",{className:Vr.blocks},"Blocks"),A("th",{className:Vr.created},"Created"),A("th",{className:Vr.modified},"Modified"))),A("tbody",null,A(wo,{depth:0,volume:e,dirEntry:e.vdh(),setFileData:s})),A("tfoot",null,A("tr",null,A("td",{colSpan:1},"Blocks Free: ",n),A("td",{colSpan:3},"Used: ",r),A("td",{colSpan:2},"Total: ",t)))))}}else if(en(i)){const e=new Ao(i);return A("div",{className:Vr.volume},A("table",null,A("thead",null,A("tr",null,A("th",{className:Vr.filename},"Filename"),A("th",{className:Vr.type},"Type"),A("th",{className:Vr.sectors},"Sectors"),A("th",null))),A("tbody",null,A(ko,{dos:e,setFileData:s})),A("tfoot",null,A("tr",null,A("td",null,"Volume Number:"),A("td",{colSpan:3},e.getVolumeNumber())),A("tr",null,A("td",null,"Used Sectors:"),A("td",{colSpan:3},e.usedSectorCount())),A("tr",null,A("td",null,"Free Sectors:"),A("td",{colSpan:3},e.freeSectorCount())))))}}catch(e){return console.error(e),A("pre",null,"Unknown volume")}return A("pre",null,"No disk")},Eo=({apple2:e})=>{const[t,s]=ve(null),i=e.getIO(),n=[],r=Se((()=>{s(null)}),[]);for(let e=0;e<=7;e++){const t=i.getSlot(e);(t instanceof wr||t instanceof Sr)&&n.push(t)}return A("div",null,n.map(((e,t)=>A("div",{key:t},A("div",{className:Ii.subHeading},e.constructor.name," - 1"),A(xo,{massStorage:e,driveNo:1,setFileData:s}),A("div",{className:Ii.subHeading},e.constructor.name," - 2"),A(xo,{massStorage:e,driveNo:2,setFileData:s})))),A(bo,{fileData:t,onClose:r}))};class So{constructor(e){this.rom=e,this._readbsr=!1,this._writebsr=!1,this._bsr2=!1,this._prewrite=!1,this.bank1=new wt(208,223),this.bank2=new wt(208,223),this.ram=new wt(224,255),this.write1=this.rom,this.write2=this.rom,this.read1=this.rom,this.read2=this.rom}debug(...e){}updateBanks(){this._readbsr?(this.read1=this._bsr2?this.bank2:this.bank1,this.read2=this.ram):(this.read1=this.rom,this.read2=this.rom),this._writebsr?(this.write1=this._bsr2?this.bank2:this.bank1,this.write2=this.ram):(this.write1=this.rom,this.write2=this.rom)}access(e,t){const s=void 0===t,i=s?0:void 0,n=2&e,r=8&e;let o,a;return 1&e?(s&&this._prewrite&&(this._writebsr=!0),this._prewrite=s,n?(this._readbsr=!0,a="Read/Write"):(this._readbsr=!1,a="Write")):(this._writebsr=!1,this._prewrite=!1,n?(this._readbsr=!1,a="Off"):(this._readbsr=!0,a="Read")),r?(this._bsr2=!1,o="Bank 1"):(this._bsr2=!0,o="Bank 2"),this.debug(o,a),this.updateBanks(),i}start(){return 208}end(){return 255}ioSwitch(e,t){return this.access(e,t)}read(e,t){let s=0;return s=e<224?this.read1.read(e,t):this.read2.read(e,t),s}write(e,t,s){e<224?this.write1.write(e,t,s):this.write2.write(e,t,s)}get bsr2(){return this._bsr2}get readbsr(){return this._readbsr}get writebsr(){return this._writebsr}getState(){return{readbsr:this.readbsr,writebsr:this.writebsr,bsr2:this.bsr2,prewrite:this._prewrite,ram:this.ram.getState(),bank1:this.bank1.getState(),bank2:this.bank2.getState()}}setState(e){this._readbsr=e.readbsr,this._writebsr=e.writebsr,this._bsr2=e.bsr2,this._prewrite=e.prewrite,this.ram.setState(e.ram),this.bank1.setState(e.bank1),this.bank2.setState(e.bank2),this.updateBanks()}}var Po=n(9154),Ro={};Ro.styleTagTransform=ae(),Ro.setAttributes=ie(),Ro.insert=te().bind(null,"head"),Ro.domAPI=Q(),Ro.insertStyleElement=re(),q()(Po.Z,Ro);const To=Po.Z&&Po.Z.locals?Po.Z.locals:void 0,Io=(e,t)=>{const s=e.readbsr&&e.altzp===t,i=e.writebsr&&e.altzp===t;return{read:s,write:i,bank0:{read:s&&!e.bank1,write:i&&!e.bank1},bank1:{read:s&&e.bank1,write:i&&e.bank1},rom:{read:!e.readbsr,write:!e.writebsr}}},Do=(e,t)=>{const s=e.hires&&e._80store;return{read:s?e.page2===t:e.auxread===t,write:s?e.page2===t:e.auxwrite===t}},Bo=(e,t)=>{const s=e._80store;return{read:s?e.page2===t:e.auxread===t,write:s?e.page2===t:e.auxwrite===t}},Mo=e=>({read:e,write:e}),Oo=e=>({[To.read]:e.read,[To.write]:e.write,[To.inactive]:!e.write&&!e.read}),No=({lc:e,children:t})=>A("div",{className:J()(To.bank)},A("div",{className:J()(To.lc,Oo(e))},t," LC"),A("div",{className:To.lcbanks},A("div",{className:J()(To.lcbank,To.lcbank0,Oo(e.bank0))},"Bank 0"),A("div",{className:J()(To.lcbank,Oo(e.bank1))},"Bank 1"))),Lo=()=>A("div",null,A("div",null,A("div",{className:J()(To.read,To.legend)}," ")," Read"),A("div",null,A("div",{className:J()(To.write,To.legend)}," ")," Write"),A("div",null,A("div",{className:J()(To.write,To.read,To.legend)}," ")," Read/Write"),A("div",null,A("div",{className:J()(To.inactive,To.legend)}," ")," Inactive")),Uo=({apple2:e})=>{const t=xe(0),[s,i]=ve(),[n,r]=ve(),o=Se((()=>{if(e){const t=e.getMMU();if(t)i((e=>({main:{read:!e.auxread,write:!e.auxwrite,lc:Io(e,!1),hires:Do(e,!1),text:Bo(e,!1),zp:Mo(!e.altzp)},aux:{read:e.auxread,write:e.auxwrite,lc:Io(e,!0),hires:Do(e,!0),text:Bo(e,!0),zp:Mo(e.altzp)},io:Mo(!e.intcxrom),intcxrom:Mo(e.intcxrom)}))(t));else{const t=e.getIO().getSlot(0);t instanceof So&&r((e=>{const t=e.readbsr,s=e.writebsr;return{read:t,write:s,bank0:{read:t&&!e.bsr2,write:s&&!e.bsr2},bank1:{read:t&&e.bsr2,write:s&&e.bsr2},rom:{read:!e.readbsr,write:!e.writebsr}}})(t))}}t.current=requestAnimationFrame(o)}),[e]);return ke((()=>(t.current=requestAnimationFrame(o),()=>cancelAnimationFrame(t.current))),[o]),s?A("div",{className:To.memory},A("div",{className:Ii.heading},"MMU"),A("div",{className:J()(To.upperMemory,Ii.row)},A(No,{lc:s.aux.lc},"Aux"),A(No,{lc:s.main.lc},"Main"),A("div",{className:J()(To.bank)},A("div",{className:J()(To.rom,Oo(s.main.lc.rom))},"ROM"))),A("div",{className:J()(Ii.row)},A("div",{className:J()(To.io,Oo(s.io))},"IO"),A("div",{className:J()(To.intcxrom,Oo(s.intcxrom))},"CXROM")),A("div",{className:J()(To.lowerMemory,Ii.row)},A("div",{className:J()(To.bank,Oo(s.aux))},"Aux Mem",A("div",{className:J()(To.hires,Oo(s.aux.hires))},"Hires"),A("div",{className:J()(To.text,Oo(s.aux.text))},"Text/Lores"),A("div",{className:J()(To.zp,Oo(s.aux.zp))},"Stack/ZP")),A("div",{className:J()(To.bank,Oo(s.main))},"Main Mem",A("div",{className:J()(To.hires,Oo(s.main.hires))},"Hires"),A("div",{className:J()(To.text,Oo(s.main.text))},"Text/Lores"),A("div",{className:J()(To.zp,Oo(s.main.zp))},A("span",null,"Stack/ZP")))),A("hr",null),A(Lo,null)):n?A("div",{className:To.memory},A("div",{className:Ii.heading},"Language Card"),A("div",{className:J()(Ii.row,To.languageCard)},A(No,{lc:n}),A("div",{className:J()(To.bank)},A("div",{className:J()(To.rom,Oo(n.rom))},"ROM"))),A("hr",null),A(Lo,null)):null};var Fo=n(6368),jo={};jo.styleTagTransform=ae(),jo.setAttributes=ie(),jo.insert=te().bind(null,"head"),jo.domAPI=Q(),jo.insertStyleElement=re(),q()(Fo.Z,jo);const zo=Fo.Z&&Fo.Z.locals?Fo.Z.locals:void 0,Xo=(e,t)=>{if(t){const s=t.getContext("2d");s&&s.putImageData(e.imageData,0,0)}},Zo=({apple2:e})=>{const[t,s]=ve(!1),[i,n]=ve(!1),[r,o]=ve(!1),a=xe(null),l=xe(null),h=xe(null),c=xe(null),d=xe(0),u=Se((()=>{if(e){const t=e.getVideoModes(),i=t.isText(),r=t.isHires(),d=t.isPage2();t.getLoresPage(1).refresh(),t.getLoresPage(2).refresh(),t.getHiresPage(1).refresh(),t.getHiresPage(2).refresh(),Xo(t.getLoresPage(1),a.current),Xo(t.getLoresPage(2),l.current),Xo(t.getHiresPage(1),h.current),Xo(t.getHiresPage(2),c.current),s(i),n(r),o(d)}d.current=requestAnimationFrame(u)}),[e]);return ke((()=>(d.current=requestAnimationFrame(u),()=>cancelAnimationFrame(d.current))),[u]),A("div",{className:zo.pages},A("div",{className:Ii.row},A("div",{className:J()(zo.page,{[zo.active]:(t||!i)&&!r})},A("div",{className:Ii.heading},"Text/Lores Page 1"),A("canvas",{width:"560",height:"192",ref:a})),A("div",{className:J()(zo.page,{[zo.active]:(t||!i)&&r})},A("div",{className:Ii.heading},"Text/Lores Page 2"),A("canvas",{width:"560",height:"192",ref:l}))),A("div",{className:Ii.row},A("div",{className:J()(zo.page,{[zo.active]:!t&&i&&!r})},A("div",{className:Ii.heading},"Hires Page 1"),A("canvas",{width:"560",height:"192",ref:h})),A("div",{className:J()(zo.page,{[zo.active]:!t&&i&&r})},A("div",{className:Ii.heading},"Hires Page 2"),A("canvas",{width:"560",height:"192",ref:c}))))},Go=({apple2:e})=>{const[t,s]=ve(0);return e?A(Gt,{className:Ii.inset},A(fi,{setSelected:s},A(pi,null,"CPU"),A(pi,null,"Video"),A(pi,null,"Memory"),A(pi,null,"Disks"),A(pi,null,"Applesoft")),A("div",{className:Ii.debugger},0===t?A(Cn,{apple2:e}):null,1===t?A(Zo,{apple2:e}):null,2===t?A(Uo,{apple2:e}):null,3===t?A(Eo,{apple2:e}):null,4===t?A(Ni,{apple2:e}):null)):null};var Ho=n(1630),Wo={};Wo.styleTagTransform=ae(),Wo.setAttributes=ie(),Wo.insert=te().bind(null,"head"),Wo.domAPI=Q(),Wo.insertStyleElement=re(),q()(Ho.Z,Wo);const Yo=Ho.Z&&Ho.Z.locals?Ho.Z.locals:void 0,Ko=({error:e,setError:t})=>{const s=Se((()=>t(void 0)),[t]);let i=null;return e&&(e instanceof Error?i=e.message:"string"==typeof e?i=e:(i="Unknown Error",console.error(e))),i?A(Us,{title:"Error",icon:"triangle-exclamation",isOpen:!0,onClose:s},A(Ms,null,A("div",{className:Yo.errorModal},i)),A(Os,null,A("button",{onClick:s},"OK"))):null},Jo={Shift:"SHIFT",Enter:"RETURN",CapsLock:"LOCK",Control:"CTRL",Escape:"ESC",Delete:"RESET",Tab:"TAB",Backspace:"DELETE",ArrowUp:"&uarr;",ArrowDown:"&darr;",ArrowRight:"&rarr;",ArrowLeft:"&larr;",UIKeyInputLeftArrow:"&larr;",UIKeyInputRightArrow:"&rarr;",UIKeyInputUpArrow:"&uarr;",UIKeyInputDownArrow:"&darr;",UIKeyInputEscape:"ESC"},Vo={TAB:9,RETURN:13,ESC:27,"&uarr;":11,"&darr;":10,"&rarr;":21,"&larr;":8,DELETE:127},qo=[[["1","2","3","4","5","6","7","8","9","0",":","-","RESET"],["ESC","Q","W","E","R","T","Y","U","I","O","P","REPT","RETURN"],["CTRL","A","S","D","F","G","H","J","K","L",";","&larr;","&rarr;"],["SHIFT","Z","X","C","V","B","N","M",",",".","/","SHIFT"],["POWER","&nbsp;"]],[["!",'"',"#","$","%","&","'","(",")","0","*","=","RESET"],["ESC","Q","W","E","R","T","Y","U","I","O","@","REPT","RETURN"],["CTRL","A","S","D","F","BELL","H","J","K","L","+","&larr;","&rarr;"],["SHIFT","Z","X","C","V","B","^","]","<",">","?","SHIFT"],["POWER","&nbsp;"]]],$o=[[["ESC","1","2","3","4","5","6","7","8","9","0","-","=","DELETE"],["TAB","Q","W","E","R","T","Y","U","I","O","P","[","]","\\"],["CTRL","A","S","D","F","G","H","J","K","L",";",'"',"RETURN"],["SHIFT","Z","X","C","V","B","N","M",",",".","/","SHIFT"],["LOCK","`","POW","OPEN_APPLE","&nbsp;","CLOSED_APPLE","&larr;","&rarr;","&darr;","&uarr;"]],[["ESC","!","@","#","$","%","^","&","*","(",")","_","+","DELETE"],["TAB","Q","W","E","R","T","Y","U","I","O","P","{","}","|"],["CTRL","A","S","D","F","G","H","J","K","L",":","'","RETURN"],["SHIFT","Z","X","C","V","B","N","M","<",">","?","SHIFT"],["CAPS","~","POW","OPEN_APPLE","&nbsp;","CLOSED_APPLE","&larr;","&rarr;","&darr;","&uarr;"]]],Qo={"!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=","{":"[","}":"]","|":"\\",":":";","'":'"',"<":",",">":".","?":"/","~":"`"},ea=(e,t=!1,s=!1)=>{let i;i=(e=>e in Jo)(e.key)?Jo[e.key]:"Alt"===e.key?1===e.location?"OPEN_APPLE":"CLOSED_APPLE":e.key;let n=i;1===i.length&&(n=(e=>e in Qo)(i)?Qo[i]:i.toUpperCase());let r=255;return(e=>e in Vo)(i)?r=Vo[i]:1===i.length&&(r=i.charCodeAt(0)),(t||s)&&r>=97&&r<=122&&(r-=32),s&&r>=64&&r<96&&(r-=64),{key:i,keyLabel:n,keyCode:r}},ta=(e,t,s,i,n)=>{var r,o,a,l;const h=null!==(o=null===(r=e.currentTarget)||void 0===r?void 0:r.dataset.key2)&&void 0!==o?o:"";let c=null!==(l=null===(a=e.currentTarget)||void 0===a?void 0:a.dataset[t?"key2":"key1"])&&void 0!==l?l:"",d=255;switch(c){case"BELL":c="G";break;case"RETURN":c="\r";break;case"TAB":c="\t";break;case"DELETE":c="";break;case"&larr;":c="\b";break;case"&rarr;":c="";break;case"&darr;":c="\n";break;case"&uarr;":c="\v";break;case"&nbsp;":c=" ";break;case"ESC":c=""}return 1===c.length&&(d=s&&c>="@"&&c<="_"?c.charCodeAt(0)-64:n&&!t&&!i&&c>="A"&&c<="Z"?c.charCodeAt(0)+32:c.charCodeAt(0)),{keyCode:d,key:c,keyLabel:h}};var sa=n(7611),ia={};ia.styleTagTransform=ae(),ia.setAttributes=ie(),ia.insert=te().bind(null,"head"),ia.domAPI=Q(),ia.insertStyleElement=re(),q()(sa.Z,ia);const na=sa.Z&&sa.Z.locals?sa.Z.locals:void 0,ra=e=>{const t=e.length>1&&!e.startsWith("&");return A("span",{className:J()({[na.small]:t}),dangerouslySetInnerHTML:{__html:e}})},oa=({lower:e,upper:t,active:s,pressed:i,onMouseDown:n,onMouseUp:r})=>{const o=e.replace(/[&#;]/g,""),a="LOCK"===e?na.vCenter2:t===e&&t.length>1?na.vCenter:"";return A("div",{className:J()(na.key,na[`key-${o}`],a,{[na.pressed]:i,[na.active]:s}),"data-key1":e,"data-key2":t,onMouseDown:n,onMouseUp:r},A("div",null,ra(t),t!==e&&A(p,null,A("br",null),ra(e))))},aa=({apple2:e,layout:t})=>{const[s,i]=ve([]),[n,r]=ve(["LOCK"]),o=Ee((()=>(e=>{const t=[];for(let s=0;s<e[0].length;s++){const i=e[0][s],n=e[1][s],r=[];for(let e=0;e<i.length;e++)r.push([i[e],n[e]]);t.push(r)}return t})("apple2e"===t?$o:qo)),[t]);ke((()=>{const t=t=>{if(!e)return;if(document.activeElement&&document.activeElement!==document.body)return;t.preventDefault();const{key:s,keyCode:o,keyLabel:a}=ea(t,n.includes("LOCK"),n.includes("CTRL"));if(i((e=>e.concat([a]))),r((e=>e.concat([a]))),"RESET"===s)return void e.reset();const l=e.getIO();"OPEN_APPLE"!==s?"CLOSED_APPLE"!==s?255!==o&&e.getIO().keyDown(o):l.buttonDown(1,!0):l.buttonDown(0,!0)},s=t=>{if(!e)return;const{key:s,keyLabel:n}=ea(t);i((e=>e.filter((e=>e!==n)))),r((e=>e.filter((e=>e!==n))));const o=e.getIO();"OPEN_APPLE"===s&&o.buttonDown(0,!1),"CLOSED_APPLE"===s&&o.buttonDown(1,!1),e.getIO().keyUp()};return document.addEventListener("keydown",t),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",t),document.removeEventListener("keyup",s)}}),[e,n]);const a=Se((t=>{if(!e)return;t.preventDefault();const o=e=>n.includes(e)?(r(n.filter((t=>t!==e))),!1):(r([...n,e]),!0),a=e.getIO(),{keyCode:l,key:h,keyLabel:c}=ta(t,n.includes("SHIFT"),n.includes("CTRL"),n.includes("LOCK"),!0);if(255!==l)a.keyDown(l);else if(h)switch(h){case"SHIFT":case"CTRL":case"LOCK":o(h);break;case"RESET":e.reset();break;case"OPEN_APPLE":a.buttonDown(0,o(h)),o(h);break;case"CLOSED_APPLE":a.buttonDown(1,o(h)),o(h)}i([...s,c])}),[e,n,s]),l=Se((t=>{const{keyLabel:r}=ta(t,n.includes("SHIFT"),n.includes("CTRL"),n.includes("LOCK"),!0);null==e||e.getIO().keyUp(),i(s.filter((e=>e!==r)))}),[e,n,s]),h=([e,t])=>A(oa,{lower:e,upper:t,active:n.includes(e),pressed:s.includes(e),onMouseDown:a,onMouseUp:l}),c=o.map(((e,t)=>A("div",{key:t,className:J()(na.row,na[`row${t}`])},e.map(h))));return A("div",{className:na.keyboard},c)},la=({cpu:e,io:t,rom:s,slot:i})=>(ke((()=>{if(t&&e&&s){const n=new So(s);t.setSlot(i,n),e.addPageHandler(n)}}),[t,e,s,i]),null);class ha{constructor(e){this.canvas=e,this.setMouse=e=>{this.mouse=e},this.mouseMode=e=>{!function(e){$s=e}(e),e?this.canvas.classList.add("mouseMode"):this.canvas.classList.remove("mouseMode")};const t=e=>{const{targetTouches:t,target:s}=e;if(t.length<1)return;const i=s.getBoundingClientRect(),n=(i.width-560)/2+i.left,r=(i.height-384)/2+i.top,{clientX:o,clientY:a}=t[0],l=o-n,h=a-r;this.mouse.setMouseXY(Math.max(Math.min(l,559),0),Math.max(Math.min(h,383),0),560,384)};"ontouchstart"in window?(this.canvas.addEventListener("touchmove",(e=>{t(e)})),this.canvas.addEventListener("touchstart",(e=>{t(e),setTimeout((()=>this.mouse.setMouseDown(!0)),20)})),this.canvas.addEventListener("touchend",(e=>{t(e),setTimeout((()=>this.mouse.setMouseDown(!1)),20)})),this.canvas.addEventListener("touchcancel",(e=>{t(e),this.mouse.setMouseDown(!1)}))):(this.canvas.addEventListener("mousemove",(e=>{const{offsetX:t,offsetY:s,target:i}=e;this.mouse.setMouseXY(t,s,i.clientWidth,i.clientHeight)})),this.canvas.addEventListener("mousedown",(()=>{this.mouse.setMouseDown(!0)})),this.canvas.addEventListener("mouseup",(()=>{this.mouse.setMouseDown(!1)})))}}const ca=new Uint8Array([0,0,0,0,0,56,0,24,0,0,0,1,32,0,0,0,0,0,32,33,34,35,36,37,38,39,0,0,0,0,0,0,96,96,96,96,96,96,96,96,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,214,0,0,0,0]);class da{constructor(e,t){this.cpu=e,this.cbs=t,this.clampXMin=0,this.clampYMin=0,this.clampXMax=1023,this.clampYMax=1023,this.x=0,this.y=0,this.mode=0,this.down=!1,this.lastDown=!1,this.lastX=0,this.lastY=0,this.serve=0,this.shouldIntMove=!1,this.shouldIntPress=!1,this.slot=0,this.cbs.setMouse(this)}ioSwitch(e,t){}read(e,t){let s=this.cpu.getState();const i=(e,t)=>{this.cpu.write(e>>8,(255&e)+this.slot,t)},n=e=>this.cpu.read(e>>8,255&e),r=e=>(e.s&=254,e);if(this.cpu.getSync()){switch(t){case ca[18]:this.mode=s.a,this.cbs.mouseMode(!!(1&this.mode)),s=r(s);break;case ca[19]:i(1912,this.serve),s=r(s),this.serve=0;break;case ca[20]:{const e=this.lastX!==this.x||this.lastY!==this.y,t=(this.down?128:0)|(this.lastDown?64:0)|(e?32:0),n=255&this.x,o=255&this.y,a=this.x>>8,l=this.y>>8;i(1144,n),i(1272,o),i(1400,a),i(1528,l),i(1912,t),i(2040,this.mode),this.lastDown=this.down,this.lastX=this.x,this.lastY=this.y,s=r(s)}break;case ca[21]:je("clearMouse"),s=r(s);break;case ca[22]:je("posMouse"),s=r(s);break;case ca[23]:s.a?(this.clampYMin=n(1144)|n(1400)<<8,this.clampYMax=n(1272)|n(1528)<<8,je("clampMouse Y",this.clampYMin,this.clampYMax)):(this.clampXMin=n(1144)|n(1400)<<8,this.clampXMax=n(1272)|n(1528)<<8,je("clampMouse X",this.clampXMin,this.clampXMax)),s=r(s);break;case ca[24]:je("homeMouse"),this.x=this.clampXMin,this.y=this.clampYMin,s=r(s);break;case ca[25]:this.slot=s.y>>4,je("initMouse slot",this.slot),s=r(s)}this.cpu.setState(s)}return ca[t]}write(){}tick(){8&this.mode&&(this.serve|=8),4&this.mode&&this.shouldIntPress&&(this.serve|=4),2&this.mode&&this.shouldIntMove&&(this.serve|=2),this.serve&&this.cpu.irq(),this.shouldIntMove=!1,this.shouldIntPress=!1}setMouseXY(e,t,s,i){const n=this.clampXMax-this.clampXMin,r=this.clampYMax-this.clampYMin;this.x=e*n/s+this.clampXMin&65535,this.y=t*r/i+this.clampYMin&65535,this.shouldIntMove=!0}setMouseDown(e){this.shouldIntPress=this.down!==e,this.down=e}setState(e){this.clampXMin=e.clampXMin,this.clampYMin=e.clampYMin,this.clampXMax=e.clampXMax,this.clampYMax=e.clampYMax,this.x=e.x,this.y=e.y,this.mode=e.mode,this.down=e.down,this.lastDown=e.lastDown,this.lastX=e.lastX,this.lastY=e.lastY,this.serve=e.serve,this.shouldIntMove=e.shouldIntMove,this.shouldIntPress=e.shouldIntPress,this.slot=e.slot}getState(){return{clampXMin:this.clampXMin,clampYMin:this.clampYMin,clampXMax:this.clampXMax,clampYMax:this.clampYMax,x:this.x,y:this.y,mode:this.mode,down:this.down,lastDown:this.lastDown,lastX:this.lastX,lastY:this.lastY,serve:this.serve,shouldIntMove:this.shouldIntMove,shouldIntPress:this.shouldIntPress,slot:this.slot}}}const ua=({cpu:e,screenRef:t,io:s,slot:i})=>(ke((()=>{if(e&&s&&t.current){const n=new ha(t.current),r=new da(e,n);s.setSlot(i,r)}}),[e,s,t,i]),null);var Aa=n(7489),ma={};ma.styleTagTransform=ae(),ma.setAttributes=ie(),ma.insert=te().bind(null,"head"),ma.domAPI=Q(),ma.insertStyleElement=re(),q()(Aa.Z,ma);const pa=Aa.Z&&Aa.Z.locals?Aa.Z.locals:void 0,ga=({screenRef:e})=>A("div",{className:pa.display},A("div",{className:pa.overscan},A("canvas",{className:pa.screen,width:"592",height:"416",ref:e}))),fa=()=>{const[e,t]=ve(window.location.hash),s=()=>{const e=window.location.hash;t(e)};return ke((()=>(window.addEventListener("popstate",s),()=>{window.removeEventListener("popstate",s)})),[]),e};var _a=n(1244),ba={};ba.styleTagTransform=ae(),ba.setAttributes=ie(),ba.insert=te().bind(null,"head"),ba.domAPI=Q(),ba.insertStyleElement=re(),q()(_a.Z,ba);const Ca=_a.Z&&_a.Z.locals?_a.Z.locals:void 0;var ya=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const wa=[{description:"Disk Images",accept:{"application/octet-stream":Vi.map((e=>"."+e))}}],va=({disk2:e,driveNo:t,onClose:s,isOpen:i})=>{const[n,r]=ve(!1),[o,a]=ve(!0),[l,h]=ve(),[c,d]=ve(),[u,m]=ve(),[g,f]=ve(),[_,b]=ve(),C=fa();ke((()=>{Li((()=>ya(void 0,void 0,void 0,(function*(){try{const e=yield fetch("json/disks/index.json"),t=yield e.json();b(t)}catch(e){b([]),f(e)}}))))}),[]);const y=Se((()=>s(!0)),[s]),w=Se((()=>ya(void 0,void 0,void 0,(function*(){const i=rn(C);r(!0);try{if(1===(null==c?void 0:c.length)&&(i[t]="",yield((e,t,s)=>ln(e,Vi,t,s))(e,t,yield c[0].getFile())),u){const s=u.match(/\/([^/]+).json$/)||["",""];i[t]=s[1],yield hn(e,t,u)}}catch(e){f(e)}finally{on(i),r(!1),s()}on(i)}))),[e,u,t,s,c,C]),v=Se((e=>{a(0===e.length),d(e)}),[]),k=Se((e=>h(e.currentTarget.value)),[]),x=Se((e=>{a(!e.currentTarget.value),m(e.currentTarget.value)}),[]);if(!_)return null;const E=_.reduce(((e,t)=>{const s=t.category||"Misc";return e[s]=[t,...e[s]||[]],e}),{}),S=Object.keys(E).sort(),P=l?E[l].sort():[];return A(p,null,A(Us,{title:"Open File",isOpen:i,onClose:s},A(Ms,null,A("div",{className:Ca.loadModal},A("select",{multiple:!0,onChange:k},S.map((e=>A("option",{key:e},e)))),A("select",{multiple:!0,onChange:x},P.map((e=>A("option",{key:e.filename,value:e.filename},e.name,e.disk?` - ${e.disk}`:""))))),A(Zi,{onChange:v,accept:wa})),A(Os,null,A("button",{onClick:y},"Cancel"),A("button",{onClick:w,disabled:n||o},"Open"))),A(Ko,{error:g,setError:f}))};var ka=n(9656),xa={};xa.styleTagTransform=ae(),xa.setAttributes=ie(),xa.insert=te().bind(null,"head"),xa.domAPI=Q(),xa.insertStyleElement=re(),q()(ka.Z,xa);const Ea=ka.Z&&ka.Z.locals?ka.Z.locals:void 0;var Sa=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const Pa=e=>{var{storage:t,driveNo:s,dropRef:i,formats:n,onError:r,children:o}=e,a=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(s[i[n]]=e[i[n]])}return s}(e,["storage","driveNo","dropRef","formats","onError","children"]);const l=xe(null);return ke((()=>{const e=(null==i?void 0:i.current)||l.current;if(e){const i=e=>{e.preventDefault();const t=e.dataTransfer;t&&(Array.from(t.items).every((e=>"file"===e.kind))?t.dropEffect="copy":t.dropEffect="none")},o=e=>{const t=e.dataTransfer;if(null==t?void 0:t.items)for(let e=0;e<t.items.length;e++)t.items.remove(e);else null==t||t.clearData()},a=e=>{e.preventDefault(),e.stopPropagation();const i=null!=s?s:1,o=e.dataTransfer;1===(null==o?void 0:o.files.length)&&t?Li((()=>Sa(void 0,void 0,void 0,(function*(){try{yield ln(t,n,i,o.files[0])}catch(e){r(e)}})))):2===(null==o?void 0:o.files.length)&&t&&Li((()=>Sa(void 0,void 0,void 0,(function*(){try{yield ln(t,n,1,o.files[0]),yield ln(t,n,2,o.files[1])}catch(e){r(e)}}))))};return e.addEventListener("dragover",i),e.addEventListener("dragend",o),e.addEventListener("drop",a),()=>{e.removeEventListener("dragover",i),e.removeEventListener("dragend",o),e.removeEventListener("drop",a)}}}),[s,i,n,r,t]),A("div",Object.assign({ref:l},a),o)};var Ra=n(9781),Ta={};Ta.styleTagTransform=ae(),Ta.setAttributes=ie(),Ta.insert=te().bind(null,"head"),Ta.domAPI=Q(),Ta.insertStyleElement=re(),q()(Ra.Z,Ta);const Ia=Ra.Z&&Ra.Z.locals?Ra.Z.locals:void 0,Da=({massStorage:e,driveNo:t,onClose:s,isOpen:i})=>{const[n,r]=ve(""),[o,a]=ve(""),l=Se((()=>s(!0)),[s]);return ke((()=>{if(i){const s=e.getBinary(t);if(s){const{ext:e,data:t}=s,{name:i}=s.metadata;if(t.byteLength){const s=new Blob([t],{type:"application/octet-stream"}),n=window.URL.createObjectURL(s);return r(n),void a(`${i}.${e}`)}}r(""),a("")}}),[i,t,e]),A(p,null,A(Us,{title:"Save File",isOpen:i,onClose:s},A(Ms,null,A("div",{className:Ia.modalContent},n?A(p,null,A("span",null,"Disk Name: ",o),A("a",{role:"button",href:n,download:o},"Download")):A("span",null,"No Download Available"))),A(Os,null,A("button",{onClick:l},"Close"))))},Ba=({disk2:e,number:t,on:s,name:i,side:n})=>{const r=n?`${i} - ${n}`:i,[o,a]=ve(!1),[l,h]=ve(!1),[c,d]=ve(),u=Se((()=>{a(!1)}),[]),m=Se((()=>{a(!0)}),[]),p=Se((()=>{h(!1)}),[]),g=Se((()=>{h(!0)}),[]);return A(Pa,{className:Ea.disk,storage:e,driveNo:t,formats:Vi,onError:d},A(va,{disk2:e,driveNo:t,onClose:u,isOpen:o}),A(Da,{driveNo:t,massStorage:e,isOpen:l,onClose:p}),A(Ko,{error:c,setError:d}),A("div",{className:J()(Ea.diskLight,{[Ea.on]:s})}),A(Jt,{title:"Load Disk",onClick:m,icon:"folder-open"}),A(Jt,{title:"Save Disk",onClick:g,icon:"save"}),A("div",{className:Ea.diskLabel},r))};var Ma=n(4178),Oa={};Oa.styleTagTransform=ae(),Oa.setAttributes=ie(),Oa.insert=te().bind(null,"head"),Oa.domAPI=Q(),Oa.insertStyleElement=re(),q()(Ma.Z,Oa);const Na=Ma.Z&&Ma.Z.locals?Ma.Z.locals:void 0;const La=[{description:"Disk Images",accept:{"application/octet-stream":qi.map((e=>"."+e))}}],Ua=({smartPort:e,driveNo:t,onClose:s,isOpen:i})=>{const[n,r]=ve(),[o,a]=ve(!1),[l,h]=ve(!0),[c,d]=ve(),u=fa(),m=Se((()=>s(!0)),[s]),g=Se((()=>function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){const i=rn(u);if(1===(null==n?void 0:n.length)){i[t]="",a(!0);try{yield((e,t,s)=>ln(e,qi,t,s))(e,t,yield n[0].getFile())}catch(e){d(e)}finally{a(!1),s()}}on(i)}))),[n,u,e,t,s]),f=Se((e=>{h(0===e.length),r(e)}),[]);return A(p,null,A(Us,{title:"Open File",isOpen:i,onClose:s},A(Ms,null,A("div",{className:Na.modalContent},A(Zi,{onChange:f,accept:La}))),A(Os,null,A("button",{onClick:m},"Cancel"),A("button",{onClick:g,disabled:o||l},"Open"))),A(Ko,{error:c,setError:d}))};var Fa=n(5370),ja={};ja.styleTagTransform=ae(),ja.setAttributes=ie(),ja.insert=te().bind(null,"head"),ja.domAPI=Q(),ja.insertStyleElement=re(),q()(Fa.Z,ja);const za=Fa.Z&&Fa.Z.locals?Fa.Z.locals:void 0,Xa=({smartPort:e,number:t,on:s,name:i})=>{const[n,r]=ve(!1),[o,a]=ve(!1),[l,h]=ve(),c=Se((()=>{r(!1)}),[]),d=Se((()=>{r(!0)}),[]),u=Se((()=>{a(!1)}),[]),m=Se((()=>{a(!0)}),[]);return A(Pa,{className:za.disk,storage:e,driveNo:t,formats:qi,onError:h},A(Ko,{error:l,setError:h}),A(Ua,{smartPort:e,driveNo:t,onClose:c,isOpen:n}),A(Da,{driveNo:t,massStorage:e,isOpen:o,onClose:u}),A("div",{id:`disk${t}`,className:J()(za.diskLight,{[za.on]:s})}),A(Jt,{title:"Load Disk",onClick:d,icon:"folder-open"}),A(Jt,{title:"Save Disk",onClick:m,icon:"save"}),A("div",{id:`disk-label${t}`,className:za.diskLabel},i))};var Za=n(5879),Ga={};Ga.styleTagTransform=ae(),Ga.setAttributes=ie(),Ga.insert=te().bind(null,"head"),Ga.domAPI=Q(),Ga.insertStyleElement=re(),q()(Za.Z,Ga);const Ha=Za.Z&&Za.Z.locals?Za.Z.locals:void 0,Wa=({title:e,current:t,total:s})=>t&&s?A(Us,{title:e,isOpen:!0},A(Ms,null,A("div",{className:Ha.progressContainer},A("div",{className:Ha.progressBar,style:{width:Math.floor(t/s*320)}})))):null;var Ya=n(3024),Ka={};Ka.styleTagTransform=ae(),Ka.setAttributes=ie(),Ka.insert=te().bind(null,"head"),Ka.domAPI=Q(),Ka.insertStyleElement=re(),q()(Ya.Z,Ka);const Ja=Ya.Z&&Ya.Z.locals?Ya.Z.locals:void 0;var Va=function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};const qa=({cpu:e,io:t,sectors:s,enhanced:i,ready:n})=>{const[r,o]=ve(0),[a,l]=ve(),[h,c]=ve(0),d=xe(document.body),u=Se(((e,t)=>{o(e),c(t)}),[]),[m,p]=ve(),[g,f]=ve({on:!1,number:1,name:"Disk 1"}),[_,b]=ve({on:!1,number:2,name:"Disk 2"}),[C,y]=ve({on:!1,number:1,name:"HD 1"}),[w,v]=ve({on:!1,number:2,name:"HD 2"}),k=fa();if(ke((()=>{if(m){const{smartStorageBroker:e,disk2:t}=m,s=rn(k),i=[];let r=0;for(const a of Gi)if(s&&s[a]){const h=decodeURIComponent(s[a]),d=h.match(/^https?:/i),A=h.match(/\.json$/i);d&&!A?(r++,i.push(Li((t=>Va(void 0,void 0,void 0,(function*(){try{yield cn(e,a,h,t,u)}catch(e){l(e)}0==--r&&n.onReady(),o(0),c(0)})))))):hn(t,a,d?h:`json/disks/${h}.json`).catch((e=>l(e)))}return r||n.onReady(),()=>i.forEach((e=>e.abort()))}}),[k,u,n,m]),ke((()=>{const n=[f,b],r=[y,v],o={driveLight:(e,t)=>{var s;null===(s=r[e-1])||void 0===s||s.call(r,(e=>Object.assign(Object.assign({},e),{on:t})))},label:(e,t,s)=>{var i;null===(i=r[e-1])||void 0===i||i.call(r,(i=>Object.assign(Object.assign({},i),{name:null!=t?t:`HD ${e}`,side:s})))},dirty:()=>{}};if(e&&t){const r=new wr(t,{driveLight:(e,t)=>{var s;null===(s=n[e-1])||void 0===s||s.call(n,(e=>Object.assign(Object.assign({},e),{on:t})))},label:(e,t,s)=>{var i;null===(i=n[e-1])||void 0===i||i.call(n,(i=>Object.assign(Object.assign({},i),{name:null!=t?t:`Disk ${e}`,side:s})))},dirty:()=>{}},s);t.setSlot(6,r);const a=new Sr(e,o,{block:!i});t.setSlot(7,a);const l=new dn(r,a);p({disk2:r,smartPort:a,smartStorageBroker:l})}}),[e,i,t,s]),!m)return null;const{disk2:x,smartPort:E,smartStorageBroker:S}=m;return A(Pa,{storage:S,dropRef:d,className:Ja.drives,onError:l,formats:$i},A(Wa,{current:r,total:h,title:"Loading..."}),A(Ko,{error:a,setError:l}),A("div",{className:Ja.driveBay},A(Ba,Object.assign({disk2:x},g)),A(Ba,Object.assign({disk2:x},_))),A("div",{className:Ja.driveBay},A(Xa,Object.assign({smartPort:E},C)),A(Xa,Object.assign({smartPort:E},w))))},$a=new Uint8Array([67,79,80,89,82,73,71,72,84,32,40,67,41,32,49,57,56,54,45,56,57,32,65,80,80,76,73,69,68,32,69,78,71,73,78,69,69,82,73,78,71,0,66,79,66,32,83,65,78,68,69,82,45,67,69,68,69,82,76,79,70,0,77,73,67,72,65,69,76,32,87,73,76,75,83,0,83,84,69,86,69,78,32,77,65,76,69,67,72,69,75,0,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,201,32,201,0,201,3,201,0,176,49,32,22,193,76,155,193,32,22,193,76,159,193,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,193,174,255,207,14,159,192,162,152,140,248,7,142,120,7,76,223,201,169,193,197,57,8,32,22,193,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,193,76,186,250,185,56,4,201,1,208,42,32,123,193,24,144,36,32,154,202,32,235,202,160,193,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,16,76,1,8,96,160,3,208,2,160,5,162,3,185,213,193,149,66,136,202,16,247,8,120,142,159,192,162,152,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,159,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,193,76,0,200,32,40,193,76,232,203,201,16,240,4,170,160,15,96,104,104,32,40,193,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,194,76,155,194,32,22,194,76,159,194,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,194,174,255,207,14,175,192,162,168,140,248,7,142,120,7,76,223,201,169,194,197,57,8,32,22,194,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,194,76,186,250,185,56,4,201,1,208,42,32,123,194,24,144,36,32,154,202,32,235,202,160,194,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,32,76,1,8,96,160,3,208,2,160,5,162,3,185,213,194,149,66,136,202,16,247,8,120,142,175,192,162,168,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,175,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,194,76,0,200,32,40,194,76,232,203,201,32,240,4,170,160,15,96,104,104,32,40,194,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,195,76,155,195,32,22,195,76,159,195,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,195,174,255,207,14,191,192,162,184,140,248,7,142,120,7,76,223,201,169,195,197,57,8,32,22,195,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,195,76,186,250,185,56,4,201,1,208,42,32,123,195,24,144,36,32,154,202,32,235,202,160,195,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,48,76,1,8,96,160,3,208,2,160,5,162,3,185,213,195,149,66,136,202,16,247,8,120,142,191,192,162,184,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,191,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,195,76,0,200,32,40,195,76,232,203,201,48,240,4,170,160,15,96,104,104,32,40,195,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,196,76,155,196,32,22,196,76,159,196,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,196,174,255,207,14,207,192,162,200,140,248,7,142,120,7,76,223,201,169,196,197,57,8,32,22,196,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,196,76,186,250,185,56,4,201,1,208,42,32,123,196,24,144,36,32,154,202,32,235,202,160,196,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,64,76,1,8,96,160,3,208,2,160,5,162,3,185,213,196,149,66,136,202,16,247,8,120,142,207,192,162,200,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,207,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,196,76,0,200,32,40,196,76,232,203,201,64,240,4,170,160,15,96,104,104,32,40,196,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,197,76,155,197,32,22,197,76,159,197,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,197,174,255,207,14,223,192,162,216,140,248,7,142,120,7,76,223,201,169,197,197,57,8,32,22,197,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,197,76,186,250,185,56,4,201,1,208,42,32,123,197,24,144,36,32,154,202,32,235,202,160,197,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,80,76,1,8,96,160,3,208,2,160,5,162,3,185,213,197,149,66,136,202,16,247,8,120,142,223,192,162,216,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,223,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,197,76,0,200,32,40,197,76,232,203,201,80,240,4,170,160,15,96,104,104,32,40,197,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,198,76,155,198,32,22,198,76,159,198,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,198,174,255,207,14,239,192,162,232,140,248,7,142,120,7,76,223,201,169,198,197,57,8,32,22,198,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,198,76,186,250,185,56,4,201,1,208,42,32,123,198,24,144,36,32,154,202,32,235,202,160,198,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,96,76,1,8,96,160,3,208,2,160,5,162,3,185,213,198,149,66,136,202,16,247,8,120,142,239,192,162,232,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,239,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,198,76,0,200,32,40,198,76,232,203,201,96,240,4,170,160,15,96,104,104,32,40,198,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,199,76,155,199,32,22,199,76,159,199,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,199,174,255,207,14,255,192,162,248,140,248,7,142,120,7,76,223,201,169,199,197,57,8,32,22,199,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,199,76,186,250,185,56,4,201,1,208,42,32,123,199,24,144,36,32,154,202,32,235,202,160,199,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,112,76,1,8,96,160,3,208,2,160,5,162,3,185,213,199,149,66,136,202,16,247,8,120,142,255,192,162,248,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,255,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,199,76,0,200,32,40,199,76,232,203,201,112,240,4,170,160,15,96,104,104,32,40,199,76,111,204,174,1,0,0,79,219,32,153,205,162,9,181,66,72,202,16,250,186,189,12,1,133,70,189,11,1,133,69,160,3,177,69,153,65,0,254,11,1,208,3,254,12,1,136,208,240,140,248,4,140,120,5,140,248,5,170,201,10,176,40,189,135,200,209,67,208,36,160,8,177,67,153,67,0,136,208,248,74,208,17,174,120,7,164,66,169,200,72,185,125,200,72,70,68,165,71,96,169,17,44,169,1,44,169,4,141,248,4,162,0,104,149,66,232,224,10,144,248,172,248,5,174,120,5,173,248,4,208,1,24,96,202,163,181,144,156,144,147,147,152,150,3,3,3,1,3,1,1,1,4,4,76,102,200,76,94,200,176,44,176,24,144,247,240,242,169,33,76,99,200,144,238,32,12,201,176,29,173,19,192,6,75,10,102,75,76,35,201,144,220,32,12,201,176,11,173,20,192,6,75,10,102,75,76,130,201,76,125,201,176,19,208,208,160,8,140,120,5,136,145,69,208,251,169,1,145,69,76,102,200,240,7,160,25,201,3,208,183,44,160,4,140,120,5,136,185,198,201,192,2,208,14,174,248,7,189,184,5,74,145,69,136,189,56,6,106,145,69,136,16,230,76,102,200,10,133,74,165,72,42,176,14,133,75,165,73,201,1,176,6,133,71,169,2,133,72,96,32,100,201,176,85,44,20,192,8,10,144,3,141,5,192,165,72,141,248,5,240,14,189,251,191,145,69,200,208,248,230,70,198,72,208,242,165,71,240,13,141,120,5,189,251,191,145,69,200,196,71,208,246,141,4,192,40,16,3,141,5,192,76,102,200,165,73,157,248,191,165,74,157,249,191,165,75,41,127,157,250,191,32,157,202,160,0,165,75,96,169,45,76,99,200,32,100,201,176,246,44,19,192,8,141,2,192,10,144,3,141,3,192,165,72,141,248,5,240,14,177,69,157,251,191,200,208,248,230,70,198,72,208,242,165,71,141,120,5,240,10,177,69,157,251,191,200,196,71,208,246,141,2,192,40,16,3,141,3,192,76,102,200,248,0,0,0,7,82,65,77,67,65,82,68,32,32,32,32,32,32,32,32,32,0,0,0,0,172,248,7,32,142,202,189,251,191,201,174,208,69,93,251,191,201,90,208,62,189,251,191,153,56,4,73,90,221,251,191,208,49,189,251,191,153,184,3,185,56,4,157,248,191,189,251,191,153,184,4,189,251,191,153,56,5,189,251,191,153,184,5,189,251,191,153,56,6,189,251,191,153,184,6,189,251,191,153,56,7,96,185,184,6,89,56,7,201,90,240,56,32,142,202,169,4,157,249,191,189,251,191,93,251,191,93,251,191,93,251,191,162,76,201,3,240,12,162,0,201,6,240,6,162,51,201,190,208,9,138,153,184,6,73,90,153,56,7,32,0,203,172,248,7,153,184,3,185,184,3,10,153,184,5,169,0,153,56,6,153,56,5,153,184,4,169,1,153,56,4,96,174,120,7,169,0,157,248,191,157,249,191,157,250,191,96,32,142,202,172,248,7,185,184,3,201,9,189,250,191,176,2,41,15,72,208,30,185,56,4,201,8,208,23,189,249,191,201,2,176,16,9,254,157,249,191,185,184,3,233,0,42,157,250,191,104,96,189,249,191,217,56,6,104,72,249,184,5,176,241,189,249,191,121,56,5,157,249,191,104,121,184,4,157,250,191,96,160,0,189,251,191,153,0,8,200,208,247,189,251,191,153,0,9,200,208,247,96,32,139,202,168,221,250,191,208,2,160,2,25,149,203,133,63,133,62,157,250,191,189,251,191,222,248,191,72,165,63,157,251,191,222,248,191,57,149,203,240,20,165,63,56,249,152,203,76,14,203,24,165,63,121,152,203,133,63,157,250,191,189,251,191,197,63,208,63,73,255,222,248,191,157,251,191,222,248,191,221,251,191,208,47,222,248,191,165,63,57,149,203,217,149,203,208,209,165,62,157,250,191,104,157,251,191,222,248,191,24,165,62,121,152,203,133,62,57,149,203,208,231,165,63,136,16,140,74,105,2,96,222,248,191,56,165,63,240,214,249,152,203,133,63,76,97,203,234,234,12,48,192,4,16,64,162,4,160,0,169,0,72,56,165,62,253,222,203,72,165,63,253,227,203,144,10,133,63,104,133,62,104,105,0,208,231,104,104,208,8,136,16,5,138,240,2,169,16,200,73,176,32,237,253,202,16,208,169,203,76,237,253,8,8,32,56,80,104,128,152,176,200,4,40,144,160,64,0,0,1,15,156,164,66,200,240,107,32,153,205,160,43,176,24,160,40,165,67,48,18,164,66,240,17,136,240,30,136,240,57,136,240,20,160,1,44,160,39,152,56,96,172,248,7,32,228,207,172,120,4,174,248,4,169,0,24,96,32,88,204,176,230,160,0,189,251,191,145,68,200,208,248,230,69,189,251,191,145,68,200,208,248,198,69,152,24,96,32,88,204,176,200,160,0,177,68,157,251,191,200,208,248,230,69,177,68,157,251,191,200,208,248,240,224,169,0,157,248,191,165,70,10,157,249,191,165,71,42,176,6,157,250,191,32,157,202,96,32,86,205,160,16,176,106,32,251,204,160,2,177,72,133,62,73,1,240,5,144,88,32,22,205,160,14,169,254,145,72,160,4,132,63,177,72,221,53,205,176,68,74,102,63,74,102,63,74,102,63,224,1,240,3,74,102,63,72,200,177,72,221,55,205,176,43,5,63,72,32,139,202,104,157,249,191,104,157,250,191,32,157,202,176,24,160,8,177,72,133,62,200,177,72,133,63,160,12,177,72,168,240,29,136,240,18,136,240,5,56,160,128,208,19,177,62,157,251,191,200,208,248,240,8,189,251,191,145,62,200,208,248,24,152,160,13,145,72,96,172,248,7,162,3,185,56,6,221,49,205,185,184,5,253,45,205,176,4,202,16,239,96,138,74,170,96,24,172,248,7,185,56,5,125,59,205,153,56,5,185,184,4,125,57,205,153,184,4,96,2,4,6,12,48,96,64,128,35,50,16,32,2,6,48,64,172,248,7,32,228,207,201,16,176,5,173,120,4,240,9,185,56,7,73,90,217,184,6,56,96,32,61,205,144,60,208,6,201,51,208,54,24,96,169,51,153,184,6,32,251,204,48,42,144,34,185,56,5,72,185,184,4,72,142,248,4,32,22,205,188,226,207,32,251,205,174,248,4,172,248,7,104,153,184,4,104,153,56,5,188,226,207,76,193,205,56,96,32,61,205,144,18,208,18,201,205,208,2,24,96,32,236,205,208,5,217,184,6,240,244,56,96,32,236,205,208,249,153,184,6,160,0,10,208,2,160,135,32,251,205,32,142,202,172,248,7,185,56,4,201,1,240,17,24,105,4,157,248,191,185,184,6,157,251,191,73,90,157,251,191,185,184,6,73,90,153,56,7,24,96,173,0,191,240,2,201,76,96,174,120,7,32,103,206,200,185,48,207,208,244,96,41,15,157,251,191,169,0,157,251,191,96,152,72,173,248,4,201,1,173,120,4,233,0,74,74,74,74,168,169,255,133,62,169,3,74,102,62,136,16,250,157,251,191,165,62,157,251,191,104,168,96,32,83,206,169,1,72,32,6,206,169,17,157,251,191,104,72,157,251,191,32,83,206,104,24,105,1,201,31,144,231,96,169,0,44,169,255,157,251,191,221,248,191,208,248,106,144,3,157,251,191,96,201,64,176,35,201,48,176,62,201,32,176,142,201,16,176,149,201,4,240,74,176,8,201,2,144,88,240,208,176,209,201,6,144,73,240,169,76,244,206,72,41,63,240,24,104,72,41,192,10,240,8,169,255,176,4,200,185,48,207,157,251,191,104,56,233,1,208,227,104,96,41,15,72,169,255,157,251,191,157,251,191,32,6,206,157,251,191,104,56,233,1,208,235,96,173,248,4,157,251,191,173,120,4,157,251,191,96,173,248,7,73,240,208,245,169,0,157,248,191,200,185,48,207,157,249,191,200,185,48,207,157,250,191,152,72,32,157,202,104,168,96,152,72,172,120,4,240,13,234,152,72,160,32,32,39,207,104,168,136,208,244,173,248,4,72,74,74,74,240,4,168,32,39,207,104,41,7,168,169,0,56,106,136,16,251,10,157,251,191,104,168,96,169,255,157,251,191,136,208,250,96,1,0,0,2,2,1,2,0,2,2,32,35,68,244,82,65,77,5,153,67,195,39,13,32,38,4,2,2,34,36,2,2,35,37,2,2,36,32,2,2,7,2,2,1,12,0,16,0,1,0,0,2,1,4,0,68,2,15,32,147,1,16,1,71,51,17,15,4,0,0,254,160,65,122,136,72,17,1,0,0,35,16,0,1,136,63,132,63,50,2,6,0,1,0,0,2,1,4,0,68,2,15,32,147,1,32,2,71,51,17,31,4,0,0,254,160,65,122,136,72,17,1,0,0,50,32,0,1,132,200,248,132,3,6,0,1,0,0,2,2,1,2,0,2,2,130,65,6,131,68,4,82,65,77,5,131,4,2,2,2,2,2,2,2,2,2,2,2,2,0,68,174,244,8,82,2,2,0,48,92,185,184,5,74,141,120,4,185,56,6,106,141,248,4,96,255,255,255,255,255,255,255,255,255,255,255,255,255,67,79,80,89,82,73,71,72,84,32,40,67,41,32,49,57,56,54,45,56,57,32,65,80,80,76,73,69,68,32,69,78,71,73,78,69,69,82,73,78,71,0,66,79,66,32,83,65,78,68,69,82,45,67,69,68,69,82,76,79,70,0,77,73,67,72,65,69,76,32,87,73,76,75,83,0,83,84,69,86,69,78,32,77,65,76,69,67,72,69,75,0,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,174,201,32,201,0,201,3,201,0,176,49,32,22,193,76,155,193,32,22,193,76,159,193,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,193,174,255,207,14,159,192,162,152,140,248,7,142,120,7,76,223,201,169,193,197,57,8,32,22,193,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,193,76,186,250,185,56,4,201,1,208,42,32,123,193,24,144,36,32,154,202,32,235,202,160,193,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,16,76,1,8,96,160,3,208,2,160,5,162,3,185,213,193,149,66,136,202,16,247,8,120,142,159,192,162,152,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,159,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,193,76,0,200,32,40,193,76,232,203,201,16,240,4,170,160,15,96,104,104,32,40,193,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,194,76,155,194,32,22,194,76,159,194,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,194,174,255,207,14,175,192,162,168,140,248,7,142,120,7,76,223,201,169,194,197,57,8,32,22,194,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,194,76,186,250,185,56,4,201,1,208,42,32,123,194,24,144,36,32,154,202,32,235,202,160,194,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,32,76,1,8,96,160,3,208,2,160,5,162,3,185,213,194,149,66,136,202,16,247,8,120,142,175,192,162,168,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,175,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,194,76,0,200,32,40,194,76,232,203,201,32,240,4,170,160,15,96,104,104,32,40,194,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,195,76,155,195,32,22,195,76,159,195,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,195,174,255,207,14,191,192,162,184,140,248,7,142,120,7,76,223,201,169,195,197,57,8,32,22,195,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,195,76,186,250,185,56,4,201,1,208,42,32,123,195,24,144,36,32,154,202,32,235,202,160,195,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,48,76,1,8,96,160,3,208,2,160,5,162,3,185,213,195,149,66,136,202,16,247,8,120,142,191,192,162,184,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,191,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,195,76,0,200,32,40,195,76,232,203,201,48,240,4,170,160,15,96,104,104,32,40,195,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,196,76,155,196,32,22,196,76,159,196,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,196,174,255,207,14,207,192,162,200,140,248,7,142,120,7,76,223,201,169,196,197,57,8,32,22,196,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,196,76,186,250,185,56,4,201,1,208,42,32,123,196,24,144,36,32,154,202,32,235,202,160,196,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,64,76,1,8,96,160,3,208,2,160,5,162,3,185,213,196,149,66,136,202,16,247,8,120,142,207,192,162,200,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,207,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,196,76,0,200,32,40,196,76,232,203,201,64,240,4,170,160,15,96,104,104,32,40,196,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,197,76,155,197,32,22,197,76,159,197,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,197,174,255,207,14,223,192,162,216,140,248,7,142,120,7,76,223,201,169,197,197,57,8,32,22,197,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,197,76,186,250,185,56,4,201,1,208,42,32,123,197,24,144,36,32,154,202,32,235,202,160,197,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,80,76,1,8,96,160,3,208,2,160,5,162,3,185,213,197,149,66,136,202,16,247,8,120,142,223,192,162,216,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,223,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,197,76,0,200,32,40,197,76,232,203,201,80,240,4,170,160,15,96,104,104,32,40,197,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,198,76,155,198,32,22,198,76,159,198,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,198,174,255,207,14,239,192,162,232,140,248,7,142,120,7,76,223,201,169,198,197,57,8,32,22,198,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,198,76,186,250,185,56,4,201,1,208,42,32,123,198,24,144,36,32,154,202,32,235,202,160,198,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,96,76,1,8,96,160,3,208,2,160,5,162,3,185,213,198,149,66,136,202,16,247,8,120,142,239,192,162,232,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,239,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,198,76,0,200,32,40,198,76,232,203,201,96,240,4,170,160,15,96,104,104,32,40,198,76,111,204,174,1,0,0,79,219,201,32,201,0,201,3,201,0,176,49,32,22,199,76,155,199,32,22,199,76,159,199,141,12,192,141,0,192,141,14,192,32,47,251,32,147,254,32,137,254,160,199,174,255,207,14,255,192,162,248,140,248,7,142,120,7,76,223,201,169,199,197,57,8,32,22,199,40,208,26,32,236,205,240,21,169,32,141,18,189,169,234,141,19,189,140,20,189,162,0,169,141,141,0,2,96,165,0,208,10,196,1,208,6,32,123,199,76,186,250,185,56,4,201,1,208,42,32,123,199,24,144,36,32,154,202,32,235,202,160,199,173,1,8,240,18,185,56,7,73,90,217,184,6,208,8,141,0,191,162,112,76,1,8,96,160,3,208,2,160,5,162,3,185,213,199,149,66,136,202,16,247,8,120,142,255,192,162,248,160,0,132,62,169,10,133,63,177,66,145,62,200,208,4,230,63,230,67,196,68,165,67,229,69,144,237,14,255,192,40,76,0,10,0,200,38,203,244,207,184,80,6,32,40,199,76,0,200,32,40,199,76,232,203,201,112,240,4,170,160,15,96,104,104,32,40,199,76,111,204,174,1,0,0,79,219,142,43,13,32,88,252,160,0,32,125,12,32,0,203,141,42,13,160,0,140,47,13,10,144,2,136,152,132,62,133,63,32,155,203,160,33,32,125,12,32,139,202,157,251,191,169,4,157,249,191,169,255,157,251,191,172,248,7,153,184,6,169,0,133,36,160,39,32,125,12,173,47,13,32,218,253,160,44,32,125,12,165,36,24,101,40,141,229,10,169,0,101,41,141,230,10,160,8,136,136,140,41,13,32,228,10,32,232,10,176,17,172,41,13,208,238,238,47,13,173,0,192,16,193,141,16,192,96,152,72,160,53,32,125,12,169,8,56,237,41,13,74,168,9,176,32,237,253,192,3,176,2,104,96,160,66,32,125,12,174,120,7,189,248,191,222,248,191,41,127,208,13,189,249,191,222,249,191,41,127,208,3,222,250,191,189,250,191,172,42,13,192,9,176,2,41,15,32,218,253,189,249,191,32,218,253,189,248,191,32,218,253,169,173,32,237,253,104,93,251,191,32,218,253,32,142,253,96,238,0,4,96,185,245,10,72,185,244,10,72,174,43,13,96,227,11,128,11,29,11,251,10,160,0,152,32,10,13,93,250,191,41,15,208,19,152,221,249,191,208,13,221,248,191,208,8,32,228,10,200,208,228,24,96,56,96,169,0,160,240,32,10,13,173,40,13,32,107,11,141,40,13,173,39,13,32,107,11,141,39,13,32,19,13,238,40,13,208,12,238,39,13,208,7,238,38,13,208,2,24,96,32,228,10,189,251,191,189,250,191,77,38,13,208,16,189,249,191,205,39,13,208,8,189,248,191,205,40,13,240,188,56,96,201,16,144,6,201,112,176,3,169,112,96,201,144,144,251,201,240,176,247,169,240,96,173,42,13,240,14,169,0,141,48,13,32,150,11,32,150,11,32,150,11,24,96,32,142,202,168,152,157,251,191,32,190,11,208,247,32,228,10,152,32,10,13,152,221,251,191,208,10,32,190,11,208,245,56,110,48,13,96,104,104,56,96,44,48,13,16,24,238,38,13,254,250,191,173,38,13,74,205,42,13,144,9,160,0,96,238,39,13,254,249,191,238,40,13,200,96,0,85,170,255,173,42,13,240,19,160,3,185,224,11,141,44,13,32,254,11,32,46,12,176,4,136,16,239,24,96,32,109,12,32,10,12,206,45,13,208,248,96,152,72,173,44,13,160,0,140,46,13,157,251,191,157,251,191,157,251,191,157,251,191,200,208,241,32,228,10,238,46,13,208,233,104,168,96,32,109,12,32,60,12,176,5,206,45,13,208,246,96,152,72,173,44,13,160,0,140,46,13,221,251,191,208,30,221,251,191,208,25,221,251,191,208,20,221,251,191,208,15,200,208,233,32,228,10,238,46,13,208,225,104,168,24,96,168,104,56,96,173,42,13,74,141,45,13,76,142,202,8,32,237,253,40,36,24,32,143,12,189,161,12,208,241,32,143,12,189,176,12,208,233,96,185,192,12,176,7,74,74,74,74,170,56,96,200,41,15,170,24,96,0,141,210,193,205,174,212,201,211,160,199,207,204,196,197,206,0,194,195,198,200,208,217,218,205,209,213,214,177,180,186,48,96,108,126,217,239,167,254,226,127,169,35,64,67,3,107,41,110,134,144,192,213,14,17,78,75,32,121,135,8,224,249,1,144,32,118,232,17,1,6,56,128,249,1,153,153,110,134,127,169,85,80,25,17,3,50,217,4,55,192,178,229,151,208,249,1,153,147,221,46,136,15,144,25,141,40,13,141,39,13,140,38,13,173,40,13,157,248,191,173,39,13,157,249,191,173,38,13,157,250,191,96,32,139,202,189,251,191,201,174,208,17,93,251,191,201,90,208,10,189,251,191,93,251,191,201,90,240,80,172,248,7,185,184,6,89,56,7,201,90,208,23,32,88,252,160,136,32,142,12,169,191,32,237,253,32,151,14,201,217,240,3,76,6,14,32,139,202,160,170,32,251,205,32,139,202,169,4,157,248,191,172,248,7,185,184,3,72,157,251,191,169,10,157,248,191,104,10,56,233,1,157,251,191,169,252,157,251,191,32,142,202,32,235,202,173,2,8,141,1,9,32,88,252,78,0,9,169,0,133,36,133,37,160,0,32,142,12,173,248,7,73,112,32,237,253,32,142,253,32,142,253,160,0,32,3,12,200,192,9,144,248,160,20,32,142,12,160,89,44,0,9,16,2,160,39,32,142,12,32,66,252,32,151,14,201,177,144,20,201,186,176,16,233,176,32,129,12,141,1,9,44,0,9,48,177,76,246,13,141,2,9,160,6,44,0,9,16,2,160,253,200,200,200,185,247,10,240,14,205,2,9,208,243,185,249,10,72,185,248,10,72,96,32,226,251,76,125,10,206,80,11,195,244,11,211,112,11,141,21,11,136,56,11,139,56,11,138,72,11,149,72,11,155,42,11,210,35,11,0,44,0,9,48,3,76,246,13,32,232,13,76,122,10,56,110,0,9,76,125,10,44,0,9,16,3,76,0,10,32,215,13,76,54,14,173,1,9,56,233,24,201,224,176,3,141,1,9,76,125,10,173,1,9,24,105,24,144,238,160,118,32,142,12,162,16,32,79,14,176,17,162,0,172,1,9,189,8,9,153,8,8,200,232,224,16,144,244,76,125,10,32,67,14,240,116,152,24,105,24,168,192,224,176,107,32,70,14,240,102,160,127,32,142,12,162,6,32,79,14,32,161,14,14,4,9,46,5,9,14,4,9,46,5,9,24,172,1,9,185,3,8,121,27,8,141,6,9,185,2,8,121,26,8,141,7,9,56,173,6,9,237,4,9,72,173,7,9,237,5,9,144,35,153,26,8,104,153,27,8,24,173,4,9,153,3,8,121,1,8,153,25,8,173,5,9,153,2,8,121,0,8,153,24,8,76,125,10,104,160,213,44,160,201,32,142,12,32,12,253,76,125,10,32,67,14,208,6,174,1,9,254,5,8,76,125,10,152,72,32,129,12,72,162,255,205,1,9,208,2,162,63,134,50,32,121,12,152,24,105,177,32,237,253,32,121,12,104,72,168,162,16,185,8,8,208,2,169,160,32,237,253,200,202,208,242,32,121,12,104,72,168,185,2,8,133,63,185,3,8,133,62,32,155,203,169,255,133,50,32,121,12,104,168,185,5,8,73,90,217,4,8,240,2,169,1,160,4,217,111,12,240,3,136,208,248,185,116,12,168,32,142,12,104,168,96,76,0,51,205,223,233,245,228,239,169,160,32,237,253,76,237,253,141,2,9,10,109,2,9,10,10,10,105,8,96,24,32,172,12,189,190,12,208,9,32,172,12,189,205,12,208,1,96,8,48,3,32,121,12,32,237,253,40,208,227,185,221,12,176,7,74,74,74,74,170,56,96,200,41,15,170,24,96,0,141,1,199,204,201,212,195,200,160,210,197,193,211,207,206,0,198,208,213,196,205,173,177,185,189,194,209,215,218,217,26,192,96,44,118,234,144,60,166,86,94,253,34,41,157,78,105,10,144,25,16,77,185,202,174,13,217,234,144,128,112,153,110,157,180,183,97,16,25,240,175,192,107,151,140,243,178,41,171,96,165,253,108,68,151,140,243,189,29,10,213,14,185,120,207,59,34,155,215,10,2,234,59,105,120,207,59,209,112,167,75,202,144,60,166,86,94,240,25,171,96,160,190,230,150,139,144,60,166,86,94,242,154,10,171,126,240,37,48,74,177,189,112,160,192,69,96,25,17,251,13,159,192,107,144,169,1,17,251,13,157,80,235,144,169,1,16,220,175,95,48,121,95,214,196,69,243,144,60,166,86,94,253,144,91,214,174,15,209,104,185,5,90,183,110,160,240,121,62,156,139,192,80,25,17,124,255,230,144,190,230,150,140,105,3,202,101,101,239,16,190,230,144,42,224,105,212,230,144,169,1,17,124,255,230,151,140,243,185,213,14,176,25,17,213,14,185,110,233,76,163,176,25,116,188,169,16,25,5,237,153,145,1,3,174,5,237,16,25,112,48,112,105,145,1,3,205,124,65,1,173,1,9,141,2,8,73,90,141,3,8,32,232,13,76,223,201,32,139,202,168,185,0,8,157,251,191,200,208,247,96,32,215,13,32,67,14,208,11,185,2,8,25,3,8,240,3,32,39,14,160,174,32,142,12,162,1,32,79,14,176,33,173,8,9,201,177,144,242,201,184,176,238,105,16,168,169,0,240,8,174,120,7,172,248,7,169,123,132,1,133,0,108,0,0,162,2,169,0,157,0,8,202,16,250,108,252,255,172,1,9,185,4,8,89,5,8,201,90,96,142,3,9,169,160,157,8,9,202,16,250,232,32,151,14,201,136,240,34,201,141,240,28,201,155,240,25,201,160,176,6,32,226,251,76,91,14,236,3,9,176,245,157,8,9,32,237,253,232,208,217,24,96,138,240,212,202,198,36,169,160,157,8,9,32,237,253,198,36,76,91,14,32,12,253,201,224,144,2,41,223,96,169,0,168,170,141,4,9,142,5,9,169,10,141,2,9,162,0,185,8,9,73,176,201,10,144,1,96,109,4,9,72,138,109,5,9,170,104,206,2,9,208,241,200,208,215,255,255,255,255,255,255,255,255,255,255,255,255]);class Qa{constructor(e){this.firmware=0,this.ramlo=0,this.rammid=0,this.ramhi=0,this.loc=0,je("RAMFactor card"),this.mem=Le(e);for(let t=0;t<e;t++)this.mem[t]=0}sethi(e){this.ramhi=255&e}setmid(e){0!=(128&this.rammid)&&0==(128&e)&&this.sethi(this.ramhi+1),this.rammid=255&e}setlo(e){0!=(128&this.ramlo)&&0==(128&e)&&this.setmid(this.rammid+1),this.ramlo=255&e}access(e,t){let s=0;switch(143&e){case 128:case 132:void 0!==t?this.setlo(t):s=this.ramlo;break;case 129:case 133:void 0!==t?this.setmid(t):s=this.rammid;break;case 130:case 134:void 0!==t?this.sethi(t):(s=this.ramhi,s|=240);break;case 131:case 135:void 0!==t?this.mem[this.loc%this.mem.length]=t:s=this.mem[this.loc%this.mem.length],this.setlo(this.ramlo+1);break;case 143:void 0!==t?this.firmware=1&t:s=this.firmware}return this.loc=this.ramhi<<16|this.rammid<<8|this.ramlo,s}ioSwitch(e,t){return this.access(e,t)}read(e,t){return $a[this.firmware<<12|e-192<<8|t]}write(){}reset(){this.firmware=0}getState(){return{loc:this.loc,firmware:this.firmware,mem:new Uint8Array(this.mem)}}setState(e){this.loc=e.loc,this.firmware=e.firmware,this.mem=new Uint8Array(e.mem),this.ramhi=this.loc>>16&255,this.rammid=this.loc>>8&255,this.ramlo=255&this.loc}}const el=({io:e,slot:t})=>(ke((()=>{if(e){const s=new Qa(1048576);e.setSlot(t,s)}}),[e,t]),null),tl=new Uint8Array([8,120,40,44,88,255,112,5,56,176,1,24,184,8,120,72,138,72,152,72,173,255,207,32,26,200,104,104,186,141,248,7,10,10,10,10,141,120,7,104,104,104,168,104,154,9,4,72,40,152,172,120,7,174,248,7,41,127,72,80,14,184,165,54,208,4,228,55,240,10,169,8,133,56,56,144,22,76,80,201,169,11,133,54,169,94,157,184,4,169,10,157,56,4,169,0,157,56,5,104,201,37,240,92,201,38,240,88,201,60,240,84,201,62,240,80,201,35,240,76,201,94,240,90,201,33,240,74,201,42,240,82,162,32,201,44,240,82,162,40,201,46,240,76,162,48,201,47,240,70,174,248,7,72,189,184,4,201,33,240,65,201,94,240,14,104,41,31,10,56,233,1,157,56,4,169,94,208,35,104,56,233,65,48,32,201,22,16,28,170,189,141,203,76,4,203,157,56,5,76,47,201,169,32,32,183,202,169,8,32,183,202,169,33,157,184,4,76,47,201,138,32,183,202,208,247,104,201,13,240,19,201,32,240,68,41,15,32,207,202,240,2,169,10,157,56,7,24,144,53,32,207,202,125,56,7,72,169,9,157,56,6,32,207,202,72,222,56,6,208,247,169,10,157,56,6,104,32,207,202,222,56,6,208,247,169,16,32,183,202,208,178,186,104,104,152,72,104,104,169,141,72,154,174,248,7,172,120,7,189,184,3,221,56,7,208,12,29,56,7,240,7,201,64,208,3,153,128,192,104,168,104,170,104,40,96,104,169,24,32,183,202,169,8,32,183,202,169,9,157,56,6,32,207,202,201,10,48,2,169,0,72,222,56,6,208,241,32,207,202,201,13,48,2,169,0,72,189,56,5,240,4,201,35,208,94,160,0,104,201,10,48,4,200,56,233,10,72,152,162,0,32,166,202,104,32,166,202,172,248,7,185,56,5,208,42,169,175,32,168,202,104,160,4,104,32,166,202,104,32,166,202,136,240,7,169,59,32,168,202,208,238,169,160,141,5,2,185,243,203,240,25,32,168,202,200,208,245,169,0,72,160,5,32,175,202,104,32,166,202,104,32,166,202,136,208,242,76,154,202,104,170,104,10,10,168,138,10,10,72,174,248,7,189,56,5,162,160,201,60,176,2,162,162,138,162,0,32,168,202,185,163,203,200,32,168,202,201,160,208,245,104,168,185,191,203,200,32,168,202,201,160,208,245,104,32,164,202,104,32,166,202,32,179,202,160,3,104,32,164,202,208,3,32,166,202,104,32,166,202,136,240,9,169,186,32,168,202,104,76,41,202,172,248,7,185,56,5,201,37,240,4,201,62,208,80,160,65,173,12,2,201,160,208,2,169,48,10,10,10,10,141,32,2,173,13,2,41,15,13,32,2,201,18,48,2,160,80,201,0,208,4,169,18,208,9,201,19,48,22,248,56,233,18,216,162,12,72,32,255,202,41,15,32,164,202,104,41,15,32,166,202,162,20,32,179,202,152,32,168,202,169,77,32,168,202,138,168,169,141,32,168,202,76,36,201,240,13,9,48,9,128,157,0,2,232,96,169,172,208,245,169,160,208,241,153,128,192,9,4,153,128,192,32,199,202,73,4,153,128,192,32,202,202,72,72,104,104,96,72,169,4,157,184,6,169,0,157,184,5,185,128,192,10,126,184,5,104,72,41,1,153,128,192,9,2,153,128,192,73,2,153,128,192,104,106,72,222,184,6,208,224,104,189,184,5,24,106,106,106,106,96,72,174,248,7,189,56,4,157,184,6,32,80,203,104,72,32,76,203,104,72,73,248,32,76,203,162,160,32,105,203,162,160,32,105,203,160,24,32,96,203,174,248,7,222,184,6,208,218,104,160,188,202,208,253,136,208,250,76,47,201,72,144,5,32,80,203,240,3,32,89,203,104,10,208,241,96,162,80,32,105,203,160,40,208,7,162,24,32,105,203,160,68,162,19,202,208,253,136,208,248,96,172,120,7,169,32,153,128,192,234,234,234,73,32,153,128,192,234,234,234,73,32,153,128,192,234,234,234,73,32,153,128,192,202,208,224,96,100,228,36,164,20,148,84,212,116,244,52,180,4,132,68,196,44,60,92,76,28,12,83,85,78,32,77,79,78,32,84,85,69,32,87,69,68,32,84,72,85,32,70,82,73,32,83,65,84,32,69,82,82,32,74,65,78,32,70,69,66,32,77,65,82,32,65,80,82,32,77,65,89,32,74,85,78,32,74,85,76,32,65,85,71,32,83,69,80,32,79,67,84,32,78,79,86,32,68,69,67,32,174,176,176,176,0,174,176,176,176,0,160,160,193,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255]);class sl{constructor(){this.clock=!1,this.strobe=!1,this.shiftMode=!1,this.register=0,this.bits=[],this.command=0,je("Thunderclock")}debug(...e){}calcBits(){const e=e=>{for(let t=0;t<4;t++)this.bits.push(0!=(8&e)),e<<=1},t=t=>{e(Math.floor(t/10)),e(t%10)},s=new Date,i=s.getDate(),n=s.getDay(),r=s.getMonth()+1,o=s.getHours(),a=s.getMinutes(),l=s.getSeconds();this.bits=[],e(r),e(n),t(i),t(o),t(a),t(l)}shift(){this.shiftMode&&(this.bits.pop()?(this.debug("shifting 1"),this.register|=128):(this.debug("shifting 0"),this.register&=127))}access(e,t){if(128==(143&e)&&void 0!==t){const e=!!(4&t);if(e!==this.strobe&&(this.debug("strobe",this.strobe?"high":"low"),e))switch(this.command=24&t,this.command){case 24:this.debug("TIMED"),this.calcBits();break;case 8:this.debug("REGSHIFT"),this.shiftMode=!0,this.shift();break;case 0:this.debug("REGHOLD"),this.shiftMode=!1;break;default:this.debug("Unknown command",ze(this.command))}const s=!!(2&t);s!==this.clock&&(this.clock=s,this.debug("clock",this.clock?"high":"low"),s&&this.shift())}return this.register}read(e,t){let s;return s=e<200?tl[t]:tl[e-200<<8|t],s}write(){}ioSwitch(e,t){return this.access(e,t)}getState(){return{}}setState(e){}}const il=({io:e,slot:t})=>(ke((()=>{if(e){const s=new sl;e.setSlot(t,s)}}),[e,t]),null),nl=new Uint8Array([173,123,7,41,248,201,48,240,33,169,48,141,123,7,141,251,7,169,0,141,251,6,32,97,201,162,0,138,141,176,192,189,161,200,141,177,192,232,224,16,208,241,141,89,192,96,173,251,7,41,8,240,9,32,147,254,32,34,252,32,137,254,104,168,104,170,104,96,32,209,200,230,78,208,2,230,79,173,0,192,16,245,32,92,200,144,240,44,16,192,24,96,201,139,208,2,169,219,201,129,208,10,173,251,7,73,64,141,251,7,176,231,72,173,251,7,10,10,104,144,31,201,176,144,27,44,99,192,48,20,201,176,240,14,201,192,208,2,169,208,201,219,144,8,41,207,208,4,169,221,9,32,72,41,127,141,123,6,104,56,96,123,80,94,41,27,8,24,25,0,8,224,8,0,0,0,0,141,123,6,165,37,205,251,5,240,6,141,251,5,32,4,202,165,36,205,123,5,144,3,141,123,5,173,123,6,32,137,202,169,15,141,176,192,173,123,5,201,80,176,19,109,123,4,141,177,192,169,14,141,176,192,169,0,109,251,4,141,177,192,96,73,192,201,8,176,29,168,169,201,72,185,242,203,72,96,234,172,123,5,169,160,32,113,202,200,192,80,144,248,96,169,52,141,123,7,96,169,50,208,248,160,192,162,128,202,208,253,173,48,192,136,208,245,96,172,123,5,192,80,144,5,72,32,176,201,104,172,123,5,32,113,202,238,123,5,44,120,4,16,7,173,123,5,201,80,176,104,96,172,123,5,173,251,5,72,32,7,202,32,4,201,160,0,104,105,0,201,24,144,240,176,35,32,103,201,152,240,232,169,0,141,123,5,141,251,5,168,240,18,206,123,5,16,157,169,79,141,123,5,173,251,5,240,147,206,251,5,76,4,202,169,48,141,123,7,104,9,128,201,177,208,103,169,8,141,88,192,208,91,201,178,208,81,169,254,45,251,7,141,251,7,96,141,123,6,78,120,4,76,203,200,32,39,202,238,251,5,173,251,5,201,24,144,74,206,251,5,173,251,6,105,4,41,127,141,251,6,32,18,202,169,13,141,176,192,173,123,4,141,177,192,169,12,141,176,192,173,251,4,141,177,192,169,23,32,7,202,160,0,32,4,201,176,149,201,179,208,14,169,1,13,251,7,208,169,201,176,208,156,76,9,200,76,39,201,173,251,5,141,248,4,10,10,109,248,4,109,251,6,72,74,74,74,74,141,251,4,104,10,10,10,10,141,123,4,96,201,13,208,6,169,0,141,123,5,96,9,128,201,160,176,206,201,135,144,8,168,169,201,72,185,185,201,72,96,24,113,19,178,72,96,175,157,242,19,19,19,19,19,19,19,19,19,102,14,19,56,0,20,123,24,152,109,123,4,72,169,0,109,251,4,72,10,41,12,170,189,176,192,104,74,104,170,96,10,72,173,251,7,74,104,106,72,32,89,202,104,176,5,157,0,204,144,3,157,0,205,96,72,169,247,32,160,201,141,89,192,173,123,7,41,7,208,4,104,76,35,202,41,4,240,3,76,135,201,104,56,233,32,41,127,72,206,123,7,173,123,7,41,3,208,21,104,201,24,176,3,141,251,5,173,248,5,201,80,176,3,141,123,5,76,4,202,104,141,248,5,96,173,0,192,201,147,208,15,44,16,192,173,0,192,16,251,201,131,240,3,44,16,192,96,168,185,49,203,32,241,200,32,68,200,201,206,176,8,201,201,144,4,201,204,208,234,76,241,200,234,44,203,255,112,49,56,144,24,184,80,43,1,130,17,20,28,34,76,0,200,32,68,200,41,127,162,0,96,32,167,201,162,0,96,201,0,240,9,173,0,192,10,144,3,32,92,200,162,0,96,145,40,56,184,141,255,207,72,133,53,138,72,152,72,165,53,134,53,162,195,142,120,4,72,80,16,169,50,133,56,134,57,169,7,133,54,134,55,32,0,200,24,144,111,104,164,53,240,31,136,173,120,6,201,136,240,23,217,0,2,240,18,73,32,217,0,2,208,59,173,120,6,153,0,2,176,3,32,237,202,169,128,32,245,201,32,68,200,201,155,240,241,201,141,208,5,72,32,1,201,104,201,149,208,18,172,123,5,32,89,202,176,5,189,0,204,144,3,189,0,205,9,128,141,120,6,208,8,32,68,200,160,0,140,120,6,186,232,232,232,157,0,1,169,0,133,36,173,251,5,133,37,76,46,200,104,172,251,7,16,8,172,120,6,192,224,144,1,152,32,177,200,32,207,202,169,127,32,160,201,173,123,5,233,71,144,212,105,31,24,144,209,96,56,113,178,123,0,72,102,196,194,193,255,195,234]),rl=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,0,0,0,0,0,0,0,255,255,255,0,0,0,255,255,255,0,0,0,0,0,0,0,0,0,0,255,255,255,255,255,255,0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,224,144,224,158,240,12,2,28,0,0,0,0,0,0,0,0,144,144,240,144,190,8,8,8,0,0,0,0,0,0,0,0,128,128,128,158,240,24,16,16,0,0,0,0,0,0,0,0,136,136,80,32,62,8,8,8,0,0,0,0,0,0,0,0,240,128,192,158,144,24,16,16,0,0,0,0,0,0,0,0,112,128,128,124,18,28,20,18,0,0,0,0,0,0,0,0,112,128,96,16,236,18,18,12,0,0,0,0,0,0,0,0,112,128,96,30,228,4,4,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0,15,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0,248,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,248,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,248,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0,255,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,255,8,8,8,8,8,8,8,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,24,24,24,24,0,24,0,0,0,0,0,0,0,0,0,54,54,18,36,0,0,0,0,0,0,0,0,0,0,0,0,36,36,126,36,126,36,36,0,0,0,0,0,0,0,0,0,8,62,72,60,18,124,16,0,0,0,0,0,0,0,0,0,98,148,104,16,44,82,140,0,0,0,0,0,0,0,0,0,32,80,80,98,148,136,118,0,0,0,0,0,0,0,0,0,24,24,8,16,0,0,0,0,0,0,0,0,0,0,0,0,12,16,32,32,32,16,12,0,0,0,0,0,0,0,0,0,48,8,4,4,4,8,48,0,0,0,0,0,0,0,0,0,16,146,84,56,84,146,16,0,0,0,0,0,0,0,0,0,0,16,16,254,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,24,8,16,0,0,0,0,0,0,0,0,0,0,0,126,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,24,0,0,0,0,0,0,0,0,0,2,4,8,16,32,64,128,0,0,0,0,0,0,0,0,0,56,68,138,146,162,68,56,0,0,0,0,0,0,0,0,0,8,56,8,8,8,8,62,0,0,0,0,0,0,0,0,0,60,66,2,28,32,64,126,0,0,0,0,0,0,0,0,0,126,4,8,28,2,66,60,0,0,0,0,0,0,0,0,0,4,12,20,36,126,4,4,0,0,0,0,0,0,0,0,0,126,64,124,2,2,66,60,0,0,0,0,0,0,0,0,0,30,32,64,124,66,66,60,0,0,0,0,0,0,0,0,0,126,2,4,8,16,32,32,0,0,0,0,0,0,0,0,0,60,66,66,60,66,66,60,0,0,0,0,0,0,0,0,0,60,66,66,62,2,4,120,0,0,0,0,0,0,0,0,0,0,24,24,0,24,24,0,0,0,0,0,0,0,0,0,0,0,24,24,0,24,24,8,16,0,0,0,0,0,0,0,0,0,6,24,96,24,6,0,0,0,0,0,0,0,0,0,0,0,0,126,0,126,0,0,0,0,0,0,0,0,0,0,0,0,96,24,6,24,96,0,0,0,0,0,0,0,0,0,0,60,66,2,12,16,0,16,0,0,0,0,0,0,0,0,0,60,66,154,170,148,64,60,0,0,0,0,0,0,0,0,0,24,36,66,66,126,66,66,0,0,0,0,0,0,0,0,0,124,66,66,124,66,66,124,0,0,0,0,0,0,0,0,0,28,34,64,64,64,34,28,0,0,0,0,0,0,0,0,0,120,68,66,66,66,68,120,0,0,0,0,0,0,0,0,0,126,64,64,120,64,64,126,0,0,0,0,0,0,0,0,0,126,64,64,120,64,64,64,0,0,0,0,0,0,0,0,0,28,34,64,78,66,34,30,0,0,0,0,0,0,0,0,0,66,66,66,126,66,66,66,0,0,0,0,0,0,0,0,0,28,8,8,8,8,8,28,0,0,0,0,0,0,0,0,0,14,4,4,4,4,68,56,0,0,0,0,0,0,0,0,0,66,68,72,80,104,68,66,0,0,0,0,0,0,0,0,0,64,64,64,64,64,64,126,0,0,0,0,0,0,0,0,0,130,198,170,146,130,130,130,0,0,0,0,0,0,0,0,0,66,98,82,74,70,66,66,0,0,0,0,0,0,0,0,0,56,68,130,130,130,68,56,0,0,0,0,0,0,0,0,0,124,66,66,124,64,64,64,0,0,0,0,0,0,0,0,0,56,68,130,130,138,68,58,0,0,0,0,0,0,0,0,0,124,66,66,124,72,68,66,0,0,0,0,0,0,0,0,0,60,66,64,60,2,66,60,0,0,0,0,0,0,0,0,0,254,16,16,16,16,16,16,0,0,0,0,0,0,0,0,0,66,66,66,66,66,66,60,0,0,0,0,0,0,0,0,0,130,130,68,68,40,40,16,0,0,0,0,0,0,0,0,0,130,130,130,130,146,170,68,0,0,0,0,0,0,0,0,0,130,68,40,16,40,68,130,0,0,0,0,0,0,0,0,0,130,68,40,16,16,16,16,0,0,0,0,0,0,0,0,0,254,4,8,16,32,64,254,0,0,0,0,0,0,0,0,0,62,48,48,48,48,48,62,0,0,0,0,0,0,0,0,0,128,64,32,16,8,4,2,0,0,0,0,0,0,0,0,0,62,6,6,6,6,6,62,0,0,0,0,0,0,0,0,0,8,28,42,8,8,8,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,254,0,0,0,0,0,0,0,0,24,24,16,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,248,4,124,132,122,0,0,0,0,0,0,0,0,0,64,64,124,66,66,66,124,0,0,0,0,0,0,0,0,0,0,0,60,66,64,64,62,0,0,0,0,0,0,0,0,0,2,2,62,66,66,66,62,0,0,0,0,0,0,0,0,0,0,0,60,66,126,64,60,0,0,0,0,0,0,0,0,0,28,34,32,120,32,32,32,0,0,0,0,0,0,0,0,0,0,2,60,66,66,62,2,66,60,0,0,0,0,0,0,0,64,64,92,98,66,66,66,0,0,0,0,0,0,0,0,0,8,0,8,8,8,8,8,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,36,24,0,0,0,0,0,0,0,64,64,70,88,96,88,70,0,0,0,0,0,0,0,0,0,24,8,8,8,8,8,28,0,0,0,0,0,0,0,0,0,0,0,236,146,146,146,146,0,0,0,0,0,0,0,0,0,0,0,92,34,34,34,34,0,0,0,0,0,0,0,0,0,0,0,60,66,66,66,60,0,0,0,0,0,0,0,0,0,0,0,124,66,66,66,124,64,64,0,0,0,0,0,0,0,0,0,62,66,66,66,62,2,2,0,0,0,0,0,0,0,0,0,92,98,64,64,64,0,0,0,0,0,0,0,0,0,0,0,62,64,60,2,124,0,0,0,0,0,0,0,0,0,0,16,62,16,16,16,14,0,0,0,0,0,0,0,0,0,0,0,68,68,68,68,58,0,0,0,0,0,0,0,0,0,0,0,130,130,68,40,16,0,0,0,0,0,0,0,0,0,0,0,130,130,146,170,68,0,0,0,0,0,0,0,0,0,0,0,66,36,24,36,66,0,0,0,0,0,0,0,0,0,0,0,130,130,68,40,16,32,192,0,0,0,0,0,0,0,0,0,126,4,24,32,126,0,0,0,0,0,0,0,0,0,12,16,8,48,8,16,12,0,0,0,0,0,0,0,0,0,8,8,8,0,8,8,8,0,0,0,0,0,0,0,0,0,48,8,16,12,16,8,48,0,0,0,0,0,0,0,0,0,96,146,12,0,0,0,0,0,0,0,0,0,0,0,0,0,36,72,146,36,72,146,36,72,0,0,0,0,0,0,0,0]),ol=[0,0,0],al=[255,255,255];class ll{constructor(){this.regs=[123,80,98,41,27,8,24,25,0,8,192,8,0,0,0,0,0,0],this.blink=!1,this.curReg=0,this.bank=0,this.buffer=Ue(8),this.dirty=!1,je("Videx Videoterm"),this.imageData=new ImageData(560,192);for(let e=0;e<430080;e++)this.imageData.data[e]=255;for(let e=0;e<2048;e++)this.buffer[e]=255&e;this.refresh(),setInterval((()=>{this.blink=!this.blink,this.refreshCursor(!1)}),300)}updateBuffer(e,t){this.buffer[e]=t,t&=127;const s=2048+e-this.startPos&2047,i=this.imageData.data,n=s/80&255,r=s%80*7,o=n<<3,a=t<<4;let l;if(n<25){this.dirty=!0;for(let e=0;e<8;e++){let t=rl[a+e];for(let s=0;s<7;s++)l=128&t?al:ol,i[560*(o+e)*4+4*(r+s)]=l[0],i[560*(o+e)*4+4*(r+s)+1]=l[1],i[560*(o+e)*4+4*(r+s)+2]=l[2],t<<=1}}}refreshCursor(e){const t=this.regs[14]<<8|this.regs[15],s=2048+t-this.startPos&2047,i=this.imageData.data,n=s%80*7,r=(s/80&255)<<3,o=(96&this.regs[10])>>5;if(e&&t!==this.cursorPos){const e=2048+this.cursorPos-this.startPos&2047;this.updateBuffer(e,this.buffer[e]),this.cursorPos=t}if(this.updateBuffer(t,this.buffer[t]),1!==o&&(this.blink||0===o)){this.dirty=!0;for(let e=0;e<8;e++){const t=al;if(e>=(31&this.regs[10])&&e<=(31&this.regs[11]))for(let s=0;s<7;s++)i[560*(r+e)*4+4*(n+s)]=t[0],i[560*(r+e)*4+4*(n+s)+1]=t[1],i[560*(r+e)*4+4*(n+s)+2]=t[2]}}}updateStartPos(){const e=this.regs[12]<<8|this.regs[13];this.startPos!==e&&(this.startPos=e,this.shouldRefresh=!0)}refresh(){for(let e=0;e<2048;e++)this.updateBuffer(e,this.buffer[e])}access(e,t){let s;switch(129&e){case 128:void 0!==t?this.curReg=t:s=this.curReg;break;case 129:if(void 0!==t)switch(this.regs[this.curReg]=t,this.curReg){case 10:case 11:case 14:case 15:this.refreshCursor(!0);break;case 12:case 13:this.updateStartPos()}else s=this.regs[this.curReg]}return this.bank=(12&e)>>2,s}ioSwitch(e,t){return this.access(e,t)}read(e,t){if(e<204)return nl[(3&e)<<8|t];if(e<206){const s=(1&e)+(this.bank<<1)<<8|t;return this.buffer[s]}return 0}write(e,t,s){if(e>203&&e<206){const i=(1&e)+(this.bank<<1)<<8|t;this.updateBuffer(i,s)}}blit(){if(this.shouldRefresh&&(this.refresh(),this.shouldRefresh=!1),this.dirty)return this.dirty=!1,this.imageData}getState(){return{curReg:this.curReg,startPos:this.startPos,cursorPos:this.cursorPos,bank:this.bank,buffer:new Uint8Array(this.buffer),regs:[...this.regs]}}setState(e){this.curReg=e.curReg,this.startPos=e.startPos,this.cursorPos=e.cursorPos,this.bank=e.bank,this.buffer=new Uint8Array(this.buffer),this.regs=[...e.regs],this.shouldRefresh=!0,this.dirty=!0}}const hl=({io:e,slot:t})=>(ke((()=>{if(e){const s=new ll;e.setSlot(t,s)}}),[e,t]),null);var cl=n(5120),dl={};dl.styleTagTransform=ae(),dl.setAttributes=ie(),dl.insert=te().bind(null,"head"),dl.domAPI=Q(),dl.insertStyleElement=re(),q()(cl.Z,dl);const ul=cl.Z&&cl.Z.locals?cl.Z.locals:void 0;const Al=e=>{const{e:t,enhanced:s,sectors:i,keyboardLayout:n}=e,r=xe(null),[o,a]=ve(),[l,h]=ve(),[c,d]=ve(!1),[u,m]=ve(!1),p=Ee((()=>new Ui(h)),[]),g=null==o?void 0:o.getIO(),f=null==o?void 0:o.getCPU(),_=null==o?void 0:o.getVideoModes(),b=null==o?void 0:o.getROM(),C=Se((e=>{var t;if(document.activeElement===r.current||document.activeElement===document.body){if(g){const s=null===(t=e.clipboardData||window.clipboardData)||void 0===t?void 0:t.getData("text");s&&g.setKeyBuffer(s)}e.preventDefault()}}),[g]),y=Se((e=>{var t;document.activeElement!==r.current&&document.activeElement!==document.body||(_&&(null===(t=e.clipboardData)||void 0===t||t.setData("text/plain",_.getText())),e.preventDefault())}),[_]);ke((()=>{if(r.current){const t=Object.assign({canvas:r.current,tick:()=>{}},e),s=new Nt(t),i=Li((e=>function(e,t,s,i){return new(s||(s=Promise))((function(n,r){function o(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function*(){try{if(yield s.ready,e.aborted)return;if(a(s),yield p.ready,e.aborted)return void a(void 0);s.reset(),s.run()}catch(e){h(e)}d(!0)}))));return window.apple2=s,()=>i.abort()}}),[e,p]),ke((()=>{const{current:e}=r;return window.addEventListener("paste",C),window.addEventListener("copy",y),null==e||e.addEventListener("paste",C),null==e||e.addEventListener("copy",y),()=>{window.removeEventListener("paste",C),window.removeEventListener("copy",y),null==e||e.removeEventListener("paste",C),null==e||e.removeEventListener("copy",y)}}),[y,C]);const w=Se((()=>{m((e=>!e))}),[]);return A("div",{className:ul.container},A("div",{className:J()(ul.outer,{apple2e:t,[ul.ready]:c})},A(ga,{screenRef:r}),t?null:A(la,{cpu:f,io:g,rom:b,slot:0}),A(el,{io:g,slot:2}),t?null:A(hl,{io:g,slot:3}),A(ua,{cpu:f,screenRef:r,io:g,slot:4}),A(il,{io:g,slot:5}),A(Gt,null,A(qa,{cpu:f,io:g,sectors:i,enhanced:s,ready:p})),A(di,{apple2:o,e:t,toggleDebugger:w}),A(Gt,null,A(aa,{apple2:o,layout:n})),A(Ko,{error:l,setError:h})),u?A(Go,{apple2:o}):null)},ml=new qt,pl=()=>ml,gl={rom:"apple2enh",characterRom:"apple2enh_char",e:!0,enhanced:!0,sectors:16,keyboardLayout:"apple2e"},fl={apple2e:{rom:"apple2e",characterRom:"apple2e_char",enhanced:!1},apple2rm:{characterRom:"rmfont_char"},apple2ex:{rom:"apple2ex",e:!1},apple2:{rom:"intbasic",characterRom:"apple2_char",e:!1,keyboardLayout:"apple2"},apple213:{rom:"intbasic",characterRom:"apple2_char",e:!1,sectors:13,keyboardLayout:"apple2"},original:{rom:"original",characterRom:"apple2_char",e:!1,keyboardLayout:"apple2"},apple2jplus:{rom:"apple2j",characterRom:"apple2j_char",e:!1,keyboardLayout:"apple2"},apple2pig:{rom:"fpbasic",characterRom:"pigfont_char",e:!1,keyboardLayout:"apple2"},apple2lc:{rom:"fpbasic",characterRom:"apple2lc_char",e:!1,keyboardLayout:"apple2"},apple2plus:{rom:"fpbasic",characterRom:"apple2_char",e:!1,keyboardLayout:"apple2"},pravetz82:{rom:"pravetz82",characterRom:"pravetz82_char",e:!1,keyboardLayout:"apple2"}};var _l=n(1750),bl={};bl.styleTagTransform=ae(),bl.setAttributes=ie(),bl.insert=te().bind(null,"head"),bl.domAPI=Q(),bl.insertStyleElement=re(),q()(_l.Z,bl);const Cl=_l.Z&&_l.Z.locals?_l.Z.locals:void 0;O(A((()=>{const e=pl(),t=e.readPref(ri,"apple2enh"),s="true"===e.readPref(ii,"true"),i=Object.assign(Object.assign({},gl),fl[t]||{});return A("div",{className:J()(Cl.container,Ds.components)},A(de,{e:i.e}),A(Al,Object.assign({gl:s},i)))}),null),document.getElementById("app"))})(),r.Apple2})()));
//# sourceMappingURL=preact.bundle.js.map